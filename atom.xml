<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Ethereal State</title>
  
  <subtitle>A piece of own land in the Internet</subtitle>
  <link href="https://www.0co.dev/atom.xml" rel="self"/>
  
  <link href="https://www.0co.dev/"/>
  <updated>2024-07-12T07:57:06.803Z</updated>
  <id>https://www.0co.dev/</id>
  
  <author>
    <name>Konrad Gerrens</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>使用YOURLS Docker版，搭建短链接服务</title>
    <link href="https://www.0co.dev/yourls-docker/"/>
    <id>https://www.0co.dev/yourls-docker/</id>
    <published>2024-07-12T06:57:06.000Z</published>
    <updated>2024-07-12T07:57:06.803Z</updated>
    
    <content type="html"><![CDATA[<h1 id="使用YOURLS-Docker版，搭建短链接服务"><a href="#使用YOURLS-Docker版，搭建短链接服务" class="headerlink" title="使用YOURLS Docker版，搭建短链接服务"></a>使用YOURLS Docker版，搭建短链接服务</h1><h2 id="最终目录结构"><a href="#最终目录结构" class="headerlink" title="最终目录结构"></a>最终目录结构</h2><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202407121518422.png" alt="image-20240712151858363" style="zoom:80%;" /><p>以上是本项目完成时<code>/root/yourls</code>目录的结构，由于本项目部分组件的教程文档过于简陋，所以很容易放错位置，请务必注意目录的结构。</p><h2 id="基础环境安装"><a href="#基础环境安装" class="headerlink" title="基础环境安装"></a>基础环境安装</h2><p>首先，创建工作目录，比如<code>/root/yourls</code>，在其中新建<code>docker-compose.yml</code>，加入以下内容：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&#x27;3.1&#x27;</span><br><br><span class="hljs-attr">services:</span><br><br>  <span class="hljs-attr">yourls:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">yourls</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">34324</span><span class="hljs-string">:80</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">YOURLS_DB_NAME:</span> <span class="hljs-string">yourls</span><br>      <span class="hljs-attr">YOURLS_DB_USER:</span> <span class="hljs-string">yourls</span><br>      <span class="hljs-attr">YOURLS_DB_PASS:</span> <span class="hljs-string">yourls</span><br>      <span class="hljs-attr">YOURLS_SITE:</span> <span class="hljs-string">https://url.xxxx.xxx</span><br>      <span class="hljs-attr">YOURLS_USER:</span> <span class="hljs-string">admin</span><br>      <span class="hljs-attr">YOURLS_PASS:</span> <span class="hljs-string">admin</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./yourls_data/:/var/www/html</span><br><br>  <span class="hljs-attr">mysql:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">example</span><br>      <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">yourls</span><br>      <span class="hljs-attr">MYSQL_USER:</span> <span class="hljs-string">yourls</span><br>      <span class="hljs-attr">MYSQL_PASSWORD:</span> <span class="hljs-string">yourls</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./mysql/db/:/var/lib/mysql</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./mysql/conf/:/etc/mysql/conf.d</span><br></code></pre></td></tr></table></figure><blockquote><ul><li>“34324”端口为外部暴露端口，根据需要修改</li><li>YOURLS_DB_NAME -&gt; MYSQL_DATABASE，YOURLS_DB_USER -&gt; MYSQL_USER，YOURLS_DB_PASS -&gt; MYSQL_PASSWORD，三组变量一一对应，根据自己需要填写</li><li>YOURLS_SITE为网站地址，填写自己即将使用的域名</li><li>YOURLS_USER&#x2F;PASS是管理员登录账号密码，根据需要填写</li><li>为便于修改内部文件，我们使用挂载卷的形式，<code>yourls.volumes</code>挂载在本地的<code>/root/yourls/yourls_data</code>，<code>mysql.volumes</code>挂载在本地的<code>/root/yourls/mysql</code>中的两个文件夹</li></ul></blockquote><p>运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker compose up -d<br></code></pre></td></tr></table></figure><h3 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h3><p>若要使用域名访问，请设置反向代理，具体方式可以查看之前文章，不再赘述。</p><p>完成反向代理配置之后，打开<code>url.xxxx.xxx/admin</code>点击<code>install</code>进行安装，输入<code>YOURLS_USER/PASS</code>中设置的管理员账号密码，现在你就可以看到一个简陋的后台页面了。</p><p><strong>但是请注意，默认的<code>yourls</code>是只有后台管理员界面的，当你尝试访问<code>url.xxxx.xxx</code>只能得到大大的<code>Forbidden</code></strong></p><p>如果你没有更多需求，那么通过这个<code>url.xxxx.xxx/admin</code>页面的管理员后台也是勉强可以使用的，但是这并不是我们印象中的所谓“短链接”平台，所以我们要安装前台页面，顺便给管理员后台美化一下。</p><h2 id="Sleeky美化包的安装"><a href="#Sleeky美化包的安装" class="headerlink" title="Sleeky美化包的安装"></a>Sleeky美化包的安装</h2><p>访问下方仓库下载主题包并查看简单教程</p><div class="note note-primary">            <p><a href="https://github.com/Flynntes/Sleeky">Flynntes&#x2F;Sleeky: 🎨 A sleek and simple frontend &amp; backend theme for YOURLS</a></p>          </div><h3 id="backend"><a href="#backend" class="headerlink" title="backend"></a>backend</h3><p>下载之后解压，将其中的<code>sleeky-backend</code>移动至<code>yourls/yourls_data/user/plugins</code>，刷新后在管理员后台<code>manage plugins</code>选项中激活<code>sleeky backend</code>插件（点击<code>action</code>列的<code>activate</code>），顺道提一句，自带的<code>random shorturls</code>插件也建议启用，否则后缀只是按照数字排序，没内味😉</p><blockquote><p>插件启用后记得刷新，否则浏览器缓存会导致看不到生效后的效果</p></blockquote><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202407121538705.png" alt="240712153704" style="zoom:80%;" /><h3 id="frontend"><a href="#frontend" class="headerlink" title="frontend"></a>frontend</h3><p>打开下载的主题包中的<code>sleeky-frontend</code>文件夹，将其中的<code>frontend</code>文件夹和<code>index.php</code>文件复制到<code>/root/yourls/yourls_data</code>目录中，<strong>注意看文章开头给出的目录结构</strong>，这一步开发者文档中的说明有些模糊，容易造成误解。</p><p>重启程序</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker compose restart<br></code></pre></td></tr></table></figure><p>打开<code>url.xxxx.xxx</code>就可以查看前台页面</p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202407121547596.png" alt="image-20240712154707361" style="zoom: 33%;" /><h3 id="其他美化和插件"><a href="#其他美化和插件" class="headerlink" title="其他美化和插件"></a>其他美化和插件</h3><p>可以进入以下仓库查看更多皮肤与插件</p><div class="note note-success">            <p><a href="https://github.com/YOURLS/awesome">YOURLS&#x2F;awesome: 🎉 A curated list of awesome things related to YOURLS</a></p>          </div><h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="页面显示不正常-1"><a href="#页面显示不正常-1" class="headerlink" title="页面显示不正常[1]"></a>页面显示不正常<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Frontend page isn't displayed correctly · Issue #130 · Flynntes/Sleeky](https://github.com/Flynntes/Sleeky/issues/130#issuecomment-1824605122)">[1]</span></a></sup></h3><p>在上述方法安装前台页面之后，可能会出现显示页面显示不正常的情况，对<code>/root/yourls/yourls_data/frontend/header.php</code>进行修改，删除下图第15行中的<code>&lt;?php echo $YOURLS_SITE ?&gt;</code> 后重启程序即可。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202407121548066.png" alt="240711202807"></p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://github.com/Flynntes/Sleeky/issues/130#issuecomment-1824605122">Frontend page isn’t displayed correctly · Issue #130 · Flynntes&#x2F;Sleeky</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://github.com/YOURLS/awesome">YOURLS&#x2F;awesome: 🎉 A curated list of awesome things related to YOURLS</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://github.com/YOURLS/YOURLS">YOURLS&#x2F;YOURLS: 🔗 The de facto standard self hosted URL shortener in PHP</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://blog.laoda.de/archives/docker-compose-install-yourls">【好玩儿的Docker项目】10分钟搭建一个自己的短链接服务</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://hub.docker.com/_/yourls?tab=description">yourls - Official Image | Docker Hub</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">使用YOURLS Docker版，搭建短链接服务</summary>
    
    
    
    <category term="Docker" scheme="https://www.0co.dev/categories/Docker/"/>
    
    
    <category term="Docker" scheme="https://www.0co.dev/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>搭建自有流媒体解锁检测机器人</title>
    <link href="https://www.0co.dev/media-unlock-bot/"/>
    <id>https://www.0co.dev/media-unlock-bot/</id>
    <published>2023-11-10T10:56:50.000Z</published>
    <updated>2023-11-21T08:23:07.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="搭建自有流媒体解锁检测机器人"><a href="#搭建自有流媒体解锁检测机器人" class="headerlink" title="搭建自有流媒体解锁检测机器人"></a>搭建自有流媒体解锁检测机器人</h1><h2 id="变量获取"><a href="#变量获取" class="headerlink" title="变量获取"></a>变量获取</h2><h3 id="User-id"><a href="#User-id" class="headerlink" title="User_id"></a>User_id</h3><p>随便转发一条你自己发的消息给这个bot</p><blockquote><p><a href="https://t.me/getUserID_Robot">https://t.me/getUserID_Robot</a></p></blockquote><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311111853394.png" alt="user id"></p><p>实测，直接发消息不行，只能转发。</p><h3 id="API-id-API-hash"><a href="#API-id-API-hash" class="headerlink" title="API_id &amp; API_hash"></a>API_id &amp; API_hash</h3><p>登录<strong>Telegram</strong>应用管理页面 </p><blockquote><p><a href="https://my.telegram.org/">https://my.telegram.org/</a></p></blockquote><p>填写手机号，记得加区号，如<code>+86</code>，之后<code>Telegram</code>客户端会收到验证码（注意不是发短信）。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311111842528.png" alt="login"></p><p>登录后，点击<code>API development tools</code>并填写表格。其中<code>App title</code>和<code>Short name</code>可以随意填写,<code>Platform</code>选择你的开发平台，<code>Description</code>是对你的应用的简短描述。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311111845455.png" alt="dev tools"></p><p>提交表格后，你将获得一个<code>App api_id</code>和<code>App api_hash</code>。这就是你的 <code>API ID </code>和<code> API Hash</code>，复制备用。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311111846792.png" alt="ID &amp; hash"></p><h3 id="bot-token"><a href="#bot-token" class="headerlink" title="bot_token"></a>bot_token</h3><blockquote><p><a href="https://t.me/BotFather">https://t.me/BotFather</a></p></blockquote><p>从<code>BotFather</code>创建一个机器人，获得该机器人的<code>bot_token</code>，如：<code>bot_token = &quot;123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11&quot;</code></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311111912033.png" alt="newbot"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311111858395.png" alt="bot_token"></p><h2 id="后端-FullTClash"><a href="#后端-FullTClash" class="headerlink" title="后端-FullTClash"></a>后端-FullTClash</h2><blockquote><p>后端依旧基于Docker搭建</p></blockquote><p>运行以下代码：</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">docker <span class="hljs-keyword">run</span><span class="language-bash"> -d \</span><br><span class="language-bash">-e ADMINID=&#123;&#123;user_id&#125;&#125; \</span><br><span class="language-bash">-e APIID=&#123;&#123;api_id&#125;&#125; \</span><br><span class="language-bash">-e APIHASH=&#123;&#123;api_hash&#125;&#125; \</span><br><span class="language-bash">-e BOTTOKEN=&#123;&#123;bot_token&#125;&#125; \</span><br><span class="language-bash">weleven11/fulltclash</span><br></code></pre></td></tr></table></figure><p>可选参数：</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># CORE:测速使用的CPU核心数。可选，默认1</span><br><span class="hljs-comment"># PROXY:TG代理。可选，socks5协议，格式为 host:端口:用户名:密码 ，用户名密码可不填。</span><br><span class="hljs-comment"># THREAD:测速使用线程数。可选，默认4</span><br><br>-e CORE=<span class="hljs-number">4</span> \<br>-e THREAD=<span class="hljs-number">1</span> \<br>-e PROXY=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">7891</span> \<br></code></pre></td></tr></table></figure><p>或者使用配置文件映射：</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># `/path/to/config.yaml` 替换为你自己的配置文件路径，配置文件内容见后文。</span><br><br>docker <span class="hljs-keyword">run</span><span class="language-bash"> -d \</span><br><span class="language-bash">-v /path/to/config.yaml:/app/resources/config.yaml \</span><br><span class="language-bash">weleven11/fulltclash</span><br></code></pre></td></tr></table></figure><hr><p>目前机器人已经搭建完成了，去瞧瞧吧。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311111901309.png" alt="bot"></p><h2 id="config-yaml"><a href="#config-yaml" class="headerlink" title="config.yaml"></a>config.yaml</h2><blockquote><p>若选择使用配置文件映射，请修改并上传此文件到相应位置，具体内容请参见官方文档<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[配置说明 - FullTclash 文档](https://fulltclash.gitbook.io/fulltclash-doc/wen-dang/pei-zhi-shuo-ming)">[1]</span></a></sup></p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># 注意，yaml配置文件对缩进敏感，请不要强迫症删掉#号之间的空格。</span><br><span class="hljs-attr">admin:</span><br><span class="hljs-bullet">-</span> <span class="hljs-number">12345678</span> <span class="hljs-comment">#管理员，此处写你的id或用户名，必须配置该项，否则程序会自动退出</span><br><span class="hljs-attr">bot:</span><br> <span class="hljs-attr">api_id:</span> <span class="hljs-number">123456</span> <span class="hljs-comment"># Telegram的api_id</span><br> <span class="hljs-attr">api_hash:</span> <span class="hljs-string">ABCDEFG</span> <span class="hljs-comment"># Telegram的api_hash</span><br> <span class="hljs-attr">bot_token:</span> <span class="hljs-number">123456</span><span class="hljs-string">:ABCDEFG</span> <span class="hljs-comment">#bot的token</span><br><span class="hljs-comment"># ====================以上为必填项，否则无法启动成功========================</span><br><span class="hljs-comment"># proxy: host:端口:用户名:密码 #socks5代理，用户名和密码为可选配置，已和下面的proxy单独分离，请勿混用</span><br><span class="hljs-comment"># strictmode: false # 严格模式，代表测试的时侯，bot内联按钮只有发起测试的主人才能按，否则所有用户用户权限都可以按。默认false，目前未适配，敬请期待。</span><br><span class="hljs-comment"># scripttext: &quot;⏳联通性测试进行中...&quot;  # 解锁脚本测试进度条自定义文本</span><br><span class="hljs-comment"># analyzetext: &quot;⏳节点测试拓扑进行中...&quot;  # 拓扑测试进度条自定义文本</span><br><span class="hljs-comment"># speedtext: &quot;⏳速度测试进行中...&quot;  # 速度测试进度条自定义文本</span><br><span class="hljs-comment"># bar: &quot;=&quot; #进度条自定义文本</span><br><span class="hljs-comment"># bleft: &quot;[&quot; #左括号自定义文本</span><br><span class="hljs-comment"># bright: &quot;]&quot; #右括号自定义文本</span><br><span class="hljs-comment"># bspace: &quot;  &quot; #空格自定义文本，默认为2个</span><br><span class="hljs-comment"># command: [&#x27;mycommand1&#x27;, &#x27;mycommand2&#x27;] #自定义指令，用于适配权限回调。高级用法，不会无需配置。</span><br><span class="hljs-comment">#以下是fulltclash的buildtoken，可以用默认的，但是安全性得不到保障，具体原因详见文档</span><br><span class="hljs-comment">#buildtoken: c7004ded9db897e538405c67e50e0ef0c3dbad717e67a92d02f6ebcfd1022a5ad1d2c4419541f538ff623051759ec000d2f426e03f9709a6608570c5b9141a6b</span><br><span class="hljs-comment">#clash:</span><br><span class="hljs-comment"># path: &#x27;./bin/fulltclash-linux-amd64&#x27; # 代理客户端的路径，默认为 ./bin/ 下。不会弄不要动这里，用默认的即可。本仓库默认仅提供win-amd64与linux-amd64两种(意味着如果为这两种架构，这里不用改。)，其他架构需要自行编译。</span><br><span class="hljs-comment"># allow-caching: false  #是否缓存测试过程产生的订阅，若否，则测试完成后会自动删除测试订阅，以免造成空间浪费。（此配置暂不生效）</span><br><span class="hljs-comment"># core: 4 # 核心数，数量越多测试速度越快，但代价是内存会大量占用(每个核心大概10M)，自己的机子多少内存自己平衡。默认值为1.</span><br><span class="hljs-comment"># auto-start: false # bot启动时顺带启动,若为false则需要在 bot上输入/clash start 手动启动，默认false</span><br><span class="hljs-comment"># startup: 1124 #起始端口。表示从此端口开始往下数占用数量，比如核心数为4，就会占用[1124,1126,1128,1130]共4个端口，遇到端口占用时可配置此项。推荐10000以上作为初始端口</span><br><span class="hljs-comment"># branch: origin #clash内核上游分支，仅有两个有效值: [origin, meta], meta分支支持更多协议，比如vless、tuic等，但是使用上较为不可控，默认为origin原生内核。</span><br><span class="hljs-comment">#proxy: &quot;host:端口&quot; # http配置代理(非socks5)，括号内可选用于下载获取订阅链接，订阅链接国内打不开可尝试开启（可选配置）,本机提供的代理可以这样填: &#x27;127.0.0.1:7890&#x27;</span><br><span class="hljs-comment">#如果要http代理要验证，配置格式为: proxy: &quot;用户名:密码@host:端口&quot; 比如: user1:112233@127.0.0.1:7890</span><br><span class="hljs-comment">#geoip-api: &quot;ip-api.com&quot; # GEOIP 测试api，取二级域名,目前支持 ip-api.com ip.sb ipleak.net ipdata.co ipapi.co 五种，其中 ipdata 需要配置下面的geoip-key</span><br><span class="hljs-comment">#geoip-key: xxxxxxx #ipdata 的 apikey，如果使用其他api则无需填写</span><br><span class="hljs-comment">#subconvertor: #订阅转换(此配置主要开发者已无心维护，能用但不稳定)</span><br><span class="hljs-comment"># enable: true #是否启用</span><br><span class="hljs-comment"># host: &#x27;127.0.0.1:25500&#x27; #域名或者ip加端口</span><br><span class="hljs-comment"># remoteconfig: &quot;https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online.ini&quot; #远程配置</span><br><span class="hljs-comment">#pingurl: http://www.gstatic.com/generate_204  #自定义延迟测试URL</span><br><span class="hljs-comment">#netflixurl: &quot;https://www.netflix.com/title/80113701&quot;  #自定义奈飞非自制剧检测网页，注意在更换此链接时请确保是非自制的链接。</span><br><span class="hljs-comment">#speedfile:  #自定义测速文件，可以添加多个诸如以下格式或者[https://1.com, https://2.com]</span><br><span class="hljs-comment">#- https://dl.google.com/dl/android/studio/install/3.4.1.0/android-studio-ide-183.5522156-windows.exe</span><br><span class="hljs-comment">#- https://dl.google.com/dl/android/studio/install/3.4.1.0/android-studio-ide-183.5522156-windows.exe</span><br><span class="hljs-comment">#speednodes: 300 # 测速节点数量限制，超过将不会进行测速</span><br><span class="hljs-comment">#speedthread: 4 #测速线程</span><br><span class="hljs-comment">#nospeed: true #禁用测速，开启后将无法测速。</span><br><span class="hljs-comment">#speed_end_colors_switch: false #速度测试渐变色模式，默认关闭</span><br><span class="hljs-comment">#end_colors_switch: false #联通性测试渐变色模式，默认关闭</span><br><span class="hljs-comment">#ipstack: true #开启ipv4，ipv6双栈检测。默认关闭(false)，开启后可以检测节点是否支持ipv4和ipv6，代价是检测时间会延长。</span><br><span class="hljs-comment">#localip: false  #本地ip数据库(MaxMind格式) ,请将asn数据库与city数据库放入&quot;/resources/databases&quot;文件夹</span><br><span class="hljs-comment">#dasn: &quot;GeoLite2-ASN.mmdb&quot; #ASN数据库名称，用于获取AS编号</span><br><span class="hljs-comment">#dorg: &quot;GeoLite2-ASN.mmdb&quot; #org数据库mingc，用于获取组织名称</span><br><span class="hljs-comment">#dcity: &quot;GeoLite2-City.mmdb&quot; #city数据库名称，用于获取地区代码</span><br><span class="hljs-comment">#speedconfig: #测速相关配置</span><br><span class="hljs-comment"># interval: 10 #每个节点的测速时长</span><br><span class="hljs-comment">#entrance:  #入口显示配置</span><br><span class="hljs-comment"># switch: &quot;ip&quot; #设置为ip将显示入口ip段，设置为cluster将显示簇，默认设置为ip，PS:这里的簇为入口域名绑定的ip地址数量</span><br><span class="hljs-comment">#user: 12345678 #用户列表，/grant 命令授权的目标会保存在这。推荐使用bot进行授权，而非手动配置。（可选配置）</span><br><span class="hljs-comment">#emoji: #emoji可选配置</span><br><span class="hljs-comment"># enable: true #是否启用,默认启用。若否，则在输出图片时emoji将无法正常显示。关闭该项可解决部分图片生成失败的问题。（可选配置）</span><br><span class="hljs-comment"># emoji-source: &#x27;TwemojiLocalSource&#x27; #emoji表情源。默认值为TwemojiLocalSource。分为web源与本地源。可配置的值参考 ./libs/emoji_custom/__all__ 里面的成员变量。目前本地源仅支持: TwemojiLocalSource</span><br><span class="hljs-comment">#font: &#x27;./resources/苹方黑体-准-简.ttf&#x27; #自定义字体，这里填字体的路径</span><br><span class="hljs-comment">#slaveconfig:</span><br><span class="hljs-comment">#  default-slave: # 默认后端配置。</span><br><span class="hljs-comment">#    comment: &quot;本地测试后端&quot; # 默认测试后端的备注。</span><br><span class="hljs-comment">#    username: &quot;local&quot; # 默认测试后端的ID，此项请勿修改，会影响本地后端的运行。</span><br><span class="hljs-comment">#userconfig: #用户权限组相关配置</span><br><span class="hljs-comment">#  rule: #测试时的默认规则,3.6.0加入</span><br><span class="hljs-comment">#    &quot;规则名&quot;:</span><br><span class="hljs-comment">#      enable: true #是否启用激活该规则</span><br><span class="hljs-comment">#      slaveid: local  #slaveid的有效值参照配置里的 slaveconfig下的所有键。</span><br><span class="hljs-comment">#      script: [&quot;Netflix&quot;, &quot;Youtube&quot;, &quot;Disney+&quot;, &quot;维基百科&quot;] #script的有效值参照连通性测试绘图结果中显示的名称（大小写敏感）。</span><br><span class="hljs-comment">#      sort: &quot;HTTP升序&quot;</span><br><span class="hljs-comment"># 查看你的机器人的所有可用测试项的python变量:</span><br><span class="hljs-comment"># from utils.cleaner import addon</span><br><span class="hljs-comment"># print(addon.global_test_item)</span><br><br><span class="hljs-comment">#----------------------------   以下为绘图相关配置   --------------------------------#</span><br><br><span class="hljs-comment">#image:</span><br><span class="hljs-comment"># title: &#x27;FullTclash&#x27; # 绘图时的标题</span><br><span class="hljs-comment"># 以下是颜色配置，其中speed是速度相关,name为颜色名字，value为颜色值，目前仅支持十六进制，label是颜色对应的速度区间（单位MB）,不用动，只需改value值，其他项是为了做区分。</span><br><span class="hljs-comment"># color:</span><br><span class="hljs-comment">#  speed: # 刚刚好有七个颜色，多一个少一个可能会有奇怪的效果。注意缩进。如果不想有太多颜色，可以两个颜色取同样的颜色值。</span><br><span class="hljs-comment">#   - &#123; label: 0, name: &#x27;云水&#x27;, value: &#x27;#B4C3D0&#x27;, alpha: 255, end_color: &#x27;#B4C3D0&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; label: 1, name: &#x27;晴山&#x27;, value: &#x27;#91AEC4&#x27;, alpha: 255, end_color: &#x27;#91AEC4&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; label: 5, name: &#x27;秋波&#x27;, value: &#x27;#8BB8CB&#x27;, alpha: 255, end_color: &#x27;#8BB8CB&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; label: 10, name: &#x27;天韵&#x27;, value: &#x27;#5796B3&#x27;, alpha: 255, end_color: &#x27;#5796B3&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; label: 20, name: &#x27;鸢尾&#x27;, value: &#x27;#1988AE&#x27;, alpha: 255, end_color: &#x27;#1988AE&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; label: 60, name: &#x27;甸子&#x27;, value: &#x27;#238BBC&#x27;, alpha: 255, end_color: &#x27;#238BBC&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; label: 100, name: &#x27;景泰&#x27;, value: &#x27;#2A73AC&#x27;, alpha: 255, end_color: &#x27;#2A73AC&#x27; &#125;</span><br><span class="hljs-comment">#  delay: #延迟单位: ms</span><br><span class="hljs-comment">#   - &#123; label: 1, name: &#x27;云水&#x27;, value: &#x27;#B4C3D0&#x27;, alpha: 255, end_color: &#x27;#B4C3D0&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; label: 100, name: &#x27;晴山&#x27;, value: &#x27;#91AEC4&#x27;, alpha: 255, end_color: &#x27;#91AEC4&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; label: 200, name: &#x27;秋波&#x27;, value: &#x27;#8BB8CB&#x27;, alpha: 255, end_color: &#x27;#8BB8CB&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; label: 300, name: &#x27;天韵&#x27;, value: &#x27;#5796B3&#x27;, alpha: 255, end_color: &#x27;#5796B3&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; label: 500, name: &#x27;鸢尾&#x27;, value: &#x27;#1988AE&#x27;, alpha: 255, end_color: &#x27;#1988AE&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; label: 1000, name: &#x27;甸子&#x27;, value: &#x27;#238BBC&#x27;, alpha: 255, end_color: &#x27;#238BBC&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; label: 2000, name: &#x27;景泰&#x27;, value: &#x27;#2A73AC&#x27;, alpha: 255, end_color: &#x27;#2A73AC&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; label: 99999, name: &#x27;景泰&#x27;, value: &#x27;#8d8b8e&#x27;, alpha: 255 &#125;  #第八个为超时，label无用</span><br><span class="hljs-comment">#  out_color: #topo图用于分辨出口的颜色</span><br><span class="hljs-comment">#   - &#123; name: &#x27;云水&#x27;, value: &#x27;#B4C3D0&#x27;, alpha: 255, end_color: &#x27;#B4C3D0&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; name: &#x27;晴山&#x27;, value: &#x27;#91AEC4&#x27;, alpha: 255, end_color: &#x27;#91AEC4&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; name: &#x27;秋波&#x27;, value: &#x27;#8BB8CB&#x27;, alpha: 255, end_color: &#x27;#8BB8CB&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; name: &#x27;天韵&#x27;, value: &#x27;#5796B3&#x27;, alpha: 255, end_color: &#x27;#5796B3&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; name: &#x27;鸢尾&#x27;, value: &#x27;#1988AE&#x27;, alpha: 255, end_color: &#x27;#1988AE&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; name: &#x27;甸子&#x27;, value: &#x27;#238BBC&#x27;, alpha: 255, end_color: &#x27;#238BBC&#x27; &#125;</span><br><span class="hljs-comment">#   - &#123; name: &#x27;景泰&#x27;, value: &#x27;#2A73AC&#x27;, alpha: 255, end_color: &#x27;#2A73AC&#x27; &#125;</span><br><span class="hljs-comment">#  &quot;yes&quot;: &#x27;#bee47e&#x27; #解锁色块的颜色，注意不要去掉双引号</span><br><span class="hljs-comment">#  &quot;yesalpha&quot;: 255 #解锁颜色块透明度</span><br><span class="hljs-comment">#  &quot;yesend&quot;: &#x27;#bee47e&#x27; #解锁色块的渐变结束颜色，注意不要去掉双引号</span><br><span class="hljs-comment">#  &quot;no&quot;: &#x27;#ee6b73&#x27; #失败色块的颜色，注意不要去掉双引号</span><br><span class="hljs-comment">#  &quot;noalpha&quot;: 255 #失败颜色块透明度</span><br><span class="hljs-comment">#  &quot;noend&quot;: &#x27;#ee6b73&#x27; #失败色块的渐变结束颜色，注意不要去掉双引号</span><br><span class="hljs-comment">#  na: &#x27;#8d8b8e&#x27; #N/A色块的颜色</span><br><span class="hljs-comment">#  naalpha: 255  #N/A颜色块透明度</span><br><span class="hljs-comment">#  naend: &#x27;#8d8b8e&#x27; #N/A色块的渐变结束颜色</span><br><span class="hljs-comment">#  wait: &#x27;#dcc7e1&#x27; #待解锁色块的颜色</span><br><span class="hljs-comment">#  waitalpha: 255  #待解锁色块的颜色</span><br><span class="hljs-comment">#  waitend: &#x27;#dcc7e1&#x27; #待解锁色块的渐变结束颜色</span><br><span class="hljs-comment">#  iprisk: #IP风险色块颜色,名称后面加alpha为颜色块透明度属性</span><br><span class="hljs-comment">#   low: &#x27;#ffffff&#x27;</span><br><span class="hljs-comment">#   lowalpha: 255</span><br><span class="hljs-comment">#   lowend: &#x27;#ffffff&#x27;</span><br><span class="hljs-comment">#   medium: &#x27;#ffffff&#x27;</span><br><span class="hljs-comment">#   mediumalpha: 255</span><br><span class="hljs-comment">#   mediumend: &#x27;#ffffff&#x27;</span><br><span class="hljs-comment">#   high: &#x27;#ffffff&#x27;</span><br><span class="hljs-comment">#   highalpha: 255</span><br><span class="hljs-comment">#   hightend: &#x27;#ffffff&#x27; </span><br><span class="hljs-comment">#   veryhigh: &#x27;#ffffff&#x27;</span><br><span class="hljs-comment">#   veryhighalpha: 255</span><br><span class="hljs-comment">#   veryhighend: &#x27;#ffffff&#x27;</span><br><span class="hljs-comment">#  warn: &#x27;#fcc43c&#x27; #警告色块，一般为黄色或橙色</span><br><span class="hljs-comment">#  warnalpha: 255  #警告颜色块透明度</span><br><span class="hljs-comment">#  warnend: &#x27;#fcc43c&#x27; #警告渐变结束色块</span><br><span class="hljs-comment"># watermark: #水印</span><br><span class="hljs-comment">#  enable: true #是否启用</span><br><span class="hljs-comment">#  text: &#x27;只是一个水印&#x27; #水印文本</span><br><span class="hljs-comment">#  color: &#x27;#000000&#x27; #颜色值</span><br><span class="hljs-comment">#  alpha: 16 # 透明度, 可用范围(0-255)</span><br><span class="hljs-comment">#  font_size: 64 #字体大小</span><br><span class="hljs-comment">#  angle: -16.0 #旋转角度</span><br><span class="hljs-comment">#  row_spacing: 0 #行距</span><br><span class="hljs-comment">#  start_y: 0 #纵坐标起始位置</span><br><span class="hljs-comment"># background: #背景颜色</span><br><span class="hljs-comment">#  backgrounds: &#x27;#ffffff&#x27; #联通性测试背景色</span><br><span class="hljs-comment">#  ins: &#x27;#ffffff&#x27; #拓扑测试入口topo背景色</span><br><span class="hljs-comment">#  outs: &#x27;#ffffff&#x27; #拓扑测试出口topo背景色</span><br><span class="hljs-comment">#  speedtest: &#x27;#ffffff&#x27; #速度测试</span><br><span class="hljs-comment">#  speedtitle: &#x27;#EAEAEA&#x27; #速度测试标题栏颜色</span><br><span class="hljs-comment">#  testtitle: &#x27;#EAEAEA&#x27; #联通性测试标题栏颜色</span><br><span class="hljs-comment">#  topotitle: &#x27;#EAEAEA&#x27; #拓扑测试标题栏颜色</span><br></code></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://fulltclash.gitbook.io/fulltclash-doc/wen-dang/pei-zhi-shuo-ming">配置说明 - FullTclash 文档</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://github.com/AirportR/FullTclash">AirportR&#x2F;FullTclash</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://github.com/We1eVen/fulltclash-docker">We1eVen&#x2F;fulltclash-docker</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">利用FullTClash和TelegramBot，搭建流媒体解锁检测机器人</summary>
    
    
    
    <category term="Major" scheme="https://www.0co.dev/categories/Major/"/>
    
    <category term="Proxies" scheme="https://www.0co.dev/categories/Major/Proxies/"/>
    
    
    <category term="VPS" scheme="https://www.0co.dev/tags/VPS/"/>
    
    <category term="Proxy" scheme="https://www.0co.dev/tags/Proxy/"/>
    
  </entry>
  
  <entry>
    <title>基于LskyPro和阿里云对象存储搭建私有图床</title>
    <link href="https://www.0co.dev/Pichost-aliyunoss-lskypro/"/>
    <id>https://www.0co.dev/Pichost-aliyunoss-lskypro/</id>
    <published>2023-10-31T05:51:13.000Z</published>
    <updated>2024-06-26T11:31:22.764Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基于LskyPro和阿里云对象存储搭建私有图床"><a href="#基于LskyPro和阿里云对象存储搭建私有图床" class="headerlink" title="基于LskyPro和阿里云对象存储搭建私有图床"></a>基于LskyPro和阿里云对象存储搭建私有图床</h1><h2 id="基于Docker搭建"><a href="#基于Docker搭建" class="headerlink" title="基于Docker搭建"></a>基于Docker搭建</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">docker <span class="hljs-keyword">run</span><span class="language-bash"> -d \</span><br><span class="language-bash">    --name lsky-pro \</span><br><span class="language-bash">    --restart=<span class="hljs-string">&quot;always&quot;</span> \</span><br><span class="language-bash">    -p 34323:8089 \</span><br><span class="language-bash">    -v <span class="hljs-variable">$PWD</span>/lsky:/var/www/html \</span><br><span class="language-bash">    -e WEB_PORT=8089 \</span><br><span class="language-bash">    halcyonazure/lsky-pro-docker:latest</span><br>    <br><span class="hljs-comment"># 目前该容器只有一个环境变量：WEB_PORT，用于指定容器内的Apache监听的端口，默认为8089</span><br><span class="hljs-comment"># 如果需要修改的话可以在启动容器时添加-e WEB_PORT=8089来指定端口</span><br></code></pre></td></tr></table></figure><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311142012446.png" alt="deploy"></p><div class="note note-warning">            <p>注意在<strong>服务商控制台</strong>安全组里放行相应端口，<strong>不要</strong>用宝塔放行，大部分不生效。</p>          </div><blockquote><p>#-p 外部映射端口任意选择，<strong>不冲突</strong>即可，内部暴露端口不建议改，根据镜像作者的说明来，有的镜像更改会出问题。</p><p>由于Docker的内部端口是独立的，所以内部暴露端口不需要考虑冲突问题，也就是冒号后面的端口可以在不同容器间重复，比如有很多容器的暴露端口都是<code>8080</code>。</p><p>外部映射端口，也就是冒号前面的端口是不能重复的，因为这是宿主机的端口，每个端口都是唯一的，不能复用。</p><p>#-v 配置data所在目录，根据自己服务器环境更改</p><p>#–name 根据需要更改</p></blockquote><blockquote><p>访问相应<code>ip:port</code>网址访问页面，如<code>123.123.122.111:343223</code></p></blockquote><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311142016579.png" alt="install"></p><p>个人使用，数据库选择<code>SQLite</code>即可，方便迁移。</p><p>如果是第一次使用，没有现成数据，则<code>数据库路径</code>不必填写。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311142018169.png" alt="database"></p><p>安装成功，使用管理员账号登录即可进入管理面板。</p><p>图床的基本框架便搭建完成了。</p><h2 id="使用阿里云OSS存储"><a href="#使用阿里云OSS存储" class="headerlink" title="使用阿里云OSS存储"></a>使用阿里云OSS存储</h2><p>大部分服务器给硬盘都蛮抠的，用来当图床存储实在是捉襟见肘。</p><p>好在兰空图床为我们提供了其他存储方式选择</p><blockquote><p>第三方云储存 <code>AWS S3</code>、<code>阿里云 OSS</code>、<code>腾讯云 COS</code>、<code>七牛云</code>、<code>又拍云</code>、<code>SFTP</code>、<code>FTP</code>、<code>WebDav</code>、<code>Minio</code></p></blockquote><p>这里博主使用阿里云OSS为例。</p><h3 id="创建角色组"><a href="#创建角色组" class="headerlink" title="创建角色组"></a>创建角色组</h3><p>进入控制面板，这里的<code>角色组</code>和<code>储存策略</code>值得我们注意。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311142029307.png" alt="role"></p><p>点击<code>创建角色组</code>。</p><p>笔者设置了<code>Admin</code>和<code>visitor</code>两个角色组，<code>Admin</code>组自用，其他用户的请求均分流到<code>visitor</code>组（上图绿色对钩标记为“默认”，“游客组”）。</p><p>注意<code>路径命名规则</code>,如图填入<code>visitor/</code>表示<code>visitor</code>用户组的图片都会上传到绑定的相应<code>Bucket</code>以根目录为基准的<code>visitor</code>文件夹。</p><p><code>文件命名规则</code>根据需要填写，可以参考下图蓝色字体里的“命名规则对照表”。</p><p>图片保护，水印之类的功能根据自己需要配置。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311142035944.png" alt="visitor"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311142040572.png" alt="bucket"></p><h3 id="添加储存策略"><a href="#添加储存策略" class="headerlink" title="添加储存策略"></a>添加储存策略</h3><p>点击<code>创建储存策略</code>。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311142048699.png" alt="storage"></p><p><code>选择角色组</code>选择的是有权限使用此种存储策略的角色组，<code>按住CTRL，鼠标点击</code>选中多个角色组。</p><p><code>名称</code>随便填。</p><p><code>访问域名</code>如下图箭头所指，<code>地域节点</code>就是下图<code>Bucket域名</code>前面那个。</p><p><code>Bucket名称</code>就填写创建的<code>Bucket</code>的名字（在左上角打码的那个地方）。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311142053700.png" alt="domain"></p><p>点击头像，进入<code>AccessKey管理</code></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311142058889.png" alt="access"></p><p>点击<code>创建AccessKey</code>，获得<code>AccessKeyID</code>和<code>AccessKeySecret</code>，填入图床相应设置项。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311142100360.png" alt="create"></p><p>创建成功之后，相应<code>角色组</code>的成员就可以在管理员所分配的<code>储存策略</code>中选择需要的策略。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311142103877.png" alt="policies"></p><h3 id="FAQs"><a href="#FAQs" class="headerlink" title="FAQs"></a>FAQs</h3><h4 id="初次搭建后，首页元素无法正常显示"><a href="#初次搭建后，首页元素无法正常显示" class="headerlink" title="初次搭建后，首页元素无法正常显示"></a>初次搭建后，首页元素无法正常显示</h4><p>首先停止容器，</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> stop<span class="hljs-meta"> [container]</span><br><span class="hljs-comment"># 如 docker stop c7e</span><br></code></pre></td></tr></table></figure><p>然后进入容器静态资源文件夹，就是部署时配置的<code>$PWD/lsky</code>，根据下图进行修改：</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311142107577.png" alt="static"></p><p>修改后重启即可：</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">docker <span class="hljs-literal">start</span> c7e<br></code></pre></td></tr></table></figure><h4 id="浏览器报错，too-many-redirects"><a href="#浏览器报错，too-many-redirects" class="headerlink" title="浏览器报错，too many redirects"></a>浏览器报错，too many redirects</h4><p>此种情况易在同时开启反代的强制https和cloudflare网站代理时出现，可以通过修改cloudflare的ssl&#x2F;tls策略为full来解决。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202406261925916.png" alt="full tls"></p><h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><p>有其他的问题可以去<a href="https://docs.lsky.pro/docs/free/v2/">官方文档</a><sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Lsky Pro V 2.x | Lsky Pro](https://docs.lsky.pro/docs/free/v2/)">[2]</span></a></sup>或者<a href="https://github.com/lsky-org/lsky-pro/discussions/357">Github问题收集帖</a><sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="[【收集贴】安装兰空v2常见问题及其解决方法](https://github.com/lsky-org/lsky-pro/discussions/357)">[3]</span></a></sup>瞧瞧。</p><hr><p>兰空图床是一款功能强大的开源图床，还有许多其他功能，就留给诸位自己去探索吧。</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://github.com/HalcyonAzure/lsky-pro-docker">HalcyonAzure&#x2F;lsky-pro-docker</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://docs.lsky.pro/docs/free/v2/">Lsky Pro V 2.x | Lsky Pro</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://github.com/lsky-org/lsky-pro/discussions/357">【收集贴】安装兰空v2常见问题及其解决方法</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">使用LskyPro和阿里云OSS搭建图床</summary>
    
    
    
    <category term="Docker" scheme="https://www.0co.dev/categories/Docker/"/>
    
    
    <category term="Docker" scheme="https://www.0co.dev/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>使用Twikoo和LskyPro搭建完善的私有评论系统</title>
    <link href="https://www.0co.dev/Comment-Twikoo-LskyPro/"/>
    <id>https://www.0co.dev/Comment-Twikoo-LskyPro/</id>
    <published>2023-10-26T08:49:57.000Z</published>
    <updated>2023-11-14T12:06:55.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="使用Twikoo和LskyPro搭建完善的私有评论系统"><a href="#使用Twikoo和LskyPro搭建完善的私有评论系统" class="headerlink" title="使用Twikoo和LskyPro搭建完善的私有评论系统"></a>使用Twikoo和LskyPro搭建完善的私有评论系统</h1><blockquote><p>教程包含以下部分：</p><ul><li>Twikoo搭建</li><li>Twikoo嵌入Hexo-Fluid</li><li>LskyPro-Twikoo配置</li></ul></blockquote><h2 id="基于Docker搭建Twikoo"><a href="#基于Docker搭建Twikoo" class="headerlink" title="基于Docker搭建Twikoo"></a>基于Docker搭建Twikoo</h2><h3 id="启动容器"><a href="#启动容器" class="headerlink" title="启动容器"></a>启动容器</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">docker <span class="hljs-keyword">run</span><span class="language-bash"> -d \</span><br><span class="language-bash">--name twikoo \</span><br><span class="language-bash">--restart=<span class="hljs-string">&quot;always&quot;</span> \</span><br><span class="language-bash">-e TWIKOO_THROTTLE=1000 \</span><br><span class="language-bash">-p 34322:8080 \</span><br><span class="language-bash">-v /home/konrad/twikoo/data/:/app/data \</span><br><span class="language-bash">-d imaegoo/twikoo</span><br></code></pre></td></tr></table></figure><div class="note note-success">            <p>注意在<strong>服务商控制台</strong>安全组里放行相应端口，<strong>不要</strong>用宝塔放行，大部分不生效。</p>          </div><blockquote><p>#-p 外部映射端口任意选择，<strong>不冲突</strong>即可，内部暴露端口不建议改，根据镜像作者的说明来，有的镜像更改会出问题。</p><p>由于Docker的内部端口是独立的，所以内部暴露端口不需要考虑冲突问题，也就是冒号后面的端口可以在不同容器间重复，比如有很多容器的暴露端口都是<code>8080</code>。</p><p>外部映射端口，也就是冒号前面的端口是不能重复的，因为这是宿主机的端口，每个端口都是唯一的，不能复用。</p><p>#-v 配置data所在目录，根据自己服务器环境更改</p><p>#–name 根据需要更改</p></blockquote><blockquote><p>访问相应<code>ip:port</code>网址访问页面，如<code>123.123.122.111:34322</code></p></blockquote><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310311411665.png" alt="success"></p><h3 id="绑定域名"><a href="#绑定域名" class="headerlink" title="绑定域名"></a>绑定域名</h3><p>根据<code>Twikoo</code>官方文档的阐述，我们必须要通过绑定域名的方式来进行<code>https</code>加密，笔者实测，使用<code>ip:port</code>的常规访问方式是不生效的，所以，这次的域名配置将是必选。</p><p>去域名注册商或DNS提供商处添加<code>A</code>型解析，解析到当前服务器。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310311415873.png" alt="dns"></p><p>然后是熟悉的宝塔添加网站，证书，并配置反代的过程。</p><blockquote><p>以下示意图引用自博主另一篇文章，端口不对应，注意更改</p></blockquote><p>当然，添加网站和<code>SSL</code>证书申请是必要的前期工作。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310271934061.png" alt="添加网站"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310271934224.png" alt="申请证书"></p><p>开启反向代理，代理到本地相应端口。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310271934112.png" alt="settings"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310271934964.png" alt="reproxy"></p><p>域名绑定成功之后，我们就可以通过访问域名看到刚才同样的成功信息。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310311420815.png" alt="success"></p><h2 id="Hexo-Fluid启用Twikoo"><a href="#Hexo-Fluid启用Twikoo" class="headerlink" title="Hexo-Fluid启用Twikoo"></a>Hexo-Fluid启用Twikoo</h2><p>在<code>_config.fluid.yml</code>进行配置</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310311425398.png" alt="set"></p><p>下滑，填入<code>envID</code>，即所绑定的域名</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310311427568.png" alt="bond"></p><p>保存生成之后，就可以看到页面底部的评论系统。</p><p>点击齿轮可以进入设置</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310311428334.png" alt="Comment System"></p><h2 id="接入LskyPro"><a href="#接入LskyPro" class="headerlink" title="接入LskyPro"></a>接入LskyPro</h2><p>LskyPro图床的搭建，请查看</p><a href="/Pichost-aliyunoss-lskypro/" title="基于LskyPro和阿里云对象存储搭建私有图床">基于LskyPro和阿里云对象存储搭建私有图床</a><h3 id="token获取"><a href="#token获取" class="headerlink" title="token获取"></a>token获取</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl -X POST -F &quot;email=your_email@address&quot; -F &quot;password=your_passwd&quot; https://your.domain/api/v1/tokens<br></code></pre></td></tr></table></figure><p>将上述信息替换成你自己的，运行代码即可获得以数字开头的<code>token</code>，如<code>1|fafdafdadfasfadf</code></p><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>进入<code>Twikoo管理面板</code>-&gt;<code>配置管理</code>-&gt;<code>插件</code></p><p>填入私有图床网址和<code>token</code>，保存即可。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310311436236.png" alt="pichost"></p><hr><p>到此为止，你的博客已经拥有了一套完整的评论系统。</p><p>↓↓↓你也可以在下面尝试一下↓↓↓↓</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://twikoo.js.org/backend.html#%E7%A7%81%E6%9C%89%E9%83%A8%E7%BD%B2-docker">云函数部署 | Twikoo 文档</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://github.com/lsky-org/lsky-pro/discussions/357">lsky-org&#x2F;lsky-pro · Discussion #357 (github.com)</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">使用Twikoo和LskyPro搭建自有评论，安全放心</summary>
    
    
    
    <category term="Docker" scheme="https://www.0co.dev/categories/Docker/"/>
    
    
    <category term="Docker" scheme="https://www.0co.dev/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>海外VPS搭建SubConvertor订阅转换工具</title>
    <link href="https://www.0co.dev/SubConvertor/"/>
    <id>https://www.0co.dev/SubConvertor/</id>
    <published>2023-10-23T06:10:40.000Z</published>
    <updated>2023-11-12T13:00:07.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="海外VPS搭建SubConvertor订阅转换工具"><a href="#海外VPS搭建SubConvertor订阅转换工具" class="headerlink" title="海外VPS搭建SubConvertor订阅转换工具"></a>海外VPS搭建SubConvertor订阅转换工具</h1><blockquote><p>示例链接：<a href="https://convertor.wisedrifter.top/">SubConverter</a></p><p>博主自用规则文件：<a href="https://github.com/MegaSuite/Clash-Configs/blob/main/Policy/ClashGeneral.ini">Clash-Configs&#x2F;Policy&#x2F;ClashGeneral.ini</a></p></blockquote><blockquote><p>教程由以下两部分组成：</p><ul><li>后端 subconverter</li><li>前端 sub-web</li></ul></blockquote><h2 id="后端搭建"><a href="#后端搭建" class="headerlink" title="后端搭建"></a>后端搭建</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">docker <span class="hljs-keyword">run</span><span class="language-bash"> -d \</span><br><span class="language-bash">--restart=always \</span><br><span class="language-bash">--name subconverter \</span><br><span class="language-bash">-p 34324:25500 \</span><br><span class="language-bash">tindy2013/subconverter:latest</span><br><br><span class="hljs-comment">#-p 外部映射端口自选，与下方同步即可</span><br></code></pre></td></tr></table></figure><div class="note note-success">            <p>注意在<strong>服务商控制台</strong>安全组里放行相应端口，<strong>不要</strong>用宝塔放行，大部分不生效。</p>          </div><blockquote><p>#-p 外部映射端口任意选择，<strong>不冲突</strong>即可，内部暴露端口不建议改，根据镜像作者的说明来，有的镜像更改会出问题。</p><p>由于Docker的内部端口是独立的，所以内部暴露端口不需要考虑冲突问题，也就是冒号后面的端口可以在不同容器间重复，比如有很多容器的暴露端口都是<code>8080</code>。</p><p>外部映射端口，也就是冒号前面的端口是不能重复的，因为这是宿主机的端口，每个端口都是唯一的，不能复用。</p><p>#–name 根据需要更改</p></blockquote><p>使用<code>docker ps</code>查看运行中的容器。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310271931496.png" alt="container"></p><p>运行之后，使用以下命令查看状态</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl http://localhost:34324/version<br><span class="hljs-comment"># 如果出现`subconverter vx.x.x backend`字样，表明运行成功</span><br></code></pre></td></tr></table></figure><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310271930936.png" alt="success"></p><p>根据需要为后端绑定域名，配置反代（可选，可以直接用<code>ip:port</code>访问）</p><blockquote><p>以下示意图引用自博主另一篇文章，端口不对应，注意更改</p></blockquote><p>在域名提供商处设置<code>DNS</code>记录</p><p>当然，添加网站和<code>SSL</code>证书申请是必要的前期工作。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310271934061.png" alt="添加网站"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310271934224.png" alt="申请证书"></p><p>开启反向代理，代理到本地相应端口。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310271934112.png" alt="settings"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310271934964.png" alt="reproxy"></p><h2 id="前端搭建"><a href="#前端搭建" class="headerlink" title="前端搭建"></a>前端搭建</h2><p>使用<code>docker</code>运行前端需要更改文件后自行构建镜像。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Clone项目到本地 </span><br>git <span class="hljs-built_in">clone</span> https://github.com/CareyWang/sub-web.git<br><span class="hljs-built_in">cd</span> sub-web <br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 编辑.env配置文件(也可搭配其他文件编辑器，如VScode)</span><br>vi .<span class="hljs-built_in">env</span> <br></code></pre></td></tr></table></figure><p>进入<code>.env</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 没有其他需求就只改`API后端`就行。</span><br><br>VUE_APP_PROJECT = <span class="hljs-string">&quot;https://github.com/CareyWang/sub-web&quot;</span><br><br>VUE_APP_BOT_LINK = <span class="hljs-string">&quot;https://t.me/subconverter_discuss&quot;</span><br><br>VUE_APP_BACKEND_RELEASE = <span class="hljs-string">&quot;https://github.com/tindy2013/subconverter/actions&quot;</span><br><br>VUE_APP_SUBCONVERTER_REMOTE_CONFIG = <span class="hljs-string">&quot;https://raw.githubusercontent.com/tindy2013/subconverter/master/base/config/example_external_config.ini&quot;</span><br><br><span class="hljs-comment"># API 后端，填写自己绑定的域名，或者`ip:port`</span><br>VUE_APP_SUBCONVERTER_DEFAULT_BACKEND = <span class="hljs-string">&quot;https://sub.wisedrifter.top&quot;</span><br><br><span class="hljs-comment"># 短链接后端（可选）</span><br>VUE_APP_MYURLS_API = <span class="hljs-string">&quot;https://suo.yt/short&quot;</span><br><br><span class="hljs-comment"># 文本托管后端</span><br>VUE_APP_CONFIG_UPLOAD_API = <span class="hljs-string">&quot;https://oss.wcc.best/upload&quot;</span><br><br><span class="hljs-comment"># 页面配置</span><br>VUE_APP_USE_STORAGE = <span class="hljs-literal">true</span> <br>VUE_APP_CACHE_TTL = 86400<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 编辑subconverter.vue</span><br><span class="hljs-built_in">cd</span> src/views <br>vi Subconverter.vue  <br></code></pre></td></tr></table></figure><p>进入<code>subconverter.vue</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 修改下列内容</span><br><br><span class="hljs-comment"># 修改后端，填你刚才搭建的后端，注意后面的`/sub?`</span><br>backendOptions: [&#123; value: <span class="hljs-string">&quot;https://sub.wisedrifter.top/sub?&quot;</span> &#125;],<br><br><span class="hljs-comment"># 修改远程配置，第一个为博主自己写的配置，包含`Disney+`,`Netflix`,`Prime Video`,`OneDrive`等常用分流</span><br>remoteConfig: [<br>          &#123;<br>            label: <span class="hljs-string">&quot;universal&quot;</span>,<br>            options: [<br>              &#123;<br>                label:<span class="hljs-string">&quot;Konrad自用分流，（Github：MegaSuite）&quot;</span>,<br>                value:<br>                <span class="hljs-string">&quot;https://raw.githubusercontent.com/MegaSuite/Clash-Configs/main/Policy/ClashGeneral.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Online 默认版 分组比较全 (与Github同步)&quot;</span>,<br>                value:<br>                  <span class="hljs-string">&quot;https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Online_AdblockPlus 更多去广告 (与Github同步)&quot;</span>,<br>                value:<br>                  <span class="hljs-string">&quot;https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_AdblockPlus.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Online_NoAuto 无自动测速 (与Github同步)&quot;</span>,<br>                value:<br>                  <span class="hljs-string">&quot;https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_NoAuto.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Online_NoReject 无广告拦截规则 (与Github同步)&quot;</span>,<br>                value:<br>                  <span class="hljs-string">&quot;https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_NoReject.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Online_Mini 精简版 (与Github同步)&quot;</span>,<br>                value:<br>                  <span class="hljs-string">&quot;https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_Mini.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Online_Mini_AdblockPlus.ini 精简版 更多去广告 (与Github同步)&quot;</span>,<br>                value:<br>                  <span class="hljs-string">&quot;https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_Mini_AdblockPlus.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Online_Mini_NoAuto.ini 精简版 不带自动测速 (与Github同步)&quot;</span>,<br>                value:<br>                  <span class="hljs-string">&quot;https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_Mini_NoAuto.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Online_Mini_Fallback.ini 精简版 带故障转移 (与Github同步)&quot;</span>,<br>                value:<br>                  <span class="hljs-string">&quot;https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_Mini_Fallback.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Online_Mini_MultiMode.ini 精简版 自动测速、故障转移、负载均衡 (与Github同步)&quot;</span>,<br>                value:<br>                  <span class="hljs-string">&quot;https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_Mini_MultiMode.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Online_Full 全分组 重度用户使用 (与Github同步)&quot;</span>,<br>                value:<br>                  <span class="hljs-string">&quot;https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_Full.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Online_Full_NoAuto.ini 全分组 无自动测速 重度用户使用 (与Github同步)&quot;</span>,<br>                value:<br>                  <span class="hljs-string">&quot;https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_Full_NoAuto.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Online_Full_AdblockPlus 全分组 重度用户使用 更多去广告 (与Github同步)&quot;</span>,<br>                value:<br>                  <span class="hljs-string">&quot;https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_Full_AdblockPlus.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Online_Full_Netflix 全分组 重度用户使用 奈飞全量 (与Github同步)&quot;</span>,<br>                value:<br>                  <span class="hljs-string">&quot;https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/config/ACL4SSR_Online_Full_Netflix.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR 本地 默认版 分组比较全&quot;</span>,<br>                value: <span class="hljs-string">&quot;config/ACL4SSR.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Mini 本地 精简版&quot;</span>,<br>                value: <span class="hljs-string">&quot;config/ACL4SSR_Mini.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Mini_NoAuto.ini 本地 精简版+无自动测速&quot;</span>,<br>                value: <span class="hljs-string">&quot;config/ACL4SSR_Mini_NoAuto.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_Mini_Fallback.ini 本地 精简版+fallback&quot;</span>,<br>                value: <span class="hljs-string">&quot;config/ACL4SSR_Mini_Fallback.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_BackCN 本地 回国&quot;</span>,<br>                value: <span class="hljs-string">&quot;config/ACL4SSR_BackCN.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_NoApple 本地 无苹果分流&quot;</span>,<br>                value: <span class="hljs-string">&quot;config/ACL4SSR_NoApple.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_NoAuto 本地 无自动测速 &quot;</span>,<br>                value: <span class="hljs-string">&quot;config/ACL4SSR_NoAuto.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_NoAuto_NoApple 本地 无自动测速&amp;无苹果分流&quot;</span>,<br>                value: <span class="hljs-string">&quot;config/ACL4SSR_NoAuto_NoApple.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_NoMicrosoft 本地 无微软分流&quot;</span>,<br>                value: <span class="hljs-string">&quot;config/ACL4SSR_NoMicrosoft.ini&quot;</span><br>              &#125;,<br>              &#123;<br>                label: <span class="hljs-string">&quot;ACL4SSR_WithGFW 本地 GFW列表&quot;</span>,<br>                value: <span class="hljs-string">&quot;config/ACL4SSR_WithGFW.ini&quot;</span><br>              &#125;<br>            ]<br>          &#125;,<br>        ]<br></code></pre></td></tr></table></figure><p>代码结构如下：</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310271947399.png" alt="subconverter.vue"></p><p>保存之后，进行镜像构建。</p><blockquote><p>注意最后的”<code>.</code>“，不要漏掉。</p><p>冒号前的<code>sub-web</code>是目前存放前端的文件夹名</p><p>构建命令需要在前端文件夹内执行，否则会提醒<code>找不到Dockerfile</code></p></blockquote><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment">#构建镜像</span><br>docker build -t sub-web:latest .  <br><span class="hljs-comment">#查看镜像是否构建成功,有同名镜像即为成功</span><br>docker images<br><span class="hljs-comment">#部署服务 </span><br>docker <span class="hljs-keyword">run</span><span class="language-bash"> -d \</span><br><span class="language-bash">-p 34325:80 \</span><br><span class="language-bash">--restart always \</span><br><span class="language-bash">--name subweb \</span><br><span class="language-bash">sub-web:latest</span><br></code></pre></td></tr></table></figure><p>执行<code>docker ps</code>查看状态</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310271957970.png" alt="sub-web"></p><p>浏览器中输入<code>ip:port</code>可以看到网页，如<code>123.11.112.111:34325</code></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310272000366.png" alt="page"></p><p>同样可以为前端设置域名和反代，跟前面的流程相同，不赘述。</p><p>到现在为止，一个完整的私有订阅转换就搭建完了。</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://github.com/tindy2013/subconverter">tindy2013&#x2F;subconverter</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://github.com/tindy2013/subconverter/blob/master/README-docker.md">subconverter&#x2F;README-docker.md</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://github.com/CareyWang/sub-web">CareyWang&#x2F;sub-web</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://blog.steveee.me/posts/Subconverter/">Subconverter+Subweb+MyUrls搭建教程 (Docker版本) - Steve’s Blog</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://github.com/MegaSuite/Clash-Configs/blob/main/Policy/ClashGeneral.ini">Clash-Configs&#x2F;Policy&#x2F;ClashGeneral.ini</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">基于Docker搭建订阅转换服务，clash也能实现分流规则自定义</summary>
    
    
    
    <category term="Major" scheme="https://www.0co.dev/categories/Major/"/>
    
    <category term="Proxies" scheme="https://www.0co.dev/categories/Major/Proxies/"/>
    
    
    <category term="VPS" scheme="https://www.0co.dev/tags/VPS/"/>
    
    <category term="Proxy" scheme="https://www.0co.dev/tags/Proxy/"/>
    
  </entry>
  
  <entry>
    <title>海外VPS使用Trojan协议搭建代理</title>
    <link href="https://www.0co.dev/Trojan-Proxy/"/>
    <id>https://www.0co.dev/Trojan-Proxy/</id>
    <published>2023-10-23T06:09:29.000Z</published>
    <updated>2023-11-10T14:20:52.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="海外VPS使用Trojan协议搭建代理"><a href="#海外VPS使用Trojan协议搭建代理" class="headerlink" title="海外VPS使用Trojan协议搭建代理"></a>海外VPS使用Trojan协议搭建代理</h1><h2 id="使用自动脚本"><a href="#使用自动脚本" class="headerlink" title="使用自动脚本"></a>使用自动脚本</h2><p>安装前需要将任意域名解析到此VPS，如<code>proxy.sakiison.icu</code>，可以使用二级域名三级域名。</p><p>在root用户权限下运行下列脚本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#安装/更新</span><br><span class="hljs-built_in">source</span> &lt;(curl -sL https://git.io/trojan-install)<br><br><span class="hljs-comment">#卸载</span><br><span class="hljs-built_in">source</span> &lt;(curl -sL https://git.io/trojan-install) --remove<br></code></pre></td></tr></table></figure><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102051643.png" alt="installing"></p><p>使用<code>trojan</code>协议需要申请证书，个人常用的是第一种和第四种，新手建议使用第一种，有效期3个月可自动续签；第四种下文讲解。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102051287.png" alt="encrypt"></p><p>安装数据库，建议用第一个就好。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102053695.png" alt="database"></p><p>等他跑一会就装好了，之后命令行会出现管理面板。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102057007.png" alt="1"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102058828.png" alt="2"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102058973.png" alt="3"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102058142.png" alt="5"></p><p>可以通过浏览器访问<code>https://域名</code>进入管理面板进行多用户管理。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102101095.png" alt="panel"></p><p>装完了，简单高效！~</p><h2 id="证书有关问题"><a href="#证书有关问题" class="headerlink" title="证书有关问题"></a>证书有关问题</h2><h3 id="第一种-Let-s-Encrypt："><a href="#第一种-Let-s-Encrypt：" class="headerlink" title="第一种,Let&#39;s Encrypt："></a>第一种,<code>Let&#39;s Encrypt</code>：</h3><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102105991.png" alt="let&#39;s encrypt"></p><p>选择<code>1</code>，填入域名，会自动运行证书申请脚本。</p><h3 id="第四种，自定义证书"><a href="#第四种，自定义证书" class="headerlink" title="第四种，自定义证书"></a>第四种，自定义证书</h3><blockquote><p>此方案针对已经在域名注册商处申请证书的用户，导入证书使用。</p></blockquote><p>部分域名注册商会提供免费证书额度，按照指示申请即可，以腾讯云为例。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102207858.png" alt="Tencent cloud"></p><p>大部分网站用个免费的就够了。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102208455.png" alt="cert"></p><p>根据提示设置就好，验证方式我一般用文件验证，用宝塔面板传个文件很容易，DNS有时候就很慢，很久不生效。自己选个适合的就行。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102212187.png" alt="验证"></p><p>申请成功之后会有邮件短信提示，现在就可以下载证书了。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102213245.png" alt="download"></p><p>下载格式随便选，注意要有<code>crt</code>和<code>key</code>文件。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102217418.png" alt="cert format"></p><p>下载解压之后，上传。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202311102157043.png" alt="auth"></p><p>将证书的<code>cert</code>和<code>key</code>上传至任意路径，粘贴路径于输入框即可。</p><hr><p><strong>Enjoy！</strong></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>[VPS 初体验（三）在 VPS 上快速搭建 trojan 服务](<a href="https://kiku.vip/2021/10/16/%E5%9C%A8">https://kiku.vip/2021/10/16/在</a> VPS 快速搭建 trojan 服务&#x2F;)<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://github.com/Jrohy/trojan">Jrohy&#x2F;trojan: trojan多用户管理部署程序, 支持web页面管理</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">通过Trojan协议搭建代理，实现快速安全访问</summary>
    
    
    
    <category term="Major" scheme="https://www.0co.dev/categories/Major/"/>
    
    <category term="Proxies" scheme="https://www.0co.dev/categories/Major/Proxies/"/>
    
    
    <category term="VPS" scheme="https://www.0co.dev/tags/VPS/"/>
    
    <category term="Proxy" scheme="https://www.0co.dev/tags/Proxy/"/>
    
    <category term="Trojan" scheme="https://www.0co.dev/tags/Trojan/"/>
    
  </entry>
  
  <entry>
    <title>通过privatebin和docker搭建在线剪贴板</title>
    <link href="https://www.0co.dev/privatebin-by-docker/"/>
    <id>https://www.0co.dev/privatebin-by-docker/</id>
    <published>2023-10-23T06:08:18.000Z</published>
    <updated>2024-07-11T04:04:25.579Z</updated>
    
    <content type="html"><![CDATA[<h1 id="通过privatebin和docker搭建在线剪贴板"><a href="#通过privatebin和docker搭建在线剪贴板" class="headerlink" title="通过privatebin和docker搭建在线剪贴板"></a>通过privatebin和docker搭建在线剪贴板</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><div class="note note-success">            <p>不要用国内服务器，不要用国内服务器。除非你喜欢备案</p>          </div><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310270926131.png" alt="苦笑.jpg"></p><p><strong>正片开始</strong></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">docker <span class="hljs-keyword">run</span><span class="language-bash"> -d \</span><br><span class="language-bash">--restart=<span class="hljs-string">&quot;always&quot;</span> \</span><br><span class="language-bash">--name=privatebin \</span><br><span class="language-bash">--read-only \</span><br><span class="language-bash">-p 34321:8080 \</span><br><span class="language-bash">-v /home/konrad/privatebin/config/conf.php:/srv/cfg/conf.php:ro \</span><br><span class="language-bash">-v /home/konrad/privatebin/data/:/srv/data \</span><br><span class="language-bash">privatebin/nginx-fpm-alpine</span><br></code></pre></td></tr></table></figure><div class="note note-success">            <p>注意在<strong>服务商控制台</strong>安全组里放行相应端口，<strong>不要</strong>用宝塔放行，大部分不生效。</p>          </div><blockquote><p>#-p 外部映射端口任意选择，<strong>不冲突</strong>即可，内部暴露端口不建议改，根据镜像作者的说明来，有的镜像更改会出问题。</p><p>由于Docker的内部端口是独立的，所以内部暴露端口不需要考虑冲突问题，也就是冒号后面的端口可以在不同容器间重复，比如有很多容器的暴露端口都是<code>8080</code>。</p><p>外部映射端口，也就是冒号前面的端口是不能重复的，因为这是宿主机的端口，每个端口都是唯一的，不能复用。</p><p>#-v 配置data 和 config所在目录，根据自己服务器环境更改</p><p>#–name 根据需要更改</p></blockquote><blockquote><p>访问相应<code>ip:port</code>网址访问页面，如<code>123.123.122.111:34321</code></p></blockquote><h2 id="配置域名"><a href="#配置域名" class="headerlink" title="配置域名"></a>配置域名</h2><p>直接使用<code>ip</code>访问会出现错误，要求我们使用<code>https</code>协议，所以我们要配置域名和反向代理。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310270930335.png" alt="error"></p><p>去域名注册商或DNS提供商处添加<code>A</code>型解析，解析到当前服务器，添加网站和<code>SSL</code>证书申请也是必要的前期工作。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310270938114.png" alt="添加网站"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310270938576.png" alt="申请证书"></p><p>开启代理，代理到本地相应端口。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310270934342.png" alt="settings"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310270933231.png" alt="reproxy"></p><p>用绑定的域名访问就可以正常使用了</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310270940225.png" alt="done！"></p><h2 id="自定义配置"><a href="#自定义配置" class="headerlink" title="自定义配置"></a>自定义配置</h2><p>以下是<code>conf.php</code>文件的内容，可根据需要更改。</p><p>此文件需要存放于刚才配置的<code>config</code>目录。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310270943503.png" alt="config"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br></pre></td><td class="code"><pre><code class="hljs php">;<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">http_response_code</span>(<span class="hljs-number">403</span>); <span class="hljs-comment">/*</span><br><span class="hljs-comment">; config file for PrivateBin</span><br><span class="hljs-comment">;</span><br><span class="hljs-comment">; An explanation of each setting can be find online at https://github.com/PrivateBin/PrivateBin/wiki/Configuration.</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">[main]</span><br><span class="hljs-comment">; (optional) set a project name to be displayed on the website</span><br><span class="hljs-comment">name = &quot;Konrad&#x27;s PrivateBin&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">#页首显示的名字</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; The full URL, with the domain name and directories that point to the</span><br><span class="hljs-comment">; PrivateBin files, including an ending slash (/). This URL is essential to</span><br><span class="hljs-comment">; allow Opengraph images to be displayed on social networks.</span><br><span class="hljs-comment">; basepath = &quot;https://privatebin.example.com/&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; enable or disable the discussion feature, defaults to true</span><br><span class="hljs-comment">discussion = true</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; preselect the discussion feature, defaults to false</span><br><span class="hljs-comment">opendiscussion = false</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; enable or disable the password feature, defaults to true</span><br><span class="hljs-comment">password = true</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; enable or disable the file upload feature, defaults to false</span><br><span class="hljs-comment">fileupload = true</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; preselect the burn-after-reading feature, defaults to false</span><br><span class="hljs-comment">burnafterreadingselected = false</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; which display mode to preselect by default, defaults to &quot;plaintext&quot;</span><br><span class="hljs-comment">; make sure the value exists in [formatter_options]</span><br><span class="hljs-comment">defaultformatter = &quot;plaintext&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; (optional) set a syntax highlighting theme, as found in css/prettify/</span><br><span class="hljs-comment">syntaxhighlightingtheme = &quot;sons-of-obsidian&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; size limit per paste or comment in bytes, defaults to 10 Mebibytes</span><br><span class="hljs-comment">sizelimit = 10485760</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; template to include, default is &quot;bootstrap&quot; (tpl/bootstrap.php)</span><br><span class="hljs-comment">template = &quot;bootstrap&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; (optional) info text to display</span><br><span class="hljs-comment">; use single, instead of double quotes for HTML attributes</span><br><span class="hljs-comment">;info = &quot;More information on the &lt;a href=&#x27;https://privatebin.info/&#x27;&gt;project page&lt;/a&gt;.&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; (optional) notice to display</span><br><span class="hljs-comment">; notice = &quot;Note: This is a test service: Data may be deleted anytime. Kittens will die if you abuse this service.&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; by default PrivateBin will guess the visitors language based on the browsers</span><br><span class="hljs-comment">; settings. Optionally you can enable the language selection menu, which uses</span><br><span class="hljs-comment">; a session cookie to store the choice until the browser is closed.</span><br><span class="hljs-comment">languageselection = false</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; set the language your installs defaults to, defaults to English</span><br><span class="hljs-comment">; if this is set and language selection is disabled, this will be the only language</span><br><span class="hljs-comment">; languagedefault = &quot;en&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; (optional) URL shortener address to offer after a new paste is created.</span><br><span class="hljs-comment">; It is suggested to only use this with self-hosted shorteners as this will leak</span><br><span class="hljs-comment">; the pastes encryption key.</span><br><span class="hljs-comment">; urlshortener = &quot;https://shortener.example.com/api?link=&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; (optional) Let users create a QR code for sharing the paste URL with one click.</span><br><span class="hljs-comment">; It works both when a new paste is created and when you view a paste.</span><br><span class="hljs-comment">qrcode = true</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; (optional) Let users send an email sharing the paste URL with one click.</span><br><span class="hljs-comment">; It works both when a new paste is created and when you view a paste.</span><br><span class="hljs-comment">; email = true</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; (optional) IP based icons are a weak mechanism to detect if a comment was from</span><br><span class="hljs-comment">; a different user when the same username was used in a comment. It might get</span><br><span class="hljs-comment">; used to get the IP of a comment poster if the server salt is leaked and a</span><br><span class="hljs-comment">; SHA512 HMAC rainbow table is generated for all (relevant) IPs.</span><br><span class="hljs-comment">; Can be set to one these values:</span><br><span class="hljs-comment">; &quot;none&quot; / &quot;identicon&quot; (default) / &quot;jdenticon&quot; / &quot;vizhash&quot;.</span><br><span class="hljs-comment">; icon = &quot;none&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; Content Security Policy headers allow a website to restrict what sources are</span><br><span class="hljs-comment">; allowed to be accessed in its context. You need to change this if you added</span><br><span class="hljs-comment">; custom scripts from third-party domains to your templates, e.g. tracking</span><br><span class="hljs-comment">; scripts or run your site behind certain DDoS-protection services.</span><br><span class="hljs-comment">; Check the documentation at https://content-security-policy.com/</span><br><span class="hljs-comment">; Notes:</span><br><span class="hljs-comment">; - If you use a bootstrap theme, you can remove the allow-popups from the</span><br><span class="hljs-comment">;   sandbox restrictions.</span><br><span class="hljs-comment">; - By default this disallows to load images from third-party servers, e.g. when</span><br><span class="hljs-comment">;   they are embedded in pastes. If you wish to allow that, you can adjust the</span><br><span class="hljs-comment">;   policy here. See https://github.com/PrivateBin/PrivateBin/wiki/FAQ#why-does-not-it-load-embedded-images</span><br><span class="hljs-comment">;   for details.</span><br><span class="hljs-comment">; - The &#x27;unsafe-eval&#x27; is used in two cases; to check if the browser supports</span><br><span class="hljs-comment">;   async functions and display an error if not and for Chrome to enable</span><br><span class="hljs-comment">;   webassembly support (used for zlib compression). You can remove it if Chrome</span><br><span class="hljs-comment">;   doesn&#x27;t need to be supported and old browsers don&#x27;t need to be warned.</span><br><span class="hljs-comment">cspheader = &quot;default-src &#x27;none&#x27;; base-uri &#x27;self&#x27;; form-action &#x27;none&#x27;; manifest-src &#x27;self&#x27;; connect-src * blob:; script-src &#x27;self&#x27; &#x27;unsafe-eval&#x27;; style-src &#x27;self&#x27;; font-src &#x27;self&#x27;; frame-ancestors &#x27;none&#x27;; img-src &#x27;self&#x27; data: https:; media-src blob:; object-src blob:; sandbox allow-same-origin allow-scripts allow-forms allow-popups allow-modals allow-downloads&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">#去除`cspheader`前的注释符号，将 cspheader 中的 `img-src &#x27;self&#x27; data: blob:` 改为 `img-src &#x27;self&#x27; data: https:`</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; stay compatible with PrivateBin Alpha 0.19, less secure</span><br><span class="hljs-comment">; if enabled will use base64.js version 1.7 instead of 2.1.9 and sha1 instead of</span><br><span class="hljs-comment">; sha256 in HMAC for the deletion token</span><br><span class="hljs-comment">; zerobincompatibility = false</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; Enable or disable the warning message when the site is served over an insecure</span><br><span class="hljs-comment">; connection (insecure HTTP instead of HTTPS), defaults to true.</span><br><span class="hljs-comment">; Secure transport methods like Tor and I2P domains are automatically whitelisted.</span><br><span class="hljs-comment">; It is **strongly discouraged** to disable this.</span><br><span class="hljs-comment">; See https://github.com/PrivateBin/PrivateBin/wiki/FAQ#why-does-it-show-me-an-error-about-an-insecure-connection for more information.</span><br><span class="hljs-comment">; httpwarning = true</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; Pick compression algorithm or disable it. Only applies to pastes/comments</span><br><span class="hljs-comment">; created after changing the setting.</span><br><span class="hljs-comment">; Can be set to one these values: &quot;none&quot; / &quot;zlib&quot; (default).</span><br><span class="hljs-comment">; compression = &quot;zlib&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">[expire]</span><br><span class="hljs-comment">; expire value that is selected per default</span><br><span class="hljs-comment">; make sure the value exists in [expire_options]</span><br><span class="hljs-comment">default = &quot;1day&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">[expire_options]</span><br><span class="hljs-comment">; Set each one of these to the number of seconds in the expiration period,</span><br><span class="hljs-comment">; or 0 if it should never expire</span><br><span class="hljs-comment">5min = 300</span><br><span class="hljs-comment">10min = 600</span><br><span class="hljs-comment">1hour = 3600</span><br><span class="hljs-comment">1day = 86400</span><br><span class="hljs-comment">1week = 604800</span><br><span class="hljs-comment">; Well this is not *exactly* one month, it&#x27;s 30 days:</span><br><span class="hljs-comment">1month = 2592000</span><br><span class="hljs-comment">1year = 31536000</span><br><span class="hljs-comment">never = 0</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">[formatter_options]</span><br><span class="hljs-comment">; Set available formatters, their order and their labels</span><br><span class="hljs-comment">plaintext = &quot;Plain Text&quot;</span><br><span class="hljs-comment">syntaxhighlighting = &quot;Source Code&quot;</span><br><span class="hljs-comment">markdown = &quot;Markdown&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">[traffic]</span><br><span class="hljs-comment">; time limit between calls from the same IP address in seconds</span><br><span class="hljs-comment">; Set this to 0 to disable rate limiting.</span><br><span class="hljs-comment">limit = 10</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; (optional) Set IPs addresses (v4 or v6) or subnets (CIDR) which are exempted</span><br><span class="hljs-comment">; from the rate-limit. Invalid IPs will be ignored. If multiple values are to</span><br><span class="hljs-comment">; be exempted, the list needs to be comma separated. Leave unset to disable</span><br><span class="hljs-comment">; exemptions.</span><br><span class="hljs-comment">; exempted = &quot;1.2.3.4,10.10.10/24&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; (optional) If you want only some source IP addresses (v4 or v6) or subnets</span><br><span class="hljs-comment">; (CIDR) to be allowed to create pastes, set these here. Invalid IPs will be</span><br><span class="hljs-comment">; ignored. If multiple values are to be exempted, the list needs to be comma</span><br><span class="hljs-comment">; separated. Leave unset to allow anyone to create pastes.</span><br><span class="hljs-comment">; creators = &quot;1.2.3.4,10.10.10/24&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; (optional) if your website runs behind a reverse proxy or load balancer,</span><br><span class="hljs-comment">; set the HTTP header containing the visitors IP address, i.e. X_FORWARDED_FOR</span><br><span class="hljs-comment">; header = &quot;X_FORWARDED_FOR&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">[purge]</span><br><span class="hljs-comment">; minimum time limit between two purgings of expired pastes, it is only</span><br><span class="hljs-comment">; triggered when pastes are created</span><br><span class="hljs-comment">; Set this to 0 to run a purge every time a paste is created.</span><br><span class="hljs-comment">limit = 300</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; maximum amount of expired pastes to delete in one purge</span><br><span class="hljs-comment">; Set this to 0 to disable purging. Set it higher, if you are running a large</span><br><span class="hljs-comment">; site</span><br><span class="hljs-comment">batchsize = 10</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">[model]</span><br><span class="hljs-comment">; name of data model class to load and directory for storage</span><br><span class="hljs-comment">; the default model &quot;Filesystem&quot; stores everything in the filesystem</span><br><span class="hljs-comment">class = Filesystem</span><br><span class="hljs-comment">[model_options]</span><br><span class="hljs-comment">dir = PATH &quot;data&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">;[model]</span><br><span class="hljs-comment">; example of a Google Cloud Storage configuration</span><br><span class="hljs-comment">;class = GoogleCloudStorage</span><br><span class="hljs-comment">;[model_options]</span><br><span class="hljs-comment">;bucket = &quot;my-private-bin&quot;</span><br><span class="hljs-comment">;prefix = &quot;pastes&quot;</span><br><span class="hljs-comment">;uniformacl = false</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">;[model]</span><br><span class="hljs-comment">; example of DB configuration for MySQL</span><br><span class="hljs-comment">;class = Database</span><br><span class="hljs-comment">;[model_options]</span><br><span class="hljs-comment">;dsn = &quot;mysql:host=localhost;dbname=privatebin;charset=UTF8&quot;</span><br><span class="hljs-comment">;tbl = &quot;privatebin_&quot;; table prefix</span><br><span class="hljs-comment">;usr = &quot;privatebin&quot;</span><br><span class="hljs-comment">;pwd = &quot;Z3r0P4ss&quot;</span><br><span class="hljs-comment">;opt[12] = true  ; PDO::ATTR_PERSISTENT</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">;[model]</span><br><span class="hljs-comment">; example of DB configuration for SQLite</span><br><span class="hljs-comment">;class = Database</span><br><span class="hljs-comment">;[model_options]</span><br><span class="hljs-comment">;dsn = &quot;sqlite:&quot; PATH &quot;data/db.sq3&quot;</span><br><span class="hljs-comment">;usr = null</span><br><span class="hljs-comment">;pwd = null</span><br><span class="hljs-comment">;opt[12] = true; PDO::ATTR_PERSISTENT</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">;[model]</span><br><span class="hljs-comment">; example of DB configuration for PostgreSQL</span><br><span class="hljs-comment">;class = Database</span><br><span class="hljs-comment">;[model_options]</span><br><span class="hljs-comment">;dsn = &quot;pgsql:host=localhost;dbname=privatebin&quot;</span><br><span class="hljs-comment">;tbl = &quot;privatebin_&quot;     ; table prefix</span><br><span class="hljs-comment">;usr = &quot;privatebin&quot;</span><br><span class="hljs-comment">;pwd = &quot;Z3r0P4ss&quot;</span><br><span class="hljs-comment">;opt[12] = true    ; PDO::ATTR_PERSISTENT</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">;[model]</span><br><span class="hljs-comment">; example of S3 configuration for Rados gateway / CEPH</span><br><span class="hljs-comment">;class = S3Storage</span><br><span class="hljs-comment">;[model_options]</span><br><span class="hljs-comment">;region = &quot;&quot;</span><br><span class="hljs-comment">;version = &quot;2006-03-01&quot;</span><br><span class="hljs-comment">;endpoint = &quot;https://s3.my-ceph.invalid&quot;</span><br><span class="hljs-comment">;use_path_style_endpoint = true</span><br><span class="hljs-comment">;bucket = &quot;my-bucket&quot;</span><br><span class="hljs-comment">;accesskey = &quot;my-rados-user&quot;</span><br><span class="hljs-comment">;secretkey = &quot;my-rados-pass&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">;[model]</span><br><span class="hljs-comment">; example of S3 configuration for AWS</span><br><span class="hljs-comment">;class = S3Storage</span><br><span class="hljs-comment">;[model_options]</span><br><span class="hljs-comment">;region = &quot;eu-central-1&quot;</span><br><span class="hljs-comment">;version = &quot;latest&quot;</span><br><span class="hljs-comment">;bucket = &quot;my-bucket&quot;</span><br><span class="hljs-comment">;accesskey = &quot;access key id&quot;</span><br><span class="hljs-comment">;secretkey = &quot;secret access key&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">;[model]</span><br><span class="hljs-comment">; example of S3 configuration for AWS using its SDK default credential provider chain</span><br><span class="hljs-comment">; if relying on environment variables, the AWS SDK will look for the following:</span><br><span class="hljs-comment">; - AWS_ACCESS_KEY_ID</span><br><span class="hljs-comment">; - AWS_SECRET_ACCESS_KEY</span><br><span class="hljs-comment">; - AWS_SESSION_TOKEN (if needed)</span><br><span class="hljs-comment">; for more details, see https://docs.aws.amazon.com/sdk-for-php/v3/developer-guide/guide_credentials.html#default-credential-chain </span><br><span class="hljs-comment">;class = S3Storage</span><br><span class="hljs-comment">;[model_options]</span><br><span class="hljs-comment">;region = &quot;eu-central-1&quot;</span><br><span class="hljs-comment">;version = &quot;latest&quot;</span><br><span class="hljs-comment">;bucket = &quot;my-bucket&quot;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">[yourls]</span><br><span class="hljs-comment">; When using YOURLS as a &quot;urlshortener&quot; config item:</span><br><span class="hljs-comment">; - By default, &quot;urlshortener&quot; will point to the YOURLS API URL, with or without</span><br><span class="hljs-comment">;   credentials, and will be visible in public on the PrivateBin web page.</span><br><span class="hljs-comment">;   Only use this if you allow short URL creation without credentials.</span><br><span class="hljs-comment">; - Alternatively, using the parameters in this section (&quot;signature&quot; and</span><br><span class="hljs-comment">;   &quot;apiurl&quot;), &quot;urlshortener&quot; needs to point to the base URL of your PrivateBin</span><br><span class="hljs-comment">;   instance with &quot;shortenviayourls?link=&quot; appended. For example:</span><br><span class="hljs-comment">;   urlshortener = &quot;$&#123;basepath&#125;shortenviayourls?link=&quot;</span><br><span class="hljs-comment">;   This URL will in turn call YOURLS on the server side, using the URL from</span><br><span class="hljs-comment">;   &quot;apiurl&quot; and the &quot;access signature&quot; from the &quot;signature&quot; parameters below.</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">; (optional) the &quot;signature&quot; (access key) issued by YOURLS for the using account</span><br><span class="hljs-comment">; signature = &quot;&quot;</span><br><span class="hljs-comment">; (optional) the URL of the YOURLS API, called to shorten a PrivateBin URL</span><br><span class="hljs-comment">; apiurl = &quot;https://yourls.example.com/yourls-api.php&quot;</span><br></code></pre></td></tr></table></figure><h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="无法创建粘贴：保存粘贴内容时出现错误，抱歉。"><a href="#无法创建粘贴：保存粘贴内容时出现错误，抱歉。" class="headerlink" title="无法创建粘贴：保存粘贴内容时出现错误，抱歉。"></a>无法创建粘贴：保存粘贴内容时出现错误，抱歉。</h3><p>所映射的data目录权限不足，需要进行权限修改</p><p>以下仅供参考，如有安全考虑，需使用更严谨的安全策略</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">chmod</span> -R 777 /root/privatebin/data<br></code></pre></td></tr></table></figure><blockquote><p>尽情使用属于你自己的在线剪贴板吧</p></blockquote><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://github.com/PrivateBin/PrivateBin/wiki/Docker">Docker · PrivateBin&#x2F;PrivateBin Wiki (github.com)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://laosu.cf/2020/11/30/%E5%8D%8F%E5%90%8C%E5%B7%A5%E4%BD%9C%E4%B9%8B%E4%BB%A3%E7%A0%81%E5%88%86%E4%BA%ABPrivateBin/">协同工作之代码分享PrivateBin | 老苏的blog (laosu.cf)</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">搭建属于你自己的在线剪贴板</summary>
    
    
    
    <category term="Docker" scheme="https://www.0co.dev/categories/Docker/"/>
    
    
    <category term="Docker" scheme="https://www.0co.dev/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>【数论】欧拉筛法-埃拉托斯特尼筛法</title>
    <link href="https://www.0co.dev/Euler-Eratosthenes-Sieve/"/>
    <id>https://www.0co.dev/Euler-Eratosthenes-Sieve/</id>
    <published>2023-09-19T12:13:08.000Z</published>
    <updated>2023-11-25T13:18:26.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="欧拉筛法"><a href="#欧拉筛法" class="headerlink" title="欧拉筛法"></a>欧拉筛法</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><blockquote><p>筛法就是求出小于等于<code>n</code>的所有素数的方法，找到一个素数后，就将它的倍数标记为合数，也就是把它的倍数“筛掉”。如果一个数没有被比它小的素数“筛掉”，那它就是素数。</p></blockquote><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">bool</span> isprime[MAXN]; <span class="hljs-comment">// isprime[i]标记`i`是否是素数的数组</span><br><span class="hljs-type">int</span> prime[MAXN]; <span class="hljs-comment">// 目前的素数列表</span><br><span class="hljs-type">int</span> n; <span class="hljs-comment">// 筛选上限</span><br><span class="hljs-type">int</span> cnt = <span class="hljs-number">0</span>; <span class="hljs-comment">// 已经筛出的素数数量</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">euler</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-built_in">memset</span>(isprime, <span class="hljs-literal">true</span>, <span class="hljs-keyword">sizeof</span>(isprime)); <span class="hljs-comment">//先全部标记为素数</span><br>    isprime[<span class="hljs-number">1</span>] = <span class="hljs-literal">false</span>; <span class="hljs-comment">//已知，1不是素数</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i++) <span class="hljs-comment">// i从2循环到n（外层循环）</span><br>    &#123;<br>        <span class="hljs-keyword">if</span>(isprime[i])<span class="hljs-comment">//isprime[i] == 1</span><br>            prime[++cnt] = i;<br>        <span class="hljs-comment">// 如果i没有被前面的数筛掉，则i是素数，此处prime[0]元素并未被使用，保持数值与序号对应</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt;= cnt &amp;&amp; i * prime[j] &lt;= n; j++)<br>        <span class="hljs-comment">// 使用j循环枚举现在已经筛出的素数,以筛掉i的素数倍，即i的prime[j]倍</span><br>        &#123;<br>            isprime[i * prime[j]] = <span class="hljs-literal">false</span>;<br>            <span class="hljs-comment">// 倍数标记为合数，也就是i用prime[j]把i * prime[j]筛掉了</span><br>            <span class="hljs-keyword">if</span>(i % prime[j] == <span class="hljs-number">0</span>) <br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-comment">// 如果i整除prime[j]，退出循环，这样可以保证线性的时间复杂度</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>假设要筛出<code>n</code>以内的素数。我们先把所有数标记为素数。枚举<code>i</code>从<code>2</code>到<code>n</code>，所以因为<code>i</code>是从小到大的，如果<code>i</code>没有被比它小的数标记为合数，那<code>i</code>就是素数（任意合数的因数一定比它本身小，若<code>i</code>没有被前面的数筛掉，那么它就没有比自己小的因数，当然它就是素数），加入素数列表。</p><p>现在用<code>i</code>来筛后面的数，枚举已经筛出来的素数<code>prime[j]</code>（<code>j∈[1,cnt]</code>），标记<code>i * prime[j]</code>为合数（<code>i ≥ 2，prime[j] ≥ 2</code>，它们的乘积一定为合数），当<code>i</code>是<code>prime[j]</code>的倍数时退出循环，<code>i++</code>。</p><h2 id="正确性证明"><a href="#正确性证明" class="headerlink" title="正确性证明"></a>正确性证明</h2><p>假设我们要筛掉合数<code>a</code>，且<code>a</code>的最小质因数为<code>P1</code>，令<code>a = P1 * b</code> ,那么显然<code>b &lt; a</code>，<code>b</code>先被外层循环碰到。现在<code>b</code>要筛掉它的倍数。</p><p>因为<code>P1</code>是<code>a</code>的最小质因数，所以<code>b</code>的最小质因数必不小于<code>P1</code>，这样就保证<code>b</code>筛掉<code>a</code>前不会在<code>if(i % prime[j] == 0) break;</code>处跳出循环。</p><p>即使<code>b</code>的最小质因数等于<code>P1</code>，也会先筛掉<code>a</code>后再退出循环。这样就保证了每个合数都会被筛掉。</p><h2 id="时间复杂度证明"><a href="#时间复杂度证明" class="headerlink" title="时间复杂度证明"></a>时间复杂度证明</h2><p>欧拉筛法的时间、空间复杂度为<code>Θ(n)</code>。</p><p>空间复杂度是显然的，下面证明时间复杂度为线性。</p><p>我们的核心就是要证明一个合数只会被筛掉一次，即标记<code>isprime[n]=1</code>一次。首先，对于<code>a = P1 * b</code>，<code>b</code>当然只会筛掉<code>a</code>一次，因为我们从小到大枚举<code>prime[j]</code>，也就是说<code>b * prime[j]</code>递增，因此不可能遇到<code>a</code>两次。会不会有其他的数筛掉<code>a</code>呢？假设<code>a</code>又被<code>c</code>筛掉了，其中<code>a = Px * c</code>，<code>Px</code>就是<code>c</code>用来筛掉<code>a</code>的<code>prime[j]</code>。</p><ul><li>若<code>c &gt; b</code>，则<code>Px &lt; P1</code>，与<code>P1</code>是<code>a</code>最小的质因数矛盾，假设不成立；</li><li><strong>若<code>c &lt; b</code>，则<code>Px &gt; P1</code>，这意味着<code>P1</code>是<code>c</code>的质因数。那么<code>c</code>从小到大筛掉它的素数倍，在筛到<code>P1 * c</code>时就<code>break</code>了，所以根本轮不到<code>a</code>。</strong></li></ul><p>综上所述，每个数都只会被筛掉一次，再加上外层的<code>i</code>的循环是线性复杂度，总的时间复杂度是线性的。</p><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><div class="note note-success">            <p>来自：头歌-Python大数据与人工智能实践</p>          </div><blockquote><p> 计算并输出指定范围内的所有素数。</p><p>第一行输入正整数<code>n</code>，表示测试样例组数，接下来输入<code>n</code>行，每行输入两个正整数<code>a</code>和<code>b</code>，要求输出<code>a</code>和<code>b</code>之间（包括<code>a</code>和<code>b</code>）所有的素数，保证<code>a&lt;b</code>，且<code>b</code>不超过<code>10^7</code></p></blockquote><blockquote><p>测试输入：</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-number">2</span><br><span class="hljs-number">30</span>,<span class="hljs-number">100</span><br><span class="hljs-number">999670</span>,<span class="hljs-number">1000000</span><br><span class="hljs-number">123</span><br></code></pre></td></tr></table></figure><blockquote><p>预期输出：</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">[<span class="hljs-number">31</span>, <span class="hljs-number">37</span>, <span class="hljs-number">41</span>, <span class="hljs-number">43</span>, <span class="hljs-number">47</span>, <span class="hljs-number">53</span>, <span class="hljs-number">59</span>, <span class="hljs-number">61</span>, <span class="hljs-number">67</span>, <span class="hljs-number">71</span>, <span class="hljs-number">73</span>, <span class="hljs-number">79</span>, <span class="hljs-number">83</span>, <span class="hljs-number">89</span>, <span class="hljs-number">97</span>]<br>[<span class="hljs-number">999671</span>, <span class="hljs-number">999683</span>, <span class="hljs-number">999721</span>, <span class="hljs-number">999727</span>, <span class="hljs-number">999749</span>, <span class="hljs-number">999763</span>, <span class="hljs-number">999769</span>, <span class="hljs-number">999773</span>, <span class="hljs-number">999809</span>, <span class="hljs-number">999853</span>, <span class="hljs-number">999863</span>, <span class="hljs-number">999883</span>, <span class="hljs-number">999907</span>, <span class="hljs-number">999917</span>, <span class="hljs-number">999931</span>, <span class="hljs-number">999953</span>, <span class="hljs-number">999959</span>, <span class="hljs-number">999961</span>, <span class="hljs-number">999979</span>, <span class="hljs-number">999983</span>]<br><span class="hljs-number">12</span><br></code></pre></td></tr></table></figure><blockquote><p>CODE:</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> sqrt<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">self, l, r</span>):<br>        <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">        :type l, r: int</span><br><span class="hljs-string">        :rtype : list</span><br><span class="hljs-string">        求得[l, r]范围内的所有素数，并将其返回</span><br><span class="hljs-string">        &#x27;&#x27;&#x27;</span><br>        <br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_prime</span>(<span class="hljs-params">x</span>):<br>            <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">            通过素数表判断整数是不是素数</span><br><span class="hljs-string">            &#x27;&#x27;&#x27;</span><br>            <span class="hljs-keyword">if</span> x == <span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> prime_table:<br>                <span class="hljs-keyword">if</span> x &lt; n * n:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>                <span class="hljs-comment">#如果满足上述条件，说明n之前的素数里没有x的因数</span><br>                <span class="hljs-keyword">if</span> x % n  == <span class="hljs-number">0</span>:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">ouler</span>(<span class="hljs-params">x</span>):<br>            vis = [<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(x+<span class="hljs-number">1</span>)]<br>            prime_table = []<br>            ln = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, x+<span class="hljs-number">1</span>):<br>                <span class="hljs-keyword">if</span> vis[n] == <span class="hljs-number">0</span>:<br>                    prime_table.append(n)<br>                    ln += <span class="hljs-number">1</span><br>                <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ln):<br>                    <span class="hljs-keyword">if</span> n * prime_table[j] &gt; x:<br>                        <span class="hljs-keyword">break</span><br>                    vis[n * prime_table[j]] = <span class="hljs-number">1</span><br>                    <span class="hljs-keyword">if</span> n % prime_table[j] == <span class="hljs-number">0</span>:<br>                        <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">return</span> prime_table<br>        <br>        <br>        prime_table = ouler(<span class="hljs-number">10000</span>)<br>        ans = []<br>        <span class="hljs-keyword">for</span> n <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l, r+<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">if</span> is_prime(n):<br>                ans.append(n)<br>        <span class="hljs-keyword">return</span> ans<br></code></pre></td></tr></table></figure><h1 id="埃拉托斯特尼筛法"><a href="#埃拉托斯特尼筛法" class="headerlink" title="埃拉托斯特尼筛法"></a>埃拉托斯特尼筛法</h1><p><strong>埃拉托斯特尼筛法</strong> <em><strong>sieve of Eratosthenes</strong></em>，简称<strong>埃氏筛</strong>，也称<strong>素数筛</strong>。</p><p>从<code>2</code>开始，将每个素数的各个倍数，标记成合数。一个素数的各个倍数，是一个差为此素数本身的等差数列。</p><p>定出要筛数值的范围<code>n</code>，找出$\sqrt{n}$以内的素数$\displaystyle p_{1}，p_{2},\dots,p_{k}$。先用2去筛，把2留下，把2的倍数剔除掉；再用下个素数3筛，把3留下，把3的倍数剔除掉；接下去用下个素数5筛，把5留下，把5的倍数剔除掉，如果最大数不大于最后一个标出的素数的平方，那么剩下的所有的数都是质数，否则继续上述过程。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">eratosthenes</span>(<span class="hljs-params">n</span>):<br>    <span class="hljs-comment"># 初始所有的都为True</span><br>    IsPrime = [<span class="hljs-literal">True</span>] * (n + <span class="hljs-number">1</span>)<br>    <span class="hljs-comment"># 100**0.5 = 10</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-built_in">int</span>(n ** <span class="hljs-number">0.5</span>) + <span class="hljs-number">1</span>):<br>        <span class="hljs-comment"># i在2-10范围内如果是素数</span><br>        <span class="hljs-keyword">if</span> IsPrime[i]:<br>            <span class="hljs-comment"># 从i平方开始往后去掉，即置标志位为false</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i * i, n + <span class="hljs-number">1</span>, i):<br>                IsPrime[j] = <span class="hljs-literal">False</span><br>    <span class="hljs-comment"># 输出所有标志位为True的就是素数</span><br>    <span class="hljs-keyword">return</span> [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, n + <span class="hljs-number">1</span>) <span class="hljs-keyword">if</span> IsPrime[x]]<br><br><br><span class="hljs-built_in">print</span>(eratosthenes(<span class="hljs-number">100</span>))<br></code></pre></td></tr></table></figure><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://zh.wikipedia.org/wiki/%E5%9F%83%E6%8B%89%E6%89%98%E6%96%AF%E7%89%B9%E5%B0%BC%E7%AD%9B%E6%B3%95">埃拉托斯特尼筛法</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://blog.csdn.net/o83290102o5/article/details/79491834">埃拉托斯特尼筛法详解及实现</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://blog.csdn.net/qq_40298768/article/details/108631809">欧拉筛法</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/151432852">厄拉托塞师（Eratosthenes）筛法</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">欧拉筛法的实际应用</summary>
    
    
    
    <category term="Major" scheme="https://www.0co.dev/categories/Major/"/>
    
    <category term="Algorithm" scheme="https://www.0co.dev/categories/Major/Algorithm/"/>
    
    
    <category term="Algorithm" scheme="https://www.0co.dev/tags/Algorithm/"/>
    
  </entry>
  
  <entry>
    <title>在Win11上，XBOX Live无法连接的解决方案</title>
    <link href="https://www.0co.dev/XBOX-Live-Error-Windows11/"/>
    <id>https://www.0co.dev/XBOX-Live-Error-Windows11/</id>
    <published>2023-09-19T07:58:44.000Z</published>
    <updated>2023-10-31T03:05:37.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="在Windows11上，XBOX-Live-服务器无法连接的解决方案"><a href="#在Windows11上，XBOX-Live-服务器无法连接的解决方案" class="headerlink" title="在Windows11上，XBOX Live 服务器无法连接的解决方案"></a>在Windows11上，XBOX Live 服务器无法连接的解决方案</h1><blockquote><p>在玩地平线4的时候，多人模式总是无法连接，网上的教程又都是基于<code>Windows10</code>的，折腾到凌晨两点也没有成功。</p><p>第二天早上突发奇想，跟随一篇教程检查了<code>ipv6</code>状态，从而解决了这个问题</p></blockquote><h2 id="首先"><a href="#首先" class="headerlink" title="首先"></a>首先</h2><p>1、记住下面这行代码，后面我们将多次用到。</p><blockquote><p>由于<code>Windows11</code>去除了<code>XBOX网络</code>选项，我们需要通过这行命令来查看链接状态。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">netsh interface Teredo show state<br></code></pre></td></tr></table></figure><p>2、学会使用管理员模式运行命令行工具，这里使用<code>Windows11</code>自带的终端。开始菜单中搜索得到终端之后，右键<code>用管理员身份运行</code>。</p><p>我们将在这里进行命令行输入。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202309191612414.png" alt="打开terminal"></p><p>3、检查自己的<code>Windows</code>版本，如果是家庭版（笔记本基本都是)，需要通过运行脚本获取“组策略”选项。</p><ul><li>新建一个文本文档，比如<code>a.txt</code>，将下面的代码粘贴进去。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">@<span class="hljs-built_in">echo</span> off<br><br><span class="hljs-built_in">pushd</span> <span class="hljs-string">&quot;%~dp0&quot;</span><br><br><span class="hljs-built_in">dir</span> /b C:\Windows\servicing\Packages\Microsoft-Windows-GroupPolicy-ClientExtensions-Package~3*.mum &gt;List.txt<br><br><span class="hljs-built_in">dir</span> /b C:\Windows\servicing\Packages\Microsoft-Windows-GroupPolicy-ClientTools-Package~3*.mum &gt;&gt;List.txt<br><br><span class="hljs-keyword">for</span> /f %%i <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;findstr /i . List.txt 2^&gt;nul&#x27;</span>) <span class="hljs-keyword">do</span> dism /online /norestart /add-package:<span class="hljs-string">&quot;C:\Windows\servicing\Packages\%%i&quot;</span><br><br>pause<br></code></pre></td></tr></table></figure><ul><li><p>保存文档，修改文件名为<code>a.cmd</code>，右键<code>-&gt;</code>以管理员身份运行</p><blockquote><p>如果无法更改后缀，可用<code>VS Code</code>打开，或者<a href="https://www.php.cn/faq/569056.html">查看此文章</a></p></blockquote></li><li><p>按<code>win</code>+<code>R</code>组合键，输入<code>gpedit.msc</code>，回车，若出现组策略编辑窗口则成功。</p></li></ul><p>4、检测本地<code>ipv6</code>是否开启，有的加速器会把<code>ipv6</code>关掉，比如小黑盒加速器</p><blockquote><p><code>ipv6</code>的配置方式可以问度娘，或者<a href="https://www.sohu.com/a/322875365_594016">查看此文章</a></p></blockquote><h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><p>按照上文方式，打开“本地组策略编辑器“，找到计算机配置——管理模版——网络——<code>TCPIP</code>设置——<code>IPv6</code>转换技术。<br>将所有配置设置为“未配置”。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202309191622804.png" alt="组策略编辑器"></p><p>管理员权限运行终端，在其中运行以下命令：</p><p>【建议一条一条来】</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 启用windows防火墙</span><br>netsh advfirewall <span class="hljs-built_in">set</span> allprofiles state on<br><span class="hljs-comment"># 修复注册表：</span><br>reg add HKLMSystemCurrentControlSetServicesTcpip6Parameters /v DisabledComponents /t REG_DWORD /d 0x0<br><span class="hljs-comment"># 禁用Teredo功能：</span><br>netsh interface Teredo <span class="hljs-built_in">set</span> state <span class="hljs-built_in">disable</span><br><span class="hljs-comment"># 还原teredo状态：</span><br>netsh interface Teredo <span class="hljs-built_in">set</span> state servername=default<br><span class="hljs-comment"># 检测teredo状态：</span><br>netsh interface Teredo show state<br><span class="hljs-comment"># 设置客户端类型：</span><br>netsh interface Teredo <span class="hljs-built_in">set</span> state <span class="hljs-built_in">type</span>=enterpriseclient<br><span class="hljs-comment"># 查看teredo情况，状态异常为disable，正常为dormant / qualified</span><br></code></pre></td></tr></table></figure><p>如果服务器无法连接，可以命令行运行下列任意一条命令更改<code>Teredo</code>服务器，之后运行<code>netsh interface Teredo show state</code>检测，多尝试几次</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">netsh interface teredo <span class="hljs-built_in">set</span> state server=win1901.ipv6.microsoft.com<br><span class="hljs-comment"># or</span><br>netsh interface teredo <span class="hljs-built_in">set</span> state server=win10.ipv6.microsoft.com<br><br><span class="hljs-comment"># 可尝试的服务器</span><br>teredo2.remlab.net<br>teredo.iks-jena.de<br>win10.ipv6.microsoft.com<br>win1901.ipv6.microsoft.com<br>teredo.ipv6.microsoft.com<br>teredo.trex.fi<br></code></pre></td></tr></table></figure><blockquote><p>以上命令行也可以通过直接在“组策略编辑器”中编辑实现</p><ul><li><p>启用防火墙可以通过<code>Windows Defender</code>完成</p></li><li><p><code>设置Teredo默认限定</code>-&gt;已启用</p></li><li><p><code>设置Teredo服务器名称</code>-&gt;已启用-填入下列任意服务器，如<code>win1901.ipv6.microsoft.com</code></p></li><li><p><code>设置Teredo状态</code>-&gt;已启用-状态选择<code>企业客户端</code></p></li></ul></blockquote><p>按下<code>Win</code> + <code>R</code>组合键打开运行，输入<code>regedit</code>点击确定打开注册表;<br><code>HKEY_CURRENT_USER SOFTWARE Microsoft Windows CurrentVersion Internet Settings Connections </code>,将<code>Connections</code>项删除，重启即可正常使用 </p><blockquote><p>可以通过<code>设置</code>-&gt;<code>网络</code>-&gt;<code>高级网络设置</code>-&gt;<code>网络重置</code>完成</p></blockquote><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202309191629279.png" alt="fail"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202309191630104.png" alt="Success!"></p><blockquote><p>上述成功图片所示并不能算是最完美的结果，但开个加速器就可以用了，具体最后的结果与所处网络环境有关，毕竟巨硬的服务器一向比较玄学。。。</p></blockquote><p>如果上述仍然失效，可以尝试使用<code>奇游加速器</code>的修复功能。（非广告，笔者修复过程中确实使用过此功能，与上述步骤结合，从而无法确定其是否发挥作用，大家可以尝试一下）</p><blockquote><p>环境：湖北某大学校园网，<code>Windows 11</code>，地平线4</p></blockquote><p><strong>地平线，启动！</strong></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.qiyou.cn/games/758.html">微软游戏无法正常加入在线游戏的解决教程</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://51huanqi.cn/%E6%9E%81%E9%99%90%E7%AB%9E%E9%80%9F%EF%BC%9A%E5%9C%B0%E5%B9%B3%E7%BA%BF-teredo%E4%B8%8D%E5%90%88%E6%A0%BC%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">极限竞速：地平线 Teredo不合格解决方案</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">畅玩地平线4的解决方案（bushi</summary>
    
    
    
    <category term="Daily" scheme="https://www.0co.dev/categories/Daily/"/>
    
    
    <category term="Game" scheme="https://www.0co.dev/tags/Game/"/>
    
    <category term="XBOX" scheme="https://www.0co.dev/tags/XBOX/"/>
    
  </entry>
  
  <entry>
    <title>利用Cloudflare自建Github加速代理</title>
    <link href="https://www.0co.dev/Cloudflare-Github-Proxy/"/>
    <id>https://www.0co.dev/Cloudflare-Github-Proxy/</id>
    <published>2023-09-14T12:09:13.000Z</published>
    <updated>2023-10-31T03:05:45.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="利用Cloudflare自建Github加速代理"><a href="#利用Cloudflare自建Github加速代理" class="headerlink" title="利用Cloudflare自建Github加速代理"></a>利用Cloudflare自建Github加速代理</h1><div class="note note-success">            <p>本教程基于<code>Cloudflare</code>域名托管和<code>Cloudflare Worker</code>搭建</p>          </div><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><p>进入Cloudflare官网注册账号（这个应该不用教了吧），点击<code>dashboard</code>左下方的<code>Workers&amp;Pages</code>-&gt;<code>Overview</code>-&gt;<code>Create application</code>-&gt;<code>Create Worker</code>创建<code>Worker</code></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310241859096.png" alt="Create"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310241900109.png" alt="worker"></p><p>填写<code>Name</code>项（内容随便，记得住就行），点击右下方<code>Deploy</code>，代码先不用管。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310241902964.png" alt="Deploy"></p><p>在接下来出现的页面中点击<code>Edit code</code>，填入示例代码。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310241903088.png" alt="edit"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-meta">&#x27;use strict&#x27;</span><br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ASSET_URL</span> = <span class="hljs-string">&#x27;https://megasuite.github.io/ghproxy-page/&#x27;</span><br><span class="hljs-comment">//此地址为直接访问加速地址所展示的静态页面，为笔者自己部署于`Github Pages`的页面，可根据需要自己改动。</span><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PREFIX</span> = <span class="hljs-string">&#x27;/&#x27;</span><br><span class="hljs-comment">// 前缀，如果自定义路由为example.com/gh/*，将PREFIX改为 &#x27;/gh/&#x27;，注意，少一个杠都会错！</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">Config</span> = &#123;<br>    <span class="hljs-attr">jsdelivr</span>: <span class="hljs-number">0</span><br>&#125;<span class="hljs-comment">// 分支文件使用jsDelivr镜像的开关，0为关闭，默认关闭</span><br><br><span class="hljs-keyword">const</span> whiteList = [] <span class="hljs-comment">// 白名单，路径里面有包含字符的才会通过，e.g. [&#x27;/username/&#x27;]</span><br><br><span class="hljs-comment">/** <span class="hljs-doctag">@type</span> &#123;<span class="hljs-type">RequestInit</span>&#125; */</span><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PREFLIGHT_INIT</span> = &#123;<br>    <span class="hljs-attr">status</span>: <span class="hljs-number">204</span>,<br>    <span class="hljs-attr">headers</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Headers</span>(&#123;<br>        <span class="hljs-string">&#x27;access-control-allow-origin&#x27;</span>: <span class="hljs-string">&#x27;*&#x27;</span>,<br>        <span class="hljs-string">&#x27;access-control-allow-methods&#x27;</span>: <span class="hljs-string">&#x27;GET,POST,PUT,PATCH,TRACE,DELETE,HEAD,OPTIONS&#x27;</span>,<br>        <span class="hljs-string">&#x27;access-control-max-age&#x27;</span>: <span class="hljs-string">&#x27;1728000&#x27;</span>,<br>    &#125;),<br>&#125;<br><br><br><span class="hljs-keyword">const</span> exp1 = <span class="hljs-regexp">/^(?:https?:\/\/)?github\.com\/.+?\/.+?\/(?:releases|archive)\/.*$/i</span><br><span class="hljs-keyword">const</span> exp2 = <span class="hljs-regexp">/^(?:https?:\/\/)?github\.com\/.+?\/.+?\/(?:blob|raw)\/.*$/i</span><br><span class="hljs-keyword">const</span> exp3 = <span class="hljs-regexp">/^(?:https?:\/\/)?github\.com\/.+?\/.+?\/(?:info|git-).*$/i</span><br><span class="hljs-keyword">const</span> exp4 = <span class="hljs-regexp">/^(?:https?:\/\/)?raw\.(?:githubusercontent|github)\.com\/.+?\/.+?\/.+?\/.+$/i</span><br><span class="hljs-keyword">const</span> exp5 = <span class="hljs-regexp">/^(?:https?:\/\/)?gist\.(?:githubusercontent|github)\.com\/.+?\/.+?\/.+$/i</span><br><span class="hljs-keyword">const</span> exp6 = <span class="hljs-regexp">/^(?:https?:\/\/)?github\.com\/.+?\/.+?\/tags.*$/i</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">any</span>&#125; <span class="hljs-variable">body</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">number</span>&#125; <span class="hljs-variable">status</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">Object&lt;string, string&gt;</span>&#125; <span class="hljs-variable">headers</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">makeRes</span>(<span class="hljs-params">body, status = <span class="hljs-number">200</span>, headers = &#123;&#125;</span>) &#123;<br>    headers[<span class="hljs-string">&#x27;access-control-allow-origin&#x27;</span>] = <span class="hljs-string">&#x27;*&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Response</span>(body, &#123;status, headers&#125;)<br>&#125;<br><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">string</span>&#125; <span class="hljs-variable">urlStr</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">newUrl</span>(<span class="hljs-params">urlStr</span>) &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(urlStr)<br>    &#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span><br>    &#125;<br>&#125;<br><br><br><span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;fetch&#x27;</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> ret = <span class="hljs-title function_">fetchHandler</span>(e)<br>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-title function_">makeRes</span>(<span class="hljs-string">&#x27;cfworker error:\n&#x27;</span> + err.<span class="hljs-property">stack</span>, <span class="hljs-number">502</span>))<br>    e.<span class="hljs-title function_">respondWith</span>(ret)<br>&#125;)<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">checkUrl</span>(<span class="hljs-params">u</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i <span class="hljs-keyword">of</span> [exp1, exp2, exp3, exp4, exp5, exp6]) &#123;<br>        <span class="hljs-keyword">if</span> (u.<span class="hljs-title function_">search</span>(i) === <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">FetchEvent</span>&#125; <span class="hljs-variable">e</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchHandler</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">const</span> req = e.<span class="hljs-property">request</span><br>    <span class="hljs-keyword">const</span> urlStr = req.<span class="hljs-property">url</span><br>    <span class="hljs-keyword">const</span> urlObj = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(urlStr)<br>    <span class="hljs-keyword">let</span> path = urlObj.<span class="hljs-property">searchParams</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;q&#x27;</span>)<br>    <span class="hljs-keyword">if</span> (path) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Response</span>.<span class="hljs-title function_">redirect</span>(<span class="hljs-string">&#x27;https://&#x27;</span> + urlObj.<span class="hljs-property">host</span> + <span class="hljs-variable constant_">PREFIX</span> + path, <span class="hljs-number">301</span>)<br>    &#125;<br>    <span class="hljs-comment">// cfworker 会把路径中的 `//` 合并成 `/`</span><br>    path = urlObj.<span class="hljs-property">href</span>.<span class="hljs-title function_">substr</span>(urlObj.<span class="hljs-property">origin</span>.<span class="hljs-property">length</span> + <span class="hljs-variable constant_">PREFIX</span>.<span class="hljs-property">length</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^https?:\/+/</span>, <span class="hljs-string">&#x27;https://&#x27;</span>)<br>    <span class="hljs-keyword">if</span> (path.<span class="hljs-title function_">search</span>(exp1) === <span class="hljs-number">0</span> || path.<span class="hljs-title function_">search</span>(exp5) === <span class="hljs-number">0</span> || path.<span class="hljs-title function_">search</span>(exp6) === <span class="hljs-number">0</span> || path.<span class="hljs-title function_">search</span>(exp3) === <span class="hljs-number">0</span> || path.<span class="hljs-title function_">search</span>(exp4) === <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">httpHandler</span>(req, path)<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (path.<span class="hljs-title function_">search</span>(exp2) === <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Config</span>.<span class="hljs-property">jsdelivr</span>) &#123;<br>            <span class="hljs-keyword">const</span> newUrl = path.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;/blob/&#x27;</span>, <span class="hljs-string">&#x27;@&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^(?:https?:\/\/)?github\.com/</span>, <span class="hljs-string">&#x27;https://cdn.jsdelivr.net/gh&#x27;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Response</span>.<span class="hljs-title function_">redirect</span>(newUrl, <span class="hljs-number">302</span>)<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            path = path.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;/blob/&#x27;</span>, <span class="hljs-string">&#x27;/raw/&#x27;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_">httpHandler</span>(req, path)<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (path.<span class="hljs-title function_">search</span>(exp4) === <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">const</span> newUrl = path.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/(?&lt;=com\/.+?\/.+?)\/(.+?\/)/</span>, <span class="hljs-string">&#x27;@$1&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^(?:https?:\/\/)?raw\.(?:githubusercontent|github)\.com/</span>, <span class="hljs-string">&#x27;https://cdn.jsdelivr.net/gh&#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Response</span>.<span class="hljs-title function_">redirect</span>(newUrl, <span class="hljs-number">302</span>)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-variable constant_">ASSET_URL</span> + path)<br>    &#125;<br>&#125;<br><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">Request</span>&#125; <span class="hljs-variable">req</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">string</span>&#125; <span class="hljs-variable">pathname</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">httpHandler</span>(<span class="hljs-params">req, pathname</span>) &#123;<br>    <span class="hljs-keyword">const</span> reqHdrRaw = req.<span class="hljs-property">headers</span><br><br>    <span class="hljs-comment">// preflight</span><br>    <span class="hljs-keyword">if</span> (req.<span class="hljs-property">method</span> === <span class="hljs-string">&#x27;OPTIONS&#x27;</span> &amp;&amp;<br>        reqHdrRaw.<span class="hljs-title function_">has</span>(<span class="hljs-string">&#x27;access-control-request-headers&#x27;</span>)<br>    ) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Response</span>(<span class="hljs-literal">null</span>, <span class="hljs-variable constant_">PREFLIGHT_INIT</span>)<br>    &#125;<br><br>    <span class="hljs-keyword">const</span> reqHdrNew = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Headers</span>(reqHdrRaw)<br><br>    <span class="hljs-keyword">let</span> urlStr = pathname<br>    <span class="hljs-keyword">let</span> flag = !<span class="hljs-title class_">Boolean</span>(whiteList.<span class="hljs-property">length</span>)<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i <span class="hljs-keyword">of</span> whiteList) &#123;<br>        <span class="hljs-keyword">if</span> (urlStr.<span class="hljs-title function_">includes</span>(i)) &#123;<br>            flag = <span class="hljs-literal">true</span><br>            <span class="hljs-keyword">break</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!flag) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Response</span>(<span class="hljs-string">&quot;blocked&quot;</span>, &#123;<span class="hljs-attr">status</span>: <span class="hljs-number">403</span>&#125;)<br>    &#125;<br>    <span class="hljs-keyword">if</span> (urlStr.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">&#x27;github&#x27;</span>)) &#123;<br>        urlStr = <span class="hljs-string">&#x27;https://&#x27;</span> + urlStr<br>    &#125;<br>    <span class="hljs-keyword">const</span> urlObj = <span class="hljs-title function_">newUrl</span>(urlStr)<br><br>    <span class="hljs-comment">/** <span class="hljs-doctag">@type</span> &#123;<span class="hljs-type">RequestInit</span>&#125; */</span><br>    <span class="hljs-keyword">const</span> reqInit = &#123;<br>        <span class="hljs-attr">method</span>: req.<span class="hljs-property">method</span>,<br>        <span class="hljs-attr">headers</span>: reqHdrNew,<br>        <span class="hljs-attr">redirect</span>: <span class="hljs-string">&#x27;manual&#x27;</span>,<br>        <span class="hljs-attr">body</span>: req.<span class="hljs-property">body</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">proxy</span>(urlObj, reqInit)<br>&#125;<br><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">URL</span>&#125; <span class="hljs-variable">urlObj</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">RequestInit</span>&#125; <span class="hljs-variable">reqInit</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">proxy</span>(<span class="hljs-params">urlObj, reqInit</span>) &#123;<br>    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(urlObj.<span class="hljs-property">href</span>, reqInit)<br>    <span class="hljs-keyword">const</span> resHdrOld = res.<span class="hljs-property">headers</span><br>    <span class="hljs-keyword">const</span> resHdrNew = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Headers</span>(resHdrOld)<br><br>    <span class="hljs-keyword">const</span> status = res.<span class="hljs-property">status</span><br><br>    <span class="hljs-keyword">if</span> (resHdrNew.<span class="hljs-title function_">has</span>(<span class="hljs-string">&#x27;location&#x27;</span>)) &#123;<br>        <span class="hljs-keyword">let</span> _location = resHdrNew.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;location&#x27;</span>)<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">checkUrl</span>(_location))<br>            resHdrNew.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;location&#x27;</span>, <span class="hljs-variable constant_">PREFIX</span> + _location)<br>        <span class="hljs-keyword">else</span> &#123;<br>            reqInit.<span class="hljs-property">redirect</span> = <span class="hljs-string">&#x27;follow&#x27;</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-title function_">proxy</span>(<span class="hljs-title function_">newUrl</span>(_location), reqInit)<br>        &#125;<br>    &#125;<br>    resHdrNew.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;access-control-expose-headers&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>)<br>    resHdrNew.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;access-control-allow-origin&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>)<br><br>    resHdrNew.<span class="hljs-title function_">delete</span>(<span class="hljs-string">&#x27;content-security-policy&#x27;</span>)<br>    resHdrNew.<span class="hljs-title function_">delete</span>(<span class="hljs-string">&#x27;content-security-policy-report-only&#x27;</span>)<br>    resHdrNew.<span class="hljs-title function_">delete</span>(<span class="hljs-string">&#x27;clear-site-data&#x27;</span>)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Response</span>(res.<span class="hljs-property">body</span>, &#123;<br>        status,<br>        <span class="hljs-attr">headers</span>: resHdrNew,<br>    &#125;)<br>&#125;<br><br></code></pre></td></tr></table></figure><p>点击<code>Send</code>出现<code>Status Code: 200</code>即为搭建成功。红线下的地址即为你的私有加速地址。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310241904387.png" alt="Code"></p><h2 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h2><p><code>Cloudflare</code>默认的域名显得些许冗长，而且这也是一个可以长期使用的项目，所以我们可以考虑使用自己的域名。</p><h3 id="托管域名"><a href="#托管域名" class="headerlink" title="托管域名"></a>托管域名</h3><p>首先，需要拥有一个托管于<code>Cloudflare</code>的域名，或者通过<code>Cloudflare</code>注册一个，下图展示了简单的托管教程。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310241922890.png" alt="add site"></p><p>填写要托管的域名，图上我是随便写的啊。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310241924563.png" alt="填写要托管的域名"></p><p><code>Plan</code>选择<code>free</code>即可，一天一百万次，个人完全够了。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310241925872.png" alt="plan"></p><p>根据提示修改<code>DNS</code>服务器即可，之后会需要一段时间等待解析生效，成功之后会有邮件通知托管成功。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310241926961.png" alt="dns server"></p><h3 id="添加路由"><a href="#添加路由" class="headerlink" title="添加路由"></a>添加路由</h3><p>进入托管成功的域名管理页，在<code>DNS</code>-&gt;<code>Records</code>-&gt;<code>Add record</code>添加一条<code>A</code>类型解析记录，选择一个你喜欢的前缀（如<code>ghproxy</code>）填入<code>Name</code>项，<code>Content</code>项随便填一个合法的ip地址即可，然后打开橙色小云朵，点击保存。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310241932536.png" alt="dns records"></p><p>然后来到下方添加路由，<code>Workers Routes</code>-&gt;<code>Add route</code></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310241937210.png" alt="Routes"></p><p><code>Route</code>项填入<code>前缀.域名/*</code>，注意<code>*</code>的位置，<code>Worker</code>项选择刚刚创建的<code>Worker</code>即可。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202310241938694.png" alt="edit route"></p><p>保存之后便可以通过自定义域名访问加速站</p><p>点击下方链接查看笔者搭建的示例：</p><div class="note note-primary">            <p><a href="https://ghproxy.wisedrifter.top/">GitHub Proxy by Konrad</a></p>          </div><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://github.com/hunshcn/gh-proxy">参考项目：hunshcn&#x2F;ghproxy</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://github.com/MegaSuite/ghproxy-page">笔者的静态页面仓库：MegaSuite&#x2F;ghproxy-page</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">基于cloudflare域名托管和cloudflare worker</summary>
    
    
    
    <category term="Major" scheme="https://www.0co.dev/categories/Major/"/>
    
    <category term="Proxies" scheme="https://www.0co.dev/categories/Major/Proxies/"/>
    
    
    <category term="Github" scheme="https://www.0co.dev/tags/Github/"/>
    
    <category term="Cloudflare" scheme="https://www.0co.dev/tags/Cloudflare/"/>
    
  </entry>
  
  <entry>
    <title>QuantumultX的配置与使用</title>
    <link href="https://www.0co.dev/QuantumultX-Config-and-Usage/"/>
    <id>https://www.0co.dev/QuantumultX-Config-and-Usage/</id>
    <published>2023-09-02T15:23:49.000Z</published>
    <updated>2023-10-31T03:05:49.000Z</updated>
    
    
    <summary type="html">怎样通过使用QuantumultX提高iPhone的使用体验</summary>
    
    
    
    <category term="Major" scheme="https://www.0co.dev/categories/Major/"/>
    
    <category term="Proxies" scheme="https://www.0co.dev/categories/Major/Proxies/"/>
    
    
    <category term="QuantumultX" scheme="https://www.0co.dev/tags/QuantumultX/"/>
    
  </entry>
  
  <entry>
    <title>如何给你的大学官网整一个「奇怪」的域名</title>
    <link href="https://www.0co.dev/Special-Domain-for-Your-University/"/>
    <id>https://www.0co.dev/Special-Domain-for-Your-University/</id>
    <published>2023-08-17T15:21:25.000Z</published>
    <updated>2023-10-31T03:05:53.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="如何给你的大学官网整一个⌈奇怪⌋的域名"><a href="#如何给你的大学官网整一个⌈奇怪⌋的域名" class="headerlink" title="如何给你的大学官网整一个⌈奇怪⌋的域名"></a>如何给你的大学官网整一个⌈奇怪⌋的域名</h1><h2 id="购买域名"><a href="#购买域名" class="headerlink" title="购买域名"></a>购买域名</h2><p>建议从老牌注册商处购买，服务周全，所有权也更有保障。推荐三家注册商，也是国内相关领域的‘’御三家‘’。</p><blockquote><ul><li><a href="https://wanwang.aliyun.com/domain">阿里云万网</a></li><li><a href="https://buy.cloud.tencent.com/domain?intl=0">腾讯云 DNSPod</a></li><li><a href="https://www.west.cn/">西部数码</a>（不是那个卖硬盘的</li></ul></blockquote><p>这三家的域名我都持有，腾讯云的免费解析套餐<code>A</code>类型解析条数限制两条（虽有些抠门，但也够用了），腾讯云也是续费优惠做得比较好的一家。</p><p>西部数码的官网很有互联网初期的气息（多少年没打扮打扮了，乍一看像个盗版下载站），但功能是三家里最贴心的，新用户1元购很有吸引力，域名<code>push</code>等独创功能也很增强使用体验。</p><p>阿里云是三者里的老大，目前域名保有数量最多的注册商，虽然优惠力度没有那么大，但贵在较为稳定，相关一条龙服务也很成熟。</p><h2 id="配置域名的指向"><a href="#配置域名的指向" class="headerlink" title="配置域名的指向"></a>配置域名的指向</h2><p>作为一个整活折腾爱好者，你可能已经通过教程，借助<code>Github Pages</code>搭建了自己的静态博客，其中域名的配置就采用了<code>CNAME</code>直接指向的方法，那就这样做！ ？？？</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202308262035105.png" alt="CNAME"></p><p><strong>戳啦！</strong></p><p><code>Github Pages</code>可以用<code>CNAME</code>指向，是因为<code>Github</code>本身就想让你指向，但各大学校的官网建立的时候应该不会想被<code>中国原神大学.love</code>这种域名所指向，由此，如果你直接使用<code>CNAME</code>指向，访问的时候只能得到<code>Access Denied</code>，很不幸，你想指，人家不让你指。</p><p>万幸，我们可以曲线救国，用一个瞬间访问的静态网页进行跳转，只需几行代码，如此，就算你不让我指，你也拿我没办法，总不能拒绝外来访问吧（好贱啊）。</p><h2 id="搭建方法"><a href="#搭建方法" class="headerlink" title="搭建方法"></a>搭建方法</h2><p class='note note-success'>正片开始</p><p>搭建方法跟搭建静态博客类似，不过这个博客只有一个<code>index.html</code>文件，里面只有几行代码，起到无延迟自动跳转的效果。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202308262050263.png" alt="文件结构"></p><p>此为文件内的代码，<code>content</code>后的<code>0</code>代表<code>0</code>延时跳转的时长，<code>0</code>即为立即跳转，<code>url</code>后当然就是某大学官网的链接（坏笑），将此代码粘贴保存即可。</p><p>之后就是配置静态<code>Pages</code>，在仓库中<code>Settings-&gt;Pages</code>中配置把所购买域名指向此静态页面，然后此页面再进行页面跳转。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-comment">&lt;!--定时转到其他页面 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;refresh&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;0;url=https://www.hust.edu.cn/&quot;</span>&gt;</span> <br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br></code></pre></td></tr></table></figure><p>你当然可以用<code>Github Pages</code>配置静态页面 ，像你之前所做的那样（广告时间到，请参考下列第一篇文章中的域名配置相关内容，在此不再赘述），但我更建议使用<code>Vercel</code>，功能更强大的静态页面托管服务（个人版免费）。</p><blockquote><a href="/hexo-start/" title="从Hexo开启第一篇博客">从Hexo开启第一篇博客</a></blockquote><blockquote><a href="/hexo-grammars/" title="Hexo写作的基本语法">Hexo写作的基本语法</a></blockquote><h2 id="Vercel的使用"><a href="#Vercel的使用" class="headerlink" title="Vercel的使用"></a>Vercel的使用</h2><p>接下来，着重介绍<code>Vercel</code>的使用。</p><p><code>Vercel</code>使用的最大门槛就是登录，大部分账号直接使用<code>Github</code>登录会被锁定，需要邮件联系客服解锁，所幸客服的处理回复速度很快。</p><blockquote><p>具体方式：发邮件给<code>registration@vercel.com</code>，“我是第一次使用，为啥给我锁了？blabla……”（用英语啊，别用中文），类似这样，随便抱怨几句。</p><p>根据客服的回复来看，他们只是为了确定你不是机器人。</p></blockquote><p>完成登录之后，按照指示从<code>Github</code>或者其他代码仓库导入代码，部署静态页面，并在<code>Settings-&gt;Domains</code>进行域名绑定即可，过程与<code>Github Pages</code>类似，且有详细的指导。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202308281545907.png" alt="Add Project"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202308281540208.png" alt="Domains"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202308281548122.png" alt="域名解析的配置"></p><h2 id="注意！！"><a href="#注意！！" class="headerlink" title="注意！！"></a>注意！！</h2><p class='note note-primary'>中文域名不可直接填入</p><p>通过上图，可以看到，配置时中文域名并不是以中文的形态存在的。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202308281551741.png" alt="中文顶域"></p><p>与上图所示类似，含有中文的域名会使用<code>Punycode</code>进行编码，我们配置的时候需要对其进行还原。</p><blockquote><p>还原方法：</p><p>任意进入一个<code>Whois</code>查询网站，输入中文域名进行查询。</p><p>推荐<a href="https://whois.chinaz.com/">站长工具</a></p><p>查看下方英文信息中的<code>Domain Name</code>项就是原始域名的值，复制后配置使用即可。</p></blockquote><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202308281557617.png" alt="Domain Name"></p><hr><p><strong>–本次整活到此结束</strong></p>]]></content>
    
    
    <summary type="html">你也想要中国原神大学吗？</summary>
    
    
    
    <category term="Daily" scheme="https://www.0co.dev/categories/Daily/"/>
    
    
    <category term="Daily" scheme="https://www.0co.dev/tags/Daily/"/>
    
  </entry>
  
  <entry>
    <title>CS61A-hw05_Yield关键词的应用</title>
    <link href="https://www.0co.dev/CS61A-hw05-Yield/"/>
    <id>https://www.0co.dev/CS61A-hw05-Yield/</id>
    <published>2023-08-01T09:48:36.000Z</published>
    <updated>2023-10-31T03:06:02.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CS61A-hw05-Yield关键词的应用"><a href="#CS61A-hw05-Yield关键词的应用" class="headerlink" title="CS61A-hw05_Yield关键词的应用"></a>CS61A-hw05_Yield关键词的应用</h1><blockquote><p> 为了理解<code>yield</code>的原理，我们必须首先理解生成器和迭代器的原理。</p></blockquote><h2 id="迭代器（Iterables）"><a href="#迭代器（Iterables）" class="headerlink" title="迭代器（Iterables）"></a>迭代器（Iterables）</h2><p>创建一个列表，我们可以依次读取列表中的元素，这种依次读取输出元素的行为称为迭代，被读取的对象称为迭代器。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-meta">&gt;&gt;&gt; </span>lst = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lst:<br><span class="hljs-meta">... </span>   <span class="hljs-built_in">print</span>(i)<br><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>也可以通过列表推导式创建列表（迭代器）。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-meta">&gt;&gt;&gt; </span>lst = [x*x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<span class="hljs-comment">#········@1</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lst:<br><span class="hljs-meta">... </span>   <span class="hljs-built_in">print</span>(i)<br><span class="hljs-number">0</span><br><span class="hljs-number">1</span><br><span class="hljs-number">4</span><br></code></pre></td></tr></table></figure><p>一切可以通过<code>for...in...</code>进行迭代的对象都可以成为迭代器。迭代器的特征是将所需元素储存起来，以供读取，但当数据量很大时，使用迭代器产生数据则不是一个明智的选择，比如将上述代码<code>@1</code>行中<code>range(3)</code>里的数字改为极其庞大的数字，在<code>@1</code>行代码运行之后，程序便生成一个极占内存的大列表<code>lst</code>，但我们只是想输出一些数，没有必要使一个如此简单的行为消耗那么多资源，由此，我们就需要生成器的帮助。</p><h2 id="生成器（Generators）"><a href="#生成器（Generators）" class="headerlink" title="生成器（Generators）"></a>生成器（Generators）</h2><p>生成器可以认为是迭代器的一种，不过只能依次迭代使用一次，不能重复迭代。生成器的特点是不储存生成值，即用即产，动态生成。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-meta">&gt;&gt;&gt; </span>gen = (x*x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>))<span class="hljs-comment">#yield_atom</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> gen:<br><span class="hljs-meta">... </span>   <span class="hljs-built_in">print</span>(i)<br><span class="hljs-number">0</span><br><span class="hljs-number">1</span><br><span class="hljs-number">4</span><br></code></pre></td></tr></table></figure><p>可见，生成器推导式与列表推导式的差距只在<code>()</code>和<code>[]</code>上，而且生成器对象只能迭代一次（继续迭代会抛出<code>StopIteration</code>错误）。</p><h2 id="Yield"><a href="#Yield" class="headerlink" title="Yield"></a>Yield</h2><p><code>yield</code> 表达式的使用类似于<code>return</code>（详细用法参见<strong>Official Definition</strong>章节），区别在<code>yield</code>会使函数变为生成器函数。</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_gen</span>():<br><span class="hljs-meta">... </span>   lst = <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)<br><span class="hljs-meta">... </span>   <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> lst:<br><span class="hljs-meta">... </span>       <span class="hljs-keyword">yield</span> i*i<br>...<br><span class="hljs-meta">&gt;&gt;&gt; </span>gen = create_gen() <span class="hljs-comment"># 创建生成器</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(gen) <span class="hljs-comment"># gen是一个生成器对象</span><br>&lt;generator <span class="hljs-built_in">object</span> create_gen at <span class="hljs-number">0xb7555c34</span>&gt;<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> gen:<br><span class="hljs-meta">... </span>    <span class="hljs-built_in">print</span>(i)<br><span class="hljs-number">0</span><br><span class="hljs-number">1</span><br><span class="hljs-number">4</span><br></code></pre></td></tr></table></figure><p>生成器在产生只需要生成一次的输出序列时有很大的优势。迭代（比如<code>for</code>)第一次调用从函数创建的生成器对象时，它将从开头运行函数中的代码，直到到达<code>yield</code>，然后返回循环的第一个值。之后，每个后续调用都将运行在函数中编写的循环的另一次迭代，并返回下一个值，生成器函数体内的代码以<code>yield</code>语句所在处分界，某次循环开始时，函数会从上一次<code>yield</code>停止处开始运行（即运行<code>yield</code>的下一行），直到生成器被判定为空（<code>StopIteration</code>)。</p><h2 id="Official-Definition-1"><a href="#Official-Definition-1" class="headerlink" title="Official Definition[1]"></a>Official Definition<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[6. Expressions — Python 3.12.0 documentation](https://docs.python.org/3/reference/expressions.html#grammar-token-python-grammar-yield_expression)">[1]</span></a></sup></h2><p><em><strong>6.2.9. Yield expressions</strong></em></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">yield_atom       ::=  <span class="hljs-string">&quot;(&quot;</span> yield_expression <span class="hljs-string">&quot;)&quot;</span><span class="hljs-comment">#使用&quot;()&quot;包裹生成器推导式,产生生成器</span><br>yield_expression ::=  <span class="hljs-string">&quot;yield&quot;</span> [expression_list | <span class="hljs-string">&quot;from&quot;</span> expression]<span class="hljs-comment">#作为表达式在函数体中使用</span><br></code></pre></td></tr></table></figure><p>yield 表达式在定义 <a href="https://docs.python.org/zh-cn/3/glossary.html#term-generator">generator</a> 函数或 <a href="https://docs.python.org/zh-cn/3/glossary.html#term-asynchronous-generator">asynchronous generator</a> 函数时才会用到因此只能在函数定义的内部使用。 在一个函数体内使用 yield 表达式会使这个函数变成一个生成器函数，而在一个 <a href="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#async-def"><code>async def</code></a> 函数的内部使用它则会让这个协程函数变成一个异步生成器函数。 例如:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen</span>():  <span class="hljs-comment"># defines a generator function</span><br>    <span class="hljs-keyword">yield</span> <span class="hljs-number">123</span><br><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">agen</span>(): <span class="hljs-comment"># defines an asynchronous generator function</span><br>    <span class="hljs-keyword">yield</span> <span class="hljs-number">123</span><br></code></pre></td></tr></table></figure><p>由于它们会对外层作用域造成附带影响，<code>yield</code> 表达式不被允许作为用于实现推导式和生成器表达式的隐式定义作用域的一部分。</p><blockquote><p><em>在 3.8 版更改:</em> 禁止在实现推导式和生成器表达式的隐式嵌套作用域中使用 yield 表达式。</p></blockquote><p>下面是对生成器函数的描述，异步生成器函数会在 <a href="https://docs.python.org/zh-cn/3/reference/expressions.html?highlight=yield#asynchronous-generator-functions">异步生成器函数</a> 一节中单独介绍。</p><p>当一个生成器函数被调用时，它返回一个名为生成器的迭代器。 然后这个生成器将控制生成器函数的执行。 执行过程会在这个生成器的某个方法被调用时开始。 这时，函数会执行到第一个 yield 表达式，在这里它将再次被挂起，向生成器的调用方返回 <a href="https://docs.python.org/zh-cn/3/reference/expressions.html?highlight=yield#grammar-token-python-grammar-expression_list"><code>expression_list</code></a> 的值，或者如果 <a href="https://docs.python.org/zh-cn/3/reference/expressions.html?highlight=yield#grammar-token-python-grammar-expression_list"><code>expression_list</code></a> 被省略则返回 <code>None</code>。 这里所谓的挂起，就是说所有局部状态都会被保留下来，包括局部变量的当前绑定、指令指针、内部求值栈和任何异常处理等等。 当通过调用生成器的某个方法恢复执行时，这个函数的运行就与 yield 表达式只是一个外部调用的情况完全一样。 恢复之后 yield 表达式的值取决于恢复执行所调用的方法。 如果是用 <a href="https://docs.python.org/zh-cn/3/reference/expressions.html?highlight=yield#generator.__next__"><code>__next__()</code></a> (通常是通过 <a href="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#for"><code>for</code></a> 或 <a href="https://docs.python.org/zh-cn/3/library/functions.html#next"><code>next()</code></a> 内置函数) 则结果为 <a href="https://docs.python.org/zh-cn/3/library/constants.html#None"><code>None</code></a>。 在其他情况下，如果是用 <a href="https://docs.python.org/zh-cn/3/reference/expressions.html?highlight=yield#generator.send"><code>send()</code></a>，则结果将为传给该方法的值。</p><p>所有这些使生成器函数与协程非常相似；它们 yield 多次，它们具有多个入口点，并且它们的执行可以被挂起。唯一的区别是生成器函数不能控制在它在 yield 后交给哪里继续执行；控制权总是转移到生成器的调用者。</p><p>在 <a href="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#try"><code>try</code></a> 结构中的任何位置都允许yield表达式。如果生成器在(因为引用计数到零或是因为被垃圾回收)销毁之前没有恢复执行，将调用生成器-迭代器的 <a href="https://docs.python.org/zh-cn/3/reference/expressions.html?highlight=yield#generator.close"><code>close()</code></a> 方法. close 方法允许任何挂起的 <a href="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#finally"><code>finally</code></a> 子句执行。</p><p>当使用 <code>yield from &lt;expr&gt;</code> 时，所提供的表达式必须是一个可迭代对象。 迭代该可迭代对象所产生的值会被直接传递给当前生成器方法的调用者。 任何通过 <a href="https://docs.python.org/zh-cn/3/reference/expressions.html?highlight=yield#generator.send"><code>send()</code></a> 传入的值以及任何通过 <a href="https://docs.python.org/zh-cn/3/reference/expressions.html?highlight=yield#generator.throw"><code>throw()</code></a> 传入的异常如果有适当的方法则会被传给下层迭代器。 如果不是这种情况，那么 <a href="https://docs.python.org/zh-cn/3/reference/expressions.html?highlight=yield#generator.send"><code>send()</code></a> 将引发 <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#AttributeError"><code>AttributeError</code></a> 或 <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#TypeError"><code>TypeError</code></a>，而 <a href="https://docs.python.org/zh-cn/3/reference/expressions.html?highlight=yield#generator.throw"><code>throw()</code></a> 将立即引发所转入的异常。</p><p>当下层迭代器完成时，被引发的 <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#StopIteration"><code>StopIteration</code></a> 实例的 <code>value</code> 属性会成为 yield 表达式的值。 它可以在引发 <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#StopIteration"><code>StopIteration</code></a> 时被显式地设置，也可以在子迭代器是一个生成器时自动地设置（通过从子生成器返回一个值）。</p><blockquote><p><em>在 3.3 版更改:</em> 添加 <code>yield from &lt;expr&gt;</code> 以委托控制流给一个子迭代器。</p></blockquote><p>当yield表达式是赋值语句右侧的唯一表达式时，括号可以省略。</p><p>参见</p><ul><li><p><a href="https://peps.python.org/pep-0255/"><strong>PEP 255</strong></a> - 简单生成器</p><p>在 Python 中加入生成器和 <a href="https://docs.python.org/zh-cn/3/reference/simple_stmts.html#yield"><code>yield</code></a> 语句的提议。</p></li><li><p><a href="https://peps.python.org/pep-0342/"><strong>PEP 342</strong></a> - 通过增强型生成器实现协程</p><p>增强生成器 API 和语法的提议，使其可以被用作简单的协程。</p></li><li><p><a href="https://peps.python.org/pep-0380/"><strong>PEP 380</strong></a> - 委托给子生成器的语法</p><p>引入 <code>yield_from</code> 语法的提议，以方便地委托给子生成器。</p></li><li><p><a href="https://peps.python.org/pep-0525/"><strong>PEP 525</strong></a> - 异步生成器</p><p>通过给协程函数加入生成器功能对 <a href="https://peps.python.org/pep-0492/"><strong>PEP 492</strong></a> 进行扩展的提议。</p></li></ul><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://docs.python.org/3/reference/expressions.html#grammar-token-python-grammar-yield_expression">6. Expressions — Python 3.12.0 documentation</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://stackoverflow.com/questions/231767/what-does-the-yield-keyword-do-in-python?page=1&tab=scoredesc#tab-top">iterator - What does the “yield” keyword do in Python? - Stack Overflow</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://blog.csdn.net/weixin_33751566/article/details/92288708">python生成器-CSDN博客</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">how to use &#39;yield&#39; keyword in Python</summary>
    
    
    
    <category term="Major" scheme="https://www.0co.dev/categories/Major/"/>
    
    <category term="CS61A" scheme="https://www.0co.dev/categories/Major/CS61A/"/>
    
    
    <category term="CS61A" scheme="https://www.0co.dev/tags/CS61A/"/>
    
  </entry>
  
  <entry>
    <title>科幻-异星歧途(TheRoadNotTaken)</title>
    <link href="https://www.0co.dev/TheRoadNotTaken/"/>
    <id>https://www.0co.dev/TheRoadNotTaken/</id>
    <published>2023-07-27T12:07:40.000Z</published>
    <updated>2023-10-31T03:06:11.000Z</updated>
    
    <content type="html"><![CDATA[<h2 align='center'>异星歧途(The Road Not Taken) </h2><p align='center'>哈利·托特达夫 Harry Turtledove </p><p align='center'>姚人杰 译 </p><p class='note note-success'>⌈八十亿疯狗冲出地球⌋的灵感起源，转载自互联网</p><h3 id="入侵"><a href="#入侵" class="headerlink" title="入侵"></a>入侵</h3><p>当“不摧号”凭借超空间引擎而凭空出现时，托格兰姆队长正在如厕。像经常发生的那样，这位罗克索兰人军官感到一阵反胃。他拿起便桶，对着它猛然呕吐起来。 </p><p>吐完后，他放下了便桶，用棕灰色皮毛光滑的前臂擦拭了流淌出泪水的眼睛。“众神诅咒它！”他大声骂道，“船长们跃迁前为啥不提醒我们？”他手底下的几个士兵更加尖酸地呼应着。 </p><p>这时候，门口出现一名传令兵。“我们回到正常的太空了。”年轻的士兵尖叫道，又冲向下一间舱室。他身后的人或是嘲弄，或是咒骂：“一堆废话！”“谢谢消息！”“告诉领航员——他们兴许还不知道呢！” </p><p>托格兰姆一声叹息，烦恼地挠起鼻子，担忧起自己的烦心事儿来。身为一名军官，他应该为士兵们树立个好榜样。他是低级军官，足以正儿八经地肩负起这些责任，可他服役甚久，早就觉悟到，他永远不应该指望哪个军阶比他高两级以上的长官给予他什么。高级军官能坐上那些位子，要么是老早就双手沾满鲜血，要么是新近砸下一大笔钱财。 </p><p>他又一次叹息，把便桶放回墙上的凹槽内。凹槽的金属盖被滑下，依旧不能阻挡臭气。在太空中待了十六天后，“不摧号”里弥漫着屎尿、腐败的食物和陈腐躯体的臭味。罗克索兰舰队的其他任何一艘飞船里的情况都不见得有多好，或者说其他任何一支舰队情况都不比眼下好。在星际间航行，就是这个样子。忍受臭味和黑暗，是军人为了让王国蓬勃壮大所付出的一部分代价。 </p><p>托格兰姆拿起一盏提灯，摇晃几下，唤醒提灯里的发光虫。发光虫受惊后耀出银白色的光芒。队长晓得，有些种族用火炬或蜡烛照亮他们的飞船，但发光虫耗费的空气更少，即便它们只能间歇地发光。</p><p>托格兰姆永远是个小心谨慎的军人，趁着光亮还持续时，查看了自己的武器。他总是把手头的四把手枪都装好子弹，时刻准备使用；等着陆行动开始后，一对手枪会挂在他的腰带上，另一对插在皮靴里。他更担心自己的剑，飞船上一直不散的湿气对剑刃不好。不出所料，他发现了一块要擦拭掉的锈迹。 </p><p>他擦拭双刃长剑的时候，揣想新星系会是什么样子。他祈求这个新星系里有一颗适合居住的行星。等到飞船回到最近的罗克索兰人控制的行星时，“不摧号”里的空气可能会腐臭得无法呼吸。那是“星辰开拓者”要冒的一个风险。这不算最大的风险——小型的黄色恒星通常都会驭御着一两颗能孕育生命的星球——可总归还是有风险。 </p><p>他情愿自己没有思索此事。担忧犹如令人疼痛的毒牙，一旦咬入你的皮肉，就甩不走了。他从一摞被褥上起身，去看领航员做得怎样。 </p><p>和以往一样，兰西斯克和学徒奥格伦都在抱怨他们磨制望远镜的玻璃多么劣质。“你俩应该停止埋怨，”托格兰姆一边说，一边眯眼从门口向里面瞅，“你俩至少看东西的时候有光照着。”在长时间借助发光虫提灯看事物之后，他不得不先耐心地等待自己的眼睛适应观察舱内刺眼的阳光，才能进舱室。 </p><p>奥格伦气恼得耳朵后仰。兰西斯克年纪更大，也更冷静。他把手放在学徒的胳膊上。“假如托格兰姆每嘲弄你一次，你都发脾气，那么你会没时间干别的任何事——他从蛋里孵出来的那天起，就是捣蛋鬼。托格兰姆，对不对？” </p><p>“随你怎么说。”托格兰姆喜欢这位白鼻子的资深领航员。兰西斯克不同于他的多数同行，举手投足间不像他们那么高傲，他并不认为自己做着一份重要的差事，反而使得自己在众神计划中占据着某种特殊的地位。 </p><p>奥格伦突然愣住了，粗短的尾巴末梢抽动起来。“这儿有颗行星！”他呼喊道。 </p><p>“让我瞧瞧。”兰西斯克说道。奥格伦让开望远镜后的位置。两位领航员一颗颗瞧看那些明亮的恒星，寻找那些显示出星系盘，表明它们确实属于行星的星球。 </p><p>“确实是行星。”兰西斯克最终说道，“但不适合我们居住——那些有条纹的黄色行星无一例外空气总有毒，这类事见得多了。”他见到奥格伦沮丧的表情，又说道：“也并非一无所得——假如我们沿着一条从那颗行星到它的恒星的直线去观察，我们应该很快就会找到另外的行星。” </p><p>“试试那颗星球。”托格兰姆边说边指向一颗微红色的星球，它看上去比他目力所及的其他多数星球都更明亮。 </p><p>奥格伦嘟哝了几句傲慢的话，说自己对本行当然比外行人了解得多，可兰西斯克厉声呵斥道：“队长从太空见过的星球比你多多了，小子。你应该照队长的吩咐做事。”奥格伦情绪低落地垂下耳朵，依命行事。 </p><p>他的不悦随即烟消云散。“是一颗有绿色斑点的行星！”他大喊道。 </p><p>兰西斯克此前一直把望远镜对准天空的另一区块，听到此话，赶紧奔了过去。他推开学徒，调整望远镜的聚焦，久久地凝视放大后的图像。奥格伦在换着脚单脚跳，灰棕色的皮毛膨胀起来，迫不及待地要听到师傅的定论。 </p><p>“也许吧。”资深领航员说道，奥格伦的脸庞随之亮堂起来，可是当兰西斯克继续说后，奥格伦又变得垂头丧气。“我没看见任何像开阔水面的东西。如果我们没找到任何更有力的证据，我说我们还是试一下，再搜索一段时间。” </p><p>“我会让一只洛夫兽非常开心的。”托格兰姆说道。兰西斯克轻声笑起来。罗克索兰人把洛夫兽这种小动物带在身边，用它们测试新发现的行星的空气。假如在飞行器气闸舱的洛夫兽能呼吸星球的空气，那么该星球的空气对洛夫兽的主人应该也安全。 </p><p>在一连有好几颗星球只看得见几个光点后，领航员恼怒地吼起来。接着，在用望远镜观察的兰西斯克愣在了原地。“是这儿了。”他轻柔地说道，“这儿就是我们想要的。奥格伦，过来。”</p><p>“哦，我的天啊，确实。”学徒看了一会儿后惊叹道。 </p><p>“去把此事报告给斯列冯统帅，问下他，他手头的设备有没有探测我们舰队之外的任何超空间引擎的振动。”奥格伦匆匆离去，兰西斯克示意让托格兰姆过来。“你自己看看。” </p><p>步兵队长弯下腰，凑到目镜前。在漆黑太空的映衬下，望远镜里见到的星球看上去酷似罗克索兰星球：蔚蓝色的深海上覆盖着旋涡状的白色云团。一颗相当大的卫星悬挂在附近。两颗星球都差不多在半相期，比“不摧号”更靠近它们的恒星。 </p><p>“你看见陆地了吗？”托格兰姆问道。 </p><p>“看图像最上面，冰冠下面。”兰西斯克说，“那些棕色和绿色图案不是通常情况下水面的颜色。假如我们想在这个星系里找到个有生命的星球，那么你现在看到的就是。” </p><p>他们轮流观察那颗遥远的星球，试图画下地貌特征，一直到奥格伦回来。“怎样？”托格兰姆说道，不过他见到学徒的耳朵欢快地高耸着。 </p><p>“整个星系里只有我们的超空间引擎的放射！”奥格伦笑着说。兰西斯克和托格兰姆都拍打起学徒的后背，好像他是好消息产生的原因，而不只是带来好消息的人。 </p><p>队长甚至笑得比奥格伦更开心。这意味着那将是一次简单的征服行动，作为一名职业军人，他完全赞同。如果附近没有人能够制造超空间引擎，那要么是星系里根本没有智慧生命，要么是居住在星球上的种族依然处在原始状态，对火药、飞行器和星际战争的其他方面一无所知。 </p><p>他搓了搓手。他迫不及待地要着陆了。</p><h3 id="接触"><a href="#接触" class="headerlink" title="接触"></a>接触</h3><p>巴克·荷索百无聊赖。在太空中待了足足四个月，还有五个半月在等着他，人变得无聊一点儿也不让人惊讶。地球是“阿瑞斯三号”后面的一颗明亮星球，较为暗淡的月球陪伴左右，火星在前方发出红光。 </p><p>“巴克，现在轮到你锻炼了。”阿特·施奈德喊道。在五名宇航员之中，他大概是最爱发号施令的那位。 </p><p>“晓得了，伙计。”荷索叹息道。他把自己推到脚踏车上，踩踏起来，起初无精打采地，接着越来越使劲。锻炼有助于保持骨骼中的钙质，令其尽量少受失重的影响。此外，也让宇航员们有点儿事做。 </p><p>梅丽莎·奥特正在收听地球传来的新闻。“费南多·巴伦斯瑞拉昨晚过世了。”她说。 </p><p>“谁？”施奈德不是棒球迷，不知道这位洛杉矶道奇队的天才投手的大名。 </p><p>荷索是个棒球迷，还是个加利福尼亚人。“我曾经在一次退役球手纪念赛见过他，我还记得老爸和爷爷总是说起他。”他说，“梅尔<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="梅尔是梅丽莎的昵称。">[1]</span></a></sup>，他享年几岁？” </p><p>“七十九岁。”梅丽莎答道。 </p><p>“他总是活得太沉重。”荷索伤感地说。 </p><p>“耶稣基督啊！” </p><p>荷索眨了眨眼。自打从美国太空站起飞开始，阿瑞斯三号上的宇航员从没说话如此激动过。梅丽莎正看着雷达屏幕。“弗雷迪<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="弗雷迪是弗雷德丽卡的昵称。">[2]</span></a></sup>！”她大喊道。 </p><p>飞船上的电子专家弗雷德丽卡·林施乔姆刚刚从促狭的浴室里出来。她扑向控制面板，身后依然拖着一串小水滴。她没有费事地用毛巾擦干身子——很久之前，羞怯心在阿瑞斯三号上就已经荡然无存了。 </p><p>梅丽莎的叫喊甚至令克劳德·琼纳德从生物实验室里探出头来，他的多数时间都花费在这个小小的实验室里。“出了什么情况？”他从舱口喊道。 </p><p>“雷达不对劲儿。”梅丽莎告诉他。 </p><p>“什么意思，不对劲儿？”琼纳德气恼地追问。他是那类觉得自己的每分每秒都很宝贵，并认为别人也是如此的讨厌鬼。 </p><p>“屏幕上有大约一百个、也许一百五十个物体，根本不应该在那儿的物体。”弗雷德丽卡·林施乔姆插嘴说道，她也有点儿惜时如命的毛病，“距离在两百万公里左右。” </p><p>“它们一分钟前还没在那儿。”梅丽莎说，“我想知道它们会在什么时候出现。” </p><p>当弗雷德丽卡操作起雷达与电脑时，荷索还在健身脚踏车上，觉得自己百无一用：一位地质学家在距离星球有几百万公里的地方有什么用处？他甚至无法让自己的名字被铭刻于历史书上——没人会记得第三批探险队的成员，无论他们的目的地是哪里。 </p><p>弗雷德丽卡完成了检查。“我找不到任何故障。”她说话的语气像是在生自己和设备的气。 </p><p>“是时候联系地球了，弗雷迪。”阿特·施奈德说，“假如我要登陆火星的话，不能指望一台闹故障的雷达。” </p><p>梅丽莎早已在用话筒与地球通话。“休斯顿，这儿是阿瑞斯三号。我们遇上了个难题——” </p><p>即使信号以光速传播，依然得等待好久。宇航员一个接一个地缓缓凑过来。扩音器突然发出声音时，每个人都被惊得跳了起来。“阿瑞斯三号，这儿是休斯顿控制中心。女士们，先生们，我不知该如何告诉你们这件事，但我们也见到它们了。” </p><p>联络员还在继续唠叨，但已经没人在听她讲话。荷索觉得头皮刺痛，头发出于原始反射一根根地想要竖起来。他的内心充满惊惧，他从未想到，自己会亲眼目睹人类与外星种族的接触。“梅尔，向它们发信号。”他催促道。 </p><p>她犹豫不决。“巴克，我不晓得该不该那么做。也许我们应该让休斯顿来处理。” </p><p>“去他妈的休斯顿。”他冒出的粗口让自己都惊讶，“等到那里的官僚琢磨出对策的时候，我们那时早就着陆在火星上了。我们才是在场的人。你打算错过两个种族历史上最为重要的时刻吗？” </p><p>梅丽莎逐一看向她的同伴。无论她在他们的脸上见到了什么，总之是令她满意的结果，因为她把目标转向天线，开始说话：“这儿是太空飞船阿瑞斯三号，呼叫未知的飞船。致以地球人民的欢迎。”她暂时关掉了无线电发射机问：“我们共能说多少种语言？” </p><p>他们依次以俄语、汉语、日语、法语、德语、西班牙语，甚至包括拉丁语发送了呼叫。（“谁知道外星人上一次访问地球是在什么时候？”当施奈德向她投以怪异的眼神时，弗雷德丽卡如此辩护。） </p><p>假如说等待地球发来的回复耗时良久，那么这一次等得更久。延迟了好久，远远超过一个光速来回所需的十五秒。“就算他们不会说我们的任何一种语言，他们不也应该说点儿什么吗？”梅丽莎对着空气问道。空气或外星人都没有回答她。 </p><p>接着，那些古怪的飞船开始背离太阳，向着地球疾驰而去。“我的天啊，它们加速了！”施奈德说，“那些不是火箭吧！”他突然间胆怯起来。“我猜想星际飞船不会携带火箭的，对吧？” </p><p>阿瑞斯三号再一次孤零零地漂泊在这一片太空中，循着它的霍曼转移轨道，毫不动摇地继续飞向火星。巴克·荷索不禁想哭。 </p><h3 id="试探"><a href="#试探" class="headerlink" title="试探"></a>试探</h3><p>罗克索兰舰队的飞船和演习时一样，聚拢在这个新发现的行星陆地较多半球的地极上空。因为每个人都会抵达相同的地点，这套准则使得舰队的会合容易一些。很快，只有四艘飞船没有出现。一艘侦察舰赶紧绕到另一面的地极，找到那四艘飞船，把它们带了回来。 </p><p>“每一次都有几个喜欢水的家伙。”托格兰姆给领航员们带来消息时，咯咯笑着说道。他抓住每一次机会溜到领航员的-圆顶观察舱，不只是因为这儿阳光充沛，还是因为他和许多军人不同，对行星本身感兴趣。要是他有擅长计算的头脑的话，他也许早就尝试成为领航员了。 </p><p>他有着一只擅长执笔写写画画的手，所以兰西斯克和奥格伦乐意让他待在望远镜旁，为他们正在绘制的行星草图添上几笔。 </p><p>“真是稀奇的星球。”他评论道，“我从未见过哪颗星球上有如此多的林火或火山，或者黑暗那面的天知道什么着了火的东西。” </p><p>“我依然认为那些是城市。”奥格伦说道，公然与兰西斯克针锋相对。 </p><p>“它们太大也太亮了。”资深领航员耐心地说道。他们的争论显然已经持续了好一会儿。 </p><p>“奥格伦，这次是你第一趟异星之旅，对不对？”托格兰姆问道。 </p><p>“是啊，是又如何？” </p><p>“你就是看问题还不够全面。罗克索兰星上的伊戈罗克将近有一百万人口，夜里从太空看它，几乎看不见。也没有哪个地方像这些光亮一样明亮。请记住，这是一颗原始的行星。我承认，下面看上去确实居住着智慧生命，但一个尚未意外地发现超空间引擎奥秘的种族怎么可能建造起大小十倍于伊戈罗克的城市？” </p><p>“我不知道。”奥格伦闷闷不乐地说，“但是从我借助月光依稀看见的地貌来说，那些光亮都处在建造城市的最佳地点——海岸线上、河流沿线，诸如此类。</p><p>兰西斯克叹气道：“托格兰姆，我们得拿他怎么办？他一心以为自己样样都懂，不会听我们讲道理。你年轻时也这副腔调？” </p><p>“不管怎样，得一直等到我的氏族家长们把我教训得服服帖帖。不过，无须大惊小怪。很快飞行器就会带着洛夫兽降落星球，我们那时就能知晓答案了。”他强忍下笑声，突然脑袋清醒起来，希望自己年轻时没有像奥格伦这样容易上当。 </p><p>“我的雷达上显示出一艘外星人的飞船，”SR-81侦察机的飞行员报告说，“它下降到五万米高度，依旧在降落。”侦察机已经达到了上升限度，而这只不过达到了外星人飞船进入大气层时的一半高度。 </p><p>“看在上帝的份儿上，先别开火。”地面控制中心下令道。在他起飞前，他们已经向他下达过这条命令，但这些军队高层不打算让他忘记此事。他并不是真的责怪他们。一个爱乱开枪的蠢蛋可能永远葬送人类。 </p><p>“我开始获得视觉图像，”他边说边瞥看着投射在面前的平视显示器上的画面。片刻后，飞行员问道，“我现在就能告诉你们，这是一艘长相怪异的飞船。它的机翼在哪儿？” </p><p>“我们现在也在接收图像。”负责地面控制的长官说道，“他们一定是在大气层内飞行器上运用了和宇宙飞船上相同的原理，某种反重力装置，赋予了他们提升和驱使物体的能力。”</p><p>外星人的飞船一直没理睬SR-81侦察机，正如所有外星人都没理睬地球向他们发送的信号。外星人的飞行器继续缓缓降落，SR-81侦察机在下面盘旋，希望自己不必下降至空中加油机那儿要求补加燃料。 </p><p>“一个疑问获得了解答，”他呼叫地面控制中心，“这是一架战机。”抱着和平意图的飞行器不会在机腹上画上那些虎视眈眈的眼睛和满嘴尖牙利齿的血盆大口。美国空军有一些对地攻击机上也画有类似的标志。 </p><p>外星人的飞行器最终降落至SR-81侦察机巡航的高度。飞行员再次呼叫地面。“可否允许我在外星人飞行器前面飞掠过？”他问道，“也许飞行器里的所有人都睡着了，我此举能弄醒他们。” </p><p>地面控制中心沉默许久后，不情不愿地同意了。“不许做敌意的手势。”控制人员警告说。 </p><p>“你觉得我会做什么，对着外星人竖起中指？”飞行员咕哝着，但他的无线电已关闭。当他控制着SR-81侦察机开始漫长而缓慢的拐弯，飞机的加速度使得他被压在座椅里，这一拐弯会让飞机出现在外星人太空舰队派出的那艘飞船前方五百米左右的地方。 </p><p>飞机上的摄像头让飞行员瞥见了外星人飞行员的模样，对方坐在一面脏兮兮的小挡风玻璃后面。 </p><p>外星生物也看见了他。毫无疑问地看见了他。外星人飞行员像只受到惊吓的幼鹿左躲右闪，完成了一连串复杂的机动飞行动作，这些动作会令SR-81侦察机的飞行员被紧紧地压在压力舱的舱壁上——前提是他的飞机性能能跟得上外星人的飞行器。 </p><p>“我要追赶敌机！”飞行员大喊道。地面控制人员冲着飞行员厉声训斥，可坐在驾驶舱里的是飞行员而不是控制人员。飞机后燃器开启后产生汹涌澎湃的瞬间加速力，相比之下，他之前感受到的压力不过像爱人的轻抚。 </p><p>他的侦察机拥有更佳的流线型设计，速度比星际飞船派出的飞行器更快，但那并没让他占到便宜。外星人飞行员每次发现他，他们的飞船就能毫不费力的轻松躲开。SR-81侦察机的飞行员觉得自己像个想用短柄斧头杀死一只蝴蝶的笨男人。</p><p>更令他受挫的是，他的燃料警示灯亮了起来。不管怎样，他的飞机是针对接近太空的稀薄大气层而设计的，不是用来在外星飞行器所飞经的越来越稠密的大气层里运转的。他骂了句脏话，但不得不飞离了敌机。 </p><p>当SR-81侦察机从空中加油机里吞进航空煤油时，飞行员不禁想起，假如他刚才发射一枚导弹会发生什么事。他有两次处于极佳的发射位置。他只会在自己心底里想想这事而已。上级们要是知道他有这个想法会有什么可怕反应，单单想到此处，他就不敢深思此事。 </p><p>托格兰姆参加完军官会议回来时，步兵们把他团团围住。“队长，什么命令？”“洛夫兽还活着吗？”“下面什么模样？” </p><p>“伙计们，洛夫兽活下来了！”托格兰姆笑容绽放地说道。 </p><p>他的连队成员大声欢呼，营房里回响起震耳欲聋的喝彩声。“我们要下去了！”士兵们呼喊起来。一些人兴奋地竖起耳朵。有些士兵在空气腐臭的房内挥动起羽饰帽。其他人的喜好则更像他们的队长，走到各自的地铺，开始检查武器。 </p><p>“长官，敌人会有多么强硬？”托格兰姆走过时，一位名叫伊灵古阿的，长着灰色皮毛的老兵开口问道，“我听说飞行器飞行员看见了一些奇怪的东西。” </p><p>托格兰姆笑得更欢了。“伊灵古阿，老天在上啊，你难道经历得还不够多，不晓得在星球着陆前，比起留意这些你听到的谣言，还有更重要的事要做？” </p><p>“长官，我也希望如此。”伊灵古阿说，“但这些谣言如此怪异，我揣想也许有些实情。”见托格兰姆没有回答，老兵自感愚蠢，摇了摇头，摇晃起提灯，这样他就能检查短剑的利刃。</p><h3 id="登陆"><a href="#登陆" class="headerlink" title="登陆"></a>登陆</h3><p>步兵队长尽量不惹人注意地发出一声叹息。他不晓得自己该相信哪种说法，而他刚才也听了飞行员的汇报。这个星球上的原住民不懂反重力技术，他们又怎么可能拥有飞行器？托格兰姆听说过有个种族在发现更佳的飞行方法前，使用了热气球，但热气球不可能抵达原住民的飞行器出现的高度，也不可能改变方向，飞行员在会议上一直坚持说那架飞行器改变了方向。 </p><p>必须假定飞行员弄错了，他肯定是弄错了。但是假如兰西斯克之前嘲弄过的那种可能性是真的，这个星球人口如此稠密，只剩下一丁点宝贵的野外空间，如此庞大的城镇又该如何想象？其他飞船发来的提灯信号表明，他们派去侦察的飞行员也汇报了同样疯狂的不可能现象。 </p><p>甭管了，从长远来看，即使这个种族数目像野餐时的瑞佛虫一样繁多也无关紧要。那样只会是有更多的臣民服膺于罗克索兰。 </p><p>“这是白白糟蹋了机会。”比利·考克斯一边对众人说道，一边把帆布包甩到肩头，大步流星地奔向那辆正在等他的卡车。“我们应该张开双臂欢迎外星人，不该展示武力。” </p><p>“你跟他们说去，教授。”中士桑托斯·阿莫罗斯在后面窃笑，“我呢，只想尽快在哪个有空调的营房里舒舒服服地坐下，不用再面对洛杉矶的炎夏烟雾和大太阳。真可惜，你只是个一级专业军士。如果你是总统，你就能随心所欲地下达命令，而不是在这儿接受命令。” </p><p>考克斯觉得那样也不是十分公道。第二次叙利亚危机爆发后，军队招兵买马，他被招募进陆军的时候，正攻读政治科学硕士的他只是少了几个学分。 </p><p>他必须把自己瘦长的身体像把折刀一样折叠起来，才能钻进卡车橄榄色的顶篷下面，在乘客舱里坐下。座位太硬，也彼此靠得太近。把人都塞进车里比他们坐得舒不舒服更重要，尽管乘客就活生生地在你面前。典型的军人思维，考克斯轻视地想道。 </p><p>卡车很快就坐满了人。柴油发动机伴着隆隆声启动。一个黑人士兵掏出一副扑克牌，和众人打赌，说他能把二十五张扑克牌变成五手好牌。有两个生手和他赌了起来。考克斯以前赌输了不少钱后，才弄明白这是个骗人的赌局。黑人士兵一边暗笑，一边把扑克牌递给一个上当的蠢蛋，让他洗牌。</p><p>嘶！扑克牌撕开的声音响起，使得卡车里的所有人都转头来看。“伙计，你从哪儿学会这样玩扑克牌？”黑人士兵质问道，他名叫吉姆，但大家都喊他小吉。 </p><p>“在拉斯维加斯玩二十一点的时候。”嘶！ </p><p>“嘿，小吉，”考克斯喊道，“我突然想要回输给你的十块钱。” </p><p>“伙计，你的钱已经花掉了。”小吉一边说，一边郁郁不乐地看着扑克牌移动，仿佛这些纸牌具有生命。 </p><p>卡车一路向北驶，卡车所在的护卫车队包括了卡车、机械化步兵战车、轻型坦克，延绵数英里。这个整编团正向洛杉矶开拔，以连队为单位，安置在洛杉矶市的不同地区。考克斯很赞同这种安排，这样他就不太可能会与那些外星人正面相遇了。 </p><p>“桑迪，”他对紧挨着坐在自己身旁的阿莫罗斯说道，“就算我弄错了，外星人并非友善之辈，那手持的武器会有什么用呢？这就好比手持安全别针与大象较量。” </p><p>“教授，我早跟你讲过，他们付钱给你我不是让我们思考。思考问题也无妨，但我要执行中尉命令我做的事情，你要执行我叫你做的事情，那样就万事大吉了，对不对？” </p><p>“好吧。”考克斯这么说是因为桑迪不是个坏家伙，而且是位中士。然而，倚靠在考克斯靴子中间的那把新式步枪看起来十分无用，他的头盔和护身装甲同脱衣舞女郎的性感睡衣一样轻薄。 </p><p>随着“不摧号”进入大气层，观察舱外面的天空开始从黑色变成深蓝色。“那儿。”奥格伦指着某个地方说道，“我们会在那里降落。” </p><p>“从目前的高度看不见多少。”托格兰姆评论说。 </p><p>“奥格伦，让他用你的望远镜。”兰西斯克说，“他很快就要回他的连队去了。”</p><p>托格兰姆咕哝了起来，兰西斯克的话不那么简单，有着弦外之音。尽管如此，他还是很乐意从目镜里看看外面。大地仿佛向他冲来。他逐渐适应颠倒的映像时，有一阵头晕目眩，映像中的海洋处在视野中错误的一侧。但他对看风景没兴趣，他想要弄明白的是：他手底下的士兵和“不摧号”上的其余部队必须要怎么，才能打出一个滩头堡，并死死守住，对付这个星球上的原住民。 </p><p>“那儿有个看上去很不错的地点。”他说，“城市东边——不，是西边——区块的建筑物中间的那块绿地。那应该能给予我们一块开阔的着陆场地，一块合适的扎营地，以及让增援部队着陆的基地。” </p><p>“让我看看你在说的地方，”兰西斯克边说边把他推攮到一边，“嗯嗯，是的，我看到你说的那片地方了。那地点也许不坏。奥格伦，过来看看这个。你能在统帅的望远镜里再次找到这个地点吗？如果行的话，就去指出给他看。我们建议把那儿当做我们的降落地点。” </p><p>学徒匆匆离开。兰西斯克再次俯身凑到目镜上。“嗯嗯，”他再一次说道，“下面的人造建筑挺高，对吧？” </p><p>“我觉得是这样。”托格兰姆说，“道路上也车水马龙。他们花费了好大一笔钱给道路都铺上了圆石，我没看见路上扬起半点儿尘土。” </p><p>“这次的征服应该能获得很丰富的战利品。”兰西斯克说。 </p><p>一个仿若猎鸟的金属物体从观察舱窗口旁飞掠而过。“老天啊，他们确实有飞行器，我没眼花吧？”托格兰姆说道。虽然飞行员一直宣称看见飞行器，可在他的内心深处，他并未相信过这种说法，直到他亲眼见到。 </p><p>他注意到兰西斯克的耳朵在急躁地抽搐着，意识到自己确实在观察舱里滞留了太久。他拿起自己那盏发光虫提灯，回到自己的部队。 </p><p>有两个士兵因为他离开太久而怨恨地看着他，可是他告知了两人着陆地点的情况，鼓舞了他们的斗志。普通士兵最喜欢的莫过于内部消息了。他们不晓得内部消息的时候，会胡乱猜测上级的心思，但是当他们对上级讨论的事情略知一二的话，这场游戏就更加有趣。 </p><p>门口出现一名传令兵。“托格兰姆队长，你的连队会从三号气闸舱着陆。” </p><p>“三号。”托格兰姆复述了一遍，传令兵跑开了，去传令给其他地面部队的长官。队长戴上羽饰帽（羽毛是猩红色的，这样他的连队即使在战场上也能认出他），最后一次检查了手枪，接着命令自己的部属紧跟着他。</p><p>气闸舱内侧门前面和“不摧号”上的其余任何地方一样乌漆墨黑，一样臭不可闻，一样令人不舒服，但不知怎地，待在这儿容易忍受些。很快，舱门就会开启，他会感觉到清新和风吹拂在皮毛上，品味到芬芳好闻的干净空气，享受到和煦的阳光，还不受时间限制。很快，他就会在战斗中与这些新遇到的生物较量一番。 </p><p>“不摧号”上的飞行器从母舰上发射出去的时候，他感觉到一点点震动。这回飞行器上不会载有洛夫兽，而是载上了火枪手，他们会从上空开火，把罐装的火药引线点燃，再从空中扔下，以此来威吓这颗星球上的原住民。罗克索兰军队总是尽全力给敌人留下凶残的初印象——恐惧能令他们的兵员翻倍。 </p><p>传来了另一阵震动，与上一次的震动不同。这回是飞船着陆了。 </p><p>加州大学洛杉矶分校的校园被一片阴影覆盖。小吉伸长脖子，说道：“乖乖隆叮咚，看看这大家伙！”他念叨这句话已经足足有五分钟，在外星飞船缓缓降落时一直没停过。 </p><p>他每次念叨时，比利·考克斯只能点点头。他的嘴巴干渴，双手紧握在步枪的塑料手柄和冰凉的金属枪管上。新式步枪在这艘趾高气扬地降落的庞大飞船映衬下显得不堪一击。外星人的飞行器在飞船周围飞来飞去，好似鲸鱼旁边的小鲦鱼，它们转而又令更远处盘旋的美国空军战机显得像侏儒。战机的喷气式发动机发出巨响，能刺破地面上紧张不安的士兵和平民的耳膜，而外星飞行器的发动机则安静得可怕。 </p><p>外星飞船降落在新罗伊斯楼、新海恩斯楼、新金赛楼和新鲍威尔楼中间的方形空地上。飞船比周围随便哪座两层楼红砖建筑都要来得高，这儿的每座楼都是原有楼房在二○三四年洛杉矶大地震中坍塌后重建起来的。考克斯听见空地上的小树苗在外星飞船的重压下断裂的声响。他寻思着，五年前随着那些著名的老楼一起倒下的大树就算依然存在，照样会支撑不住。 </p><p>“好了，它们着陆了。我们赶紧上去。”肖顿中尉下令道。他其实没能克制住嗓音的颤抖，可他依然快步向南，冲向外星飞船。他带领的排跟在他身后，经过了迪克逊艺术中心，经过了新邦奇楼。距现在还不是太久的时候，比利·考克斯曾赤脚走在这个校园内。此时此刻，他脚上的靴子踩踏在混凝土路面上，砰砰作响。 </p><p>这个排部署在道德楼前面，向西看，能见到外星飞船。一阵柔风抚弄着小树的叶片，这些尚需壮大的小树种在这儿，是为了取代那些在地震中倒下的茁壮大树。</p><p>“尽可能去找掩护。”肖顿中尉平静地下令。这个排匍匐进花坛，蜷伏在细瘦的树干后面。外边的希尔加德大道上，装甲战车都已经找好最佳的射击位置，各就各位，柴油发动机则发出轰鸣声。 </p><h3 id="对峙"><a href="#对峙" class="headerlink" title="对峙"></a>对峙</h3><p>考克斯不悦地想着，这完全是在浪费时间。现在该做的事是与外星人友好相处，而不是一上来就假定外星人是危险的。 </p><p>至少，有些事正沿着这一方向进行着。一个代表团从墨菲楼里走了出来，躲在一面白旗后面，从这栋行政楼缓缓走向外星飞船。代表团里打头阵的是洛杉矶市长——总统和加州州长正在别处忙碌着。比利·考克斯不惜付出任何代价，只要能成为代表团成员就行，而不是倒卧在这儿，肚子贴着草地。要是外星人等到他五十来岁的时候再过来，让他有机会成为大人物，该有多好…… </p><p>阿莫罗斯中士用手肘轻推了他。“伙计，看看那儿。有情况——” </p><p>阿莫罗斯是对的。好几扇之前还紧闭的舱门徐徐打开，使得地球的空气能够与船舱里的气体混合。 </p><p>西风变大了。考克斯的鼻子抽紧。他说不明白这些冲他飘来的奇怪气味都是什么来路，可他嗅到味道的时候，闻出了污水和垃圾的气味。“老天，好臭啊！”他说道。 </p><p>“神灵在上，好臭啊！”托格兰姆惊呼起来。当气闸舱的外侧门放下时，他本来期待着外边新鲜的空气能取代“不摧号”里面陈腐的臭气。这儿的空气闻起来像在用泥煤生火，烟气缭绕，要不就是灯芯尚未被掐灭的油灯气味。它还令眼睛灼痛！他感觉到瞬膜覆盖到眼球上保护双眼。 </p><p>“准备战斗！”他下达命令之后，就带领着自己的连队往前走。这一步最难处理好。假如这儿的原住民够胆量的话，他们可以趁着罗克索兰人走出飞船的时候发动攻击，那样会引发各种麻烦。然而，多数未掌握超空间引擎技术的种族都会敬畏于外星访客的到来，不会尝试发动那样的攻击。假如他们不迅速发动攻击，那就为时太晚了。</p><p>这儿的人没有发起进攻。托格兰姆看见一些原住民，但他们保持着一定距离。他吃不准那儿有多少原住民。他们的皮肤斑驳——或者那其实是衣服？——很难注意到他们，也很难数清楚人数。可他们肯定是战士，从他们的举止和手里拿着的武器就看得出来。 </p><p>他的连队组成了熟悉的两排阵形，第一排蹲在地上，第二排站着，手里的火枪瞄准了敌方前列部队的脑袋。 </p><p>“哈，我们去那边。”托格兰姆欣喜地说道。躲在白旗后面上前的那伙人肯定是原住民中的贵族。队长瞧出来了，那色彩斑驳的其实是衣服，因为这些人的穿着独树一帜，颜色暗黑，脖子上还挂着外形怪异的狭长布条。他们比罗克索兰人更高，也更瘦，脸上也没有突起的鼻子。 </p><p>“伊灵古阿！”托格兰姆大声喊道。这个老兵率领着连队右翼的小队。 </p><p>“长官！” </p><p>“你的部队阵线逆时针转四十五度角。听到命令后，击倒那儿的敌方将官，那样会削弱余下敌军的士气。”托格兰姆按照标准的作战守则下达了命令。 </p><p>“准备好火绳！”托格兰姆说道。罗克索兰士兵把闷烧着的火绳放落到火枪的火门上。“瞄准目标！”一把把火枪微微地移动。“开火！” </p><p>“泰迪熊！”桑迪·阿莫罗斯一声惊呼。同样的念头跃入了考克斯的脑海。外星飞船里出来的外星生物是棕褐色的，圆鼓鼓、毛茸茸，有着长长的鼻子和大大的耳朵。然而，泰迪熊通常可不会手持武器。 </p><p>考克斯心想道，泰迪熊通常也不会住在一个闻上去像臭水沟的地方。当然，这股气味在他们闻起来可能像香水。可假如真是那样，外星人和地球人相处起来就会有麻烦了。</p><p>他注视着泰迪熊各就各位。不知怎地，他们的阵形并没让人觉得他们要构成仪仗队欢迎市长和他的随从。不过，这场景在考克斯看来很眼熟，然而他也想不明白原因。 </p><p>接着，他突然灵机一动。要不是他眼下在加州大学洛杉矶分校的校园里，他绝不会打通关节。他记得自己上过一门课，课上讲授了十六世纪欧洲民族国家的崛起，以及国王创建的纪律严明的职业军队的重要性。那些早期军队和眼前的外星人军队一模一样。 </p><h3 id="交火"><a href="#交火" class="headerlink" title="交火"></a>交火</h3><p>这是一次滑稽的巧合。他正要向中士提起这一发现，这时突然枪声大响。 </p><p>外星人的长枪突然喷出火舌，大团的烟气飘入天空。考克斯的耳畔响起了一阵响声，仿若一只愤怒的黄蜂在嗡嗡叫。他听到两边传出叫喊和尖叫声。市长代表团里的多数人都已倒下，一些人不再动弹，另一些人痛得翻来覆去。 </p><p>外星飞船发出一声动静，瞬息之后，又是一声，同时一发圆炮弹击中了砖砌结构的道德楼。一块碎片打在考克斯的后脖子上。微风带来了爆竹的气味，他已经有很多年没闻到这种气味了。 </p><p>“继续装填！”托格兰姆喊道，“再齐射一次，然后用刺刀和敌人肉搏！”他部下的士兵疯狂地忙活着，测量每次装填火药的量，再装入实心圆弹。 </p><p>“他们想跟我们玩这个！”阿莫罗斯叫喊道，“兄弟们，把他们的皮剥下来钉到墙上！”阿莫罗斯的小手指头已经被打掉了，他似乎并没发觉。 </p><p>考克斯手里的新式步枪早已在开火，吐出一连串烫手的黄铜弹壳，枪身靠在他的肩上砰砰作响。他插入一个又一个弹夹，握在手里的步枪像水管一样倾泻出子弹。假如一发子弹没有击中敌人，那么下一发子弹一定会。 </p><p>与考克斯同个排的战友同样在开火。考克斯还听见校园内不同地方的自动化武器开火的声响，还有火箭推进榴弹和野战炮更为低沉的声响。人类军队产生的硝烟开始包裹住外星人的飞船和周围的外星士兵。</p><p>敌方冲着考克斯所在的排回了一两枪，然后又回了几枪，但他们的反击始终稀稀拉拉，考克斯惊讶得不敢置信，对中士喊道：“这不公平！” </p><p>“去他们的！”阿莫罗斯喊话道，“他们想要充老大，他们就得接受风险。他们干的唯一一件好事就是干掉了市长。我一直以来都讨厌那个老疯子。” </p><p>在托格兰姆听来，这种刺耳的哒哒哒声一点也不像他听到过任何一种开枪声。开火太过密集，形成了连绵不绝的恐怖枪声。假如原住民在反击他的部队，那么他们阵地上火药产生的呛人浓烟在哪儿？ </p><p>他不晓得这个问题的答案。他只知道自己的连队会像面对镰刀的谷物一样倒下。有个士兵一次被三枚子弹击中，姿态笨拙地倒在地上，仿佛他的身体不知道该转向哪一边。另一枚子弹打掉了他的天灵盖，场面可怕至极。 </p><p>队长刚才尖叫着下令齐射，可是还未实现就已泡汤。大概有一个小队的士兵勇敢地走向原住民，日光在这些擦得锃锃亮的长刺刀上闪耀。这些士兵还未踏出七八步，就已纷纷倒下。 </p><p>伊灵古阿看着托格兰姆，眼睛里充满恐惧，倒伏下的耳朵紧贴着脑袋。队长知道自己也是这个模样。“他们对我们干了什么？”伊灵古阿吼叫着。 </p><p>托格兰姆只能无助地摇摇头。他俯冲到一具尸体后面，拿起一把手枪对着敌人开了一枪。仍然有机会打赢，他心想道——这些疯狂的原住民怎么经受得住第一轮空中攻击？ </p><p>一架飞行器俯冲向原住民。火枪手从射击孔里开了一枪，随后退回去装填子弹。 </p><p>“干掉他们，这群婊子养的！”托格兰姆叫道。不过他并没有在空中挥舞拳头，因为他早已学乖了，知道这样做很危险。 </p><p>“有飞机！”阿莫罗斯中士咆哮道。他的班组中还未俯卧下的战士纷纷抬起头。同袍受伤的时候，考克斯在战场的喧嚣声中听见了痛苦的惨叫。</p><p>肩扛着导弹发射器对准外星人的飞行器发射了“水蝮蛇”对空导弹。对方飞行员一定拥有猫一样的神经反射。他驾驶飞行器在空中避向侧面，没有一架地球上制造的飞机能完成那样的动作。结果，水蝮蛇导弹从敌方飞行器旁飞掠过去，没有造成一丁点儿伤害。 </p><p>飞行器上扔下许多样子像是陶罐的玩意儿。这些炸弹爆炸时，地面都震动了。耳朵被震聋了的比利·考克斯咒骂开来，再也不担忧这场战斗是否公平。 </p><p>可敌方的飞行员没有看见跟在他屁股后面的F-29战斗机。这架美国空军的战斗机在不到一英里的近距离内发射了两枚导弹。那枚红外线制导导弹没有寻找到目标，自行爆炸了，但另一枚雷达制导导弹径直冲向地方飞行器。剧烈的爆炸让考克斯把脸埋进地里，双手捂住了耳朵。 </p><p>他心想着，战争就是这样：我几乎什么也看不见，什么也听不见，我的一方正在赢得战争。对于输家来说，会是什么样的呢？ </p><p>当第一架飞行器被原住民的飞机击中时，托格兰姆心中的希望之火熄灭了。“不摧号”上其余的飞行器也没撑多久。它们可以躲闪，但反击能力甚至比罗克索兰地面部队更弱。而且，当他们受到来自下方或后面等盲点的攻击时，简直就不堪一击。 </p><p>飞船上的一座火炮成功地进行了反击，立刻引来了那些会移动的堡垒的回击，移动堡垒在这个像公园的区域外面的街道上就位时，托格兰姆瞥见过几眼。 </p><p>第一枚炮弹袭来时，这位背运的队长还有一瞬间以为这是“不摧号”上的另一尊火炮开火了。爆炸声一点也不像实心炮弹击中目标时的撞击声。一块炙热的金属碎片在托格兰姆手边的地面上燃烧，这令他觉得是有尊火炮被炸飞了，但飞船的上层建筑发生更多的爆炸，有些未能打中飞船的炮弹使得泥土飞扬，说明这是原住民动用了更多凶恶的武器。 </p><p>一样大块的坚硬物体击中了队长的后脖子，世界天旋地转，他两眼一黑晕了过去。</p><p>“停火！”命令首先下达至野战炮部队，然后是最前线的步兵部队。比利·考克斯推上袖口，看了眼手表，难以置信地看着时间。整场交战持续了不到二十分钟。 </p><p>他看了眼四周。肖顿中尉正从一棵装饰性的假棕榈树后面爬起身。“我们去看看战果。”他说道。他开始缓缓走向外星飞船，手里的步枪仍然蓄势待发。那儿就是一处黑烟弥散的废墟。而且，周围的楼房也都毁于一旦。以前的楼房在大地震中毁坏更为严重，但波及没这么广。</p><p>草坪上散落着外星人的尸首。溅洒在碧绿色的草地上的鲜血和人类的血液一样，都是深红色的。考克斯弯下腰捡起一把手枪。手枪制作得很漂亮，枪柄的浅灰色木材上镌刻了战斗的场景。不过他认出这是把单发手枪，一件至少过世了两百年的轻兵器。他惊讶得直摇头。 </p><p>阿莫罗斯中士拿起了一件圆锥形状的东西，此前它落在一具外星人尸体旁边。“这是啥玩意儿？”他问道。 </p><p>考克斯又一次感到碰上了自己弄不明白的事。“这是个装火药的角筒。”他说道。 </p><p>“像电影里那样？拓荒者用的那玩意儿？” </p><p>“非常相像。” </p><p>“该死的。”阿莫罗斯感触颇深地说道。考克斯赞同地点了点头。 </p><p>他们和排里的其他人一道，靠近那艘被炸毁的外星飞船。大多数外星人已经死了，身体依然排成整齐的两排，他们正是以这个阵形向人类士兵开火的。 </p><p>在一具尸体后面，躺着一位头戴猩红色羽饰帽的军官尸体，正是他下令发动了这次恐怖的、实力悬殊的遭遇战。就在这时，外星人发出呻吟声，翻了身，和人类苏醒时的模样别无二致，考克斯被吓了一大跳。“抓住他。他还活着！”考克斯呼喊起来。 </p><p>好几个士兵扑到正苏醒过来的外星人身上，外星人身体绵软无力，无法反抗。士兵们开始从外星飞船撕裂的口子向里面张望，有几个胆大的甚至走了进去。他们依旧谨慎小心，这艘飞船庞大得不可思议，比任何一艘人类航天器都大多了，尽管它遭受过炸弹轮番攻击，里面肯定还有幸存者。</p><h3 id="善后"><a href="#善后" class="headerlink" title="善后"></a>善后</h3><p>和以往一样，士兵们没能享受快乐太久。战斗仅仅持续了几分钟，第一队专家就乘坐着直升机出现了，专家内心怀着保留意见地看着这些普通士兵，发出可怕的耳舌聒噪声，还立刻带走了考克斯所在排俘虏的外星人。 </p><p>阿莫罗斯中士忿忿不平地看着专家们带走了外星人。“桑迪，你知道这事一定会发生。”考克斯安慰他，“棘手的活由我们做，一等麻烦事办妥当，官员们就来接手。” </p><p>“是啊，但是如果这次不一样呢，岂不美妙？”阿莫罗斯不带幽默感地笑了出来，“你不用告诉我：这事机会渺茫。” </p><p>托格兰姆仰躺着醒来时，他知道有些事不对劲儿。罗克索兰人睡觉时总是俯卧的。起初他寻思自己怎么会躺在这儿……昨晚他喝了太多生命之水？他的脑袋很痛，极有可能确实是喝醉酒了。 </p><p>接着记忆涌回了脑海。那些该死的原住民用了带巫术的武器！是不是他的部下重振旗鼓，最终击退了敌人？假如那是真的，他誓愿在余生里一直为战争之主埃迪法女神点还愿灯。 </p><p>他所处的房间逐渐进入他的眼帘。从他躺的床到房顶的灯，没有一样东西是他所熟悉的。灯光明亮得犹如日光，既没烟气也没见火光闪烁。不，他认为罗克索兰人没有打赢那场仗。 </p><p>恐惧如同寒冰，落在他的心中。他知道自己的种族是如何对待俘虏的，也从其他人口中听到过太空人的可怕故事。他战栗了一下，想到捉住他的种族如此残暴，他们又能发明出怎样匠心独到的酷刑？ </p><p>他摇摇晃晃地站起身。他在床尾找到了帽子，几块显然是从“不摧号”上拿来的熏肉，还有一个半透明的罐子，是用某种既非皮革也非玻璃、更不是陶土或金属的材料制成的。不管它到底是什么，它都太过柔韧，无法制成武器。 </p><p>罐子里有水，但不是“不摧号”上拿来的水，那些水尝起来已经有股馊味了。这些水凉丝丝、新鲜又纯净，一点儿怪味都没有，这么好的水只有他喝过的两口山泉才比得上。</p><p>房门悄无声息地打开，铰链没有发出半点响声。走进来两个原住民。一个小个子穿了件白衣服——是个雌性，假如胸部隆起的两团东西是乳房的话。另一个人的装束和打赢了仗的原住民战士一样，不过这身制服在房间里没起到伪装效果。他手里拿着一把步枪，看上去极其警觉。众神诅咒他！ </p><p>出乎托格兰姆的意料，管事的竟然是雌性。另外一个原住民只是个保镖。队长心想，这一定是位被娇纵惯了的公主，对异族感到好奇。好吧，比起见原住民的行刑人，他更乐于与公主打交道。 </p><p>她坐了下来，招手让他也坐下。他试着在一把椅子上坐下，发现坐得不舒服——椅背太低，不是一把为他宽大的屁股和粗短的双腿而造的椅子。他转而坐在了地上。 </p><p>她放了一个小盒子在椅子旁的桌子上。托格兰姆指着东西问道，“这是什么？” </p><p>他心想她没有听明白问题——这不能怪她，她对他的语言一无所知。她在玩耍小盒子，揿下这儿的按钮，揿下那儿的按钮。接着，他的耳朵向后倒，颈背处的毛竖立起来，因为这个盒子用罗克索兰语说道“这是什么？”片刻后，他意识到那是他的说话声。他咒骂了一句，冲着这种巫术做了个手势。 </p><p>她说了些话，又摆弄起小盒子。这次它重复了她的声音。她手指着盒子说：“‘录音机’。”她满怀期待地停了下来。 </p><p>她到底在期待什么，这件东西的罗克索兰语名称吗？“我一辈子从未见过这种玩意，我希望自己永远不要再看见。”他说道。她挠了挠头。当她再次让小盒子重复了他刚才说的话后，要不是想到旁边的士兵拿着枪，否则他一定会把这鬼玩意儿扔到墙上。 </p><p>尽管有那些挫折，可他们最终还是在语言沟通上取得了进展。托格兰姆在冒险生涯中零零碎碎地学得了许多语言，这也是尽管他出身卑微、也无人脉，却依然能当上队长的一个原因。这个雌性——托格兰姆听见她名叫希尔达切斯塔——也有天赋，还有那个永远不会忘记的小盒子帮忙。 </p><p>“你们的人为什么攻击我们？”有天她这么问道，当时她已经学会了不少罗克索兰语词汇，能够组织问题了。</p><p>托格兰姆知道自己正在接受审讯，不管她听上去有多么礼貌。他自己也和俘虏们玩过这套把戏。他抽动了耳朵，表示与己无关。他一贯主张直接给出正确的答案，那也是他至今还只是个队长的原因。他说：“为了夺走你们种植和制造的东西，占为己用。为什么所有人都想要征服其他人？” </p><p>“究竟为什么呢？”她喃喃自语，沉默了一小会儿。他直率的回答看来令这个审问的方向进入了死胡同。她再次尝试，“你们的人怎么能够以比光还快的速度行走——我的意思是旅行——同时你们其他的技术却如此简陋？” </p><p>他的毛发因愤慨而直立起来。“它们一点儿都不简陋！我们制造火药，我们铸铁，我们能冶钢，我们有望远镜帮助领航员指引我们在群星中漫游。我们不是蜷缩在洞穴里，或是用弓箭射击彼此的野蛮人。” </p><p>他的一席话自然并非那么简洁易懂。他必须重新说一遍，用详尽累赘的陈述，如同在戏台上表演，让希尔达切斯塔也能听明白。她又挠了挠头，他已经认出这是困惑时的手势。她说：“我们几百年来早已知道你提到过的这些事，但我们认为没有人能以比光还快的速度行走——该死的，我一直说错词，应该是旅行。你们的人是怎么学会那样做的？” </p><p>“我们自己发现了奥秘。”他自豪地说，“我们并不是从其他某个能够星际旅行的种族那儿学到了奥秘，许多种族都是那么干的。” </p><p>“但你们是怎么发现的？”她继续追问。 </p><p>“我怎么知道？我是个士兵。我为什么要关心这些事？谁知道是哪个人发明了火药，又是哪个人发现在铁匠铺里使用风箱能让火焰炙热得足以熔铁？这些事确实发生了，就这样。” </p><p>她那天早早结束了提问。</p><h3 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h3><p>“真丢脸啊，”希尔达·切斯特说，“假如这些愚蠢的外星人多等几年再来地球，我们很可能早已自我毁灭了，压根儿不晓得地球周围有更多适合居住的星球。基督啊，从罗克索兰人说的话来看，他们的种族丝毫不懂得如何制造铁质的星际飞船，也从未仔细思量过这个想法。” </p><p>“除了星际飞船没有返回母星球的时候。”查理·埃贝茨回答说。他的领带塞在口袋里，衣领解开，这都是因为帕萨迪纳炎热难耐的夏日高温，尽管加州理工学院的雅典娜俱乐部里的空调机卖力地运转着，也不管用。虽然这儿有许多工程师和科学家，但是要与外星人沟通的话，他最依赖的还是希尔达·切斯特这样的语言学家。 </p><p>“我自己也不是很明白。”她说，“除了超空间引擎和反重力技术，罗克索兰人其他方面都很落后，几乎可说是原始。宇宙里的其他种族一定也一样，否则早就该有人把它们打垮了。” </p><p>埃贝茨说：“你看过一眼后，就知道超空间引擎有多简单了。研究人员说，任何一个人都有可能在人类历史中的几乎任何一个时刻误打误撞地发现它的基本原理。最有可能的猜测是多数种族确实这样偶尔发现了超空间引擎，而一旦他们有了这一发现，哎呀，他们所有的创造能力自然而然地会都用在如何提升和改进超空间引擎上。” </p><p>“但我们错过了。”希尔达缓缓地说，“于是我们的技术往另一个方向发展了。” </p><p>“说对了。所以罗克索兰人才对电力一无所知，更不用说核能了。关键还在于，就我们目前所知的，超空间引擎和反重力技术并不像电磁学光谱那样有从属性的应用。他们所能做的，只是把物体从这儿迅速地移动到那儿。”</p><p>“在当时应该也够用了。”希尔达说。埃贝茨点点头。地球上如今差不多塞了九十亿人，一半人都在忍饥挨饿。现在，他们突然间有了可以去的地方，也有了去往那里的途径 </p><p>“我想，”埃贝茨沉思道，“我们对于宇宙里的其他种族来说，会是个天大的意外。” </p><p>希尔达过了几秒，才想明白埃贝茨的意思。“如果那是个笑话，那么一点也不好笑。距离上一场攻伐制敌的战争，已有百年的时间。” </p><p>“是啊——战争已经变得太昂贵，也太危险。但是，罗克索兰人或者其他任何同等技术水平的种族会以哪种战斗来对抗我们呢？阿兹特克人和印加人都相当勇猛。在抵御西班牙人时，勇猛又让他们占到多大的便宜？” </p><p>“我希望我们已经在最近的五百年内变得更聪明了。”希尔达说，她照样只吃了一半三明治，她觉得自己不再饿了。 </p><p>“兰西斯克！”资深领航员一瘸一拐地走进他的小囚室时，托格兰姆惊呼道。兰西斯克的人比几个月前登上那艘名不符实的“不摧号”时更细瘦了。他的皮毛上有好几处伤疤，周围长出了白毛，托格兰姆不记得曾见过他身上的这些伤疤。 </p><p>然而，兰西斯克超然、爱打趣的样子并未改变。“你是不是比子弹还坚强，还是地球人觉得不值得杀掉你？” </p><p>“我猜想是后者。他们有那么强大的火力，为什么要担心一个士兵的生死？”托格兰姆苦涩地说道，“我也不晓得你还活着。” </p><p>从始至终都不是我的错，我向你保证。”兰西斯克说，“奥格伦，在我身旁——”他的声音戛然而止。对所有事都保持超然是不可能做到的。 </p><p>“你来这儿做什么？”队长问道，“我并非不乐意见到你，但你是我见到的第一张罗克索兰人面孔，自从——”这时轮到他吞吞吐吐了。 </p><p>“自从我们着陆起。”托格兰姆听到领航员委婉的说法后，松了一口气，点下了脑袋。兰西斯克继续说，“见到你之前，我已经见过另外好几个人。我怀疑我们被允许见面，那样地球人能偷听我们相互之间的谈话。”</p><p>“他们怎么能办到？”托格兰姆刚问出口，就想到了答案。“哦，对了，当然是靠录音机。”他这儿必须用英文词汇，“那么，我们会解决这个问题。” </p><p>他开始用奥雅格语说话，这是罗克索兰人五十年前征服的一颗星球上最广泛使用的语言。“兰西斯克，我们会有什么遭遇？” </p><p>“罗克索兰星球上的人到现在会意识到出事情了吧。”领航员同样以奥雅格语回答。 </p><p>这个回答让托格兰姆乐呵不起来。“舰队失踪有许多原因，”他阴郁地说道，“就算最高统帅派遣了另一支舰队来找我们，他们的运气也不会比我们好。这些该被众神诅咒的地球人拥有太多战争机器。”他停了下来，心情忧郁地喝了一大口伏特加。原住民酿造的有味道的饮料令他反胃，但伏特加让他很喜欢。“他们怎么会有这么多战争机器，我们却一样也没有，我们知道的任何一个种族也没有。他们一定是巫师，把他们的灵魂出卖给了魔鬼，换取知识。” </p><p>兰西斯克抽动了鼻子，表示他并不赞同。“我问过他们之中的一位学者同样的问题。他回复了我一首诗歌，作者是个叫冰雹或雪之类名字的地球人。那首诗讲的是有个人站在岔路口，最终选择走那条较少人走的路<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="参见美国诗人罗伯特·弗罗斯特诗作《未选择的路》（The Road Not Take），诗作名也是本篇小说的题目。">[3]</span></a></sup>。那就是人类干的事。多数种族发现了超空间引擎，遨游于星际。人类从未发现超空间引擎，于是他们对知识的探索走向了另一个方向。” </p><p>“不是的！”托格兰姆回想起那场短暂而可怕的战斗，浑身哆嗦，“那些枪不用重新装弹就能发射出几十枚子弹，火炮装在带盔甲的平台上，平台还可以移动，自己能跟踪目标的火箭……还有我们看不见的东西，地球人都会谈起的东西——能够摧毁一整座城市的炸弹，只需一枚炸弹。” </p><p>“我不知道该不该去相信。”兰西斯克说。 </p><p>“我相信。地球人说起那些炸弹时听起来十分害怕。” </p><p>“好吧，也许是那样。但地球人不单单有厉害的武器。他们有机器能让他们从遥远的地方看见另一个人，并和他交谈；还有机器能为他们做计算；他们有录音机，还有许多相关的东西。从他们说起机器的话语来看，我几乎要相信你的说法，认为他们是巫师——他们确实知道是什么引起了疾病，知道如何治疗，甚至知道如何预防疾病。还有他们的农业，这颗星球比我见过或听说过的任何一颗星球都拥挤得多，然而星球上种植的庄稼足以喂饱所有这些地球人。” </p><p>托格兰姆悲伤地摇摆起耳朵。“这十分不公平。他们拥有所有这些技术，只是因为没有碰巧发现超空间引擎的奥秘。” </p><p>“他们现在拥有了超空间引擎。”兰西斯克提醒他，“多亏了我们。” </p><p>两个罗克索兰人惊骇地看着彼此，异口同声地说道：“我们造了什么孽啊？”</p><hr><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>梅尔是梅丽莎的昵称。<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span>弗雷迪是弗雷德丽卡的昵称。<a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span>参见美国诗人罗伯特·弗罗斯特诗作《未选择的路》（The Road Not Take），诗作名也是本篇小说的题目。<a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">By Harry Turtledove</summary>
    
    
    
    <category term="Daily" scheme="https://www.0co.dev/categories/Daily/"/>
    
    
    <category term="Daily" scheme="https://www.0co.dev/tags/Daily/"/>
    
  </entry>
  
  <entry>
    <title>CS61A-lab03_Q5</title>
    <link href="https://www.0co.dev/CS61A-lab03-Q5/"/>
    <id>https://www.0co.dev/CS61A-lab03-Q5/</id>
    <published>2023-07-26T07:51:39.000Z</published>
    <updated>2023-10-31T10:24:49.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Q5-It’s-Always-a-Good-Prime"><a href="#Q5-It’s-Always-a-Good-Prime" class="headerlink" title="Q5: It’s Always a Good Prime"></a>Q5: It’s Always a Good Prime</h2><blockquote><p>Implement <code>div_by_primes_under</code>, which takes  in an integer <code>n</code> and returns an n-divisibility checker. An <em>n-divisibility-checker</em> is a function that takes in an integer k and returns whether <code>k</code> is divisible by any integers between 2 and <code>n</code>, inclusive. Equivalently, it returns whether <code>k</code> is divisible by any primes less than or equal to <code>n</code>.</p><p>Review the Disc 01 <code>is_prime</code> problem for a reminder about prime numbers.</p><p>You can also choose to do the no lambda version, which is the same problem, just with defining functions with def instead of lambda.</p></blockquote><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution:"></a>Solution:</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">div_by_primes_under</span>(<span class="hljs-params">n</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    &gt;&gt;&gt; div_by_primes_under(10)(11)</span><br><span class="hljs-string">    False</span><br><span class="hljs-string">    &gt;&gt;&gt; div_by_primes_under(10)(121)</span><br><span class="hljs-string">    False</span><br><span class="hljs-string">    &gt;&gt;&gt; div_by_primes_under(10)(12)</span><br><span class="hljs-string">    True</span><br><span class="hljs-string">    &gt;&gt;&gt; div_by_primes_under(5)(1)</span><br><span class="hljs-string">    False</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    checker = <span class="hljs-keyword">lambda</span> x: <span class="hljs-literal">False</span><br>    i = <span class="hljs-number">2</span><br>    <span class="hljs-keyword">while</span> i &lt; n:<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> checker(i):<br>            checker = (<span class="hljs-keyword">lambda</span> f, i: <span class="hljs-keyword">lambda</span> x: x % i == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> f(x))(checker,i)<br>        i = i + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> checker<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">div_by_primes_under_no_lambda</span>(<span class="hljs-params">n</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    &gt;&gt;&gt; div_by_primes_under_no_lambda(10)(11)</span><br><span class="hljs-string">    False</span><br><span class="hljs-string">    &gt;&gt;&gt; div_by_primes_under_no_lambda(10)(121)</span><br><span class="hljs-string">    False</span><br><span class="hljs-string">    &gt;&gt;&gt; div_by_primes_under_no_lambda(10)(12)</span><br><span class="hljs-string">    True</span><br><span class="hljs-string">    &gt;&gt;&gt; div_by_primes_under_no_lambda(5)(1)</span><br><span class="hljs-string">    False</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">checker</span>(<span class="hljs-params">x</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    i = <span class="hljs-number">2</span><br>    <span class="hljs-keyword">while</span> i &lt; n:<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> checker(i):<br>            <span class="hljs-keyword">def</span> <span class="hljs-title function_">outer</span>(<span class="hljs-params">f,i</span>):<br>                <span class="hljs-keyword">def</span> <span class="hljs-title function_">inner</span>(<span class="hljs-params">x</span>):<br>                    <span class="hljs-keyword">return</span> x % i == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> f(x)<br>                <span class="hljs-keyword">return</span> inner<br>            checker = outer(checker, i)<br>        i = i + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> checker<br></code></pre></td></tr></table></figure><h2 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis:"></a>Analysis:</h2><blockquote><p>核心理论依据：如果一个数不能整除以比它小的任何素数，那么这个数就是素数。<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[5种你不知道的素数的判断方法](https://zhuanlan.zhihu.com/p/104314640)">[1]</span></a></sup></p></blockquote><p>要求<code>checker</code>函数实现的功能就是判断<code>k</code>是否能整除以任何一个从<code>2</code>到<code>n</code>的素数，当然也就能同时实现判断一个数是否是素数。</p><p>根据一般想法，我们可以在<code>div_by_primes_under_no_lambda</code>函数里面定义一个<code>normal_checker</code>函数，使它对<code>i</code>从<code>2</code>到<code>n</code>逐个进行判断：满足<code>i</code>是素数且<code>x % i == 0</code>即可。示例如下：<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="[I Heard You Liked Functions... (CS61A作业笔记) ](https://zhuanlan.zhihu.com/p/621748545)">[2]</span></a></sup></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_prime</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;Prime Number Judge&#x27;&#x27;&#x27;</span><br>    i = <span class="hljs-number">2</span><br>    <span class="hljs-keyword">while</span> i * i &lt; x:<br>        <span class="hljs-keyword">if</span> x % i == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        i += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">div_by_primes_under_no_lambda</span>(<span class="hljs-params">n</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">normal_checker</span>(<span class="hljs-params">x</span>):<br>        i = <span class="hljs-number">2</span><br>        <span class="hljs-keyword">while</span> i &lt;= n:<br>            <span class="hljs-keyword">if</span> is_prime(i) <span class="hljs-keyword">and</span> x % i == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>            i += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> normal_checker<br></code></pre></td></tr></table></figure><p>理解此种一般做法之后，再来对官网给出的答案进行分析：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">div_by_primes_under_no_lambda</span>(<span class="hljs-params">n</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    &gt;&gt;&gt; div_by_primes_under_no_lambda(10)(11)</span><br><span class="hljs-string">    False</span><br><span class="hljs-string">    &gt;&gt;&gt; div_by_primes_under_no_lambda(10)(121)</span><br><span class="hljs-string">    False</span><br><span class="hljs-string">    &gt;&gt;&gt; div_by_primes_under_no_lambda(10)(12)</span><br><span class="hljs-string">    True</span><br><span class="hljs-string">    &gt;&gt;&gt; div_by_primes_under_no_lambda(5)(1)</span><br><span class="hljs-string">    False</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">checker</span>(<span class="hljs-params">x</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    i = <span class="hljs-number">2</span><br>    <span class="hljs-keyword">while</span> i &lt; n:<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> checker(i):<br>            <span class="hljs-keyword">def</span> <span class="hljs-title function_">outer</span>(<span class="hljs-params">f,i</span>):<br>                <span class="hljs-keyword">def</span> <span class="hljs-title function_">inner</span>(<span class="hljs-params">x</span>):<br>                    <span class="hljs-keyword">return</span> x % i == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> f(x)<br>                <span class="hljs-keyword">return</span> inner<br>            checker = outer(checker, i)<br>        i = i + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> checker<br></code></pre></td></tr></table></figure><p><code>i</code>的初始值为2，是素数，此时<code>check(2)</code>的值为<code>False</code>，直接进入<code>while</code>循环，<code>if</code>条件满足，定义嵌套函数<code>outer</code>和<code>inner</code>，接着<code>checker</code>函数被更新为<code>outer(checker, i)</code>的返回值，即<code>return x % 2 == 0 or False</code>，现在<code>checker</code>函数就能判断一个数是否能整除<code>2</code>。</p><p><code>i</code>更新为<code>3</code>后，进入下一次循环，此时<code>if</code>语句中的<code>checker</code>函数返回值依旧是<code>return x % 2 == 0 or False</code>，刚好能判断3能否整除以任何一个比他小的任何素数(也就是2)，判断出3是素数。<code>if</code>条件满足，更新<code>checker</code>函数，使之能判断<code>x</code>是否能整除以素数<code>3</code>。注意，此时的<code>checker</code>函数返回值为<code>return x % 3 == 0 or f(x)</code>，这里的<code>f(x)</code>是<code>i=2</code>时的<code>checker</code>函数，也就等价于<code>return x % 3 == 0 or False</code>，也就是说，此时<code>checker</code>的返回语句等价于<code>return x % 3 == 0 or x % 2 == 0 or False</code>。</p><p>以此类推：<code>i=4</code>不是素数，不需要更新<code>checker</code>函数直接进入下次循环，<code>i=5</code>是素数，更新<code>checker</code>函数直到<code>i=n</code>，此时<code>checker</code>函数也更新为能够判断能否整除以<code>2 ~ n</code>的任何素数，即<code>return x % k == 0 or...or...or...False</code>(k是某个整数），是以<code>or</code>连接的一串整除判断语句，每一个<code>f(x)</code>都继承了上一轮循环的<code>checker</code>函数的返回值。</p><p>同理，简写的<code>lambda</code>表达式版函数也可以理解了。</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/104314640">5种你不知道的素数的判断方法</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/621748545">I Heard You Liked Functions… (CS61A作业笔记) </a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">Short analysis about div_by_primes_under in lab03</summary>
    
    
    
    <category term="Major" scheme="https://www.0co.dev/categories/Major/"/>
    
    <category term="CS61A" scheme="https://www.0co.dev/categories/Major/CS61A/"/>
    
    
    <category term="CS61A" scheme="https://www.0co.dev/tags/CS61A/"/>
    
  </entry>
  
  <entry>
    <title>CS61A-Reference</title>
    <link href="https://www.0co.dev/CS61A-Reference/"/>
    <id>https://www.0co.dev/CS61A-Reference/</id>
    <published>2023-07-19T09:18:41.000Z</published>
    <updated>2023-10-31T03:06:19.000Z</updated>
    
    <content type="html"><![CDATA[<div class="note note-success">            <p>Composing Programs by <u><a href="http://www.denero.org/">John DeNero</a></u>, based on the textbook <u><a href="http://mitpress.mit.edu/sicp/">Structure and Interpretation of Computer Programs</a></u> by Harold Abelson and Gerald Jay Sussman, is licensed under a <u><a href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 Unported License</a></u>.</p>          </div><h1 id="Chapter-1-Building-Abstractions-with-Functions"><a href="#Chapter-1-Building-Abstractions-with-Functions" class="headerlink" title="Chapter 1: Building Abstractions with Functions"></a>Chapter 1: Building Abstractions with Functions</h1><h2 id="1-1-Getting-Started"><a href="#1-1-Getting-Started" class="headerlink" title="1.1  Getting Started"></a>1.1  Getting Started</h2><p>Computer science is a tremendously broad academic discipline. The areas of globally distributed systems, artificial intelligence, robotics, graphics, security, scientific computing, computer architecture, and dozens of emerging sub-fields all expand with new techniques and discoveries every year. The rapid progress of computer science has left few aspects of human life unaffected. Commerce, communication, science, art, leisure, and politics have all been reinvented as computational domains.</p><p>The high productivity of computer science is only possible because the discipline is built upon an elegant and powerful set of fundamental ideas. All computing begins with representing information, specifying logic to process it, and designing abstractions that manage the complexity of that logic. Mastering these fundamentals will require us to understand precisely how computers interpret computer programs and carry out computational processes.</p><p>These fundamental ideas have long been taught using the classic textbook <em>Structure and Interpretation of Computer Programs</em> (<a href="http://mitpress.mit.edu/sicp">SICP</a>) by Harold Abelson and Gerald Jay Sussman with Julie Sussman. This text borrows heavily from that textbook, which the original authors have kindly licensed for adaptation and reuse under a Creative Commons license. These notes are published under the <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">Creative Commons attribution non-commericial share-alike license version 3</a>.</p><h3 id="1-1-1-Programming-in-Python"><a href="#1-1-1-Programming-in-Python" class="headerlink" title="1.1.1  Programming in Python"></a>1.1.1  Programming in Python</h3><blockquote><p>A language isn’t something you learn so much as something you join.</p><p>—<a href="http://arikaokrent.com/">Arika Okrent</a></p></blockquote><p>In order to define computational processes, we need a programming language; preferably one that many humans and a great variety of computers can all understand. In this text, we will work primarily with the <a href="http://docs.python.org/py3k/">Python</a> language.</p><p>Python is a widely used programming language that has recruited enthusiasts from many professions: web programmers, game engineers, scientists, academics, and even designers of new programming languages. When you learn Python, you join a million-person-strong community of developers. Developer communities are tremendously important institutions: members help each other solve problems, share their projects and experiences, and collectively develop software and tools. Dedicated members often achieve celebrity and widespread esteem for their contributions.</p><p>The Python language itself is the product of a <a href="http://www.python.org/psf/members/">large volunteer community</a> that prides itself on the <a href="http://python.org/community/diversity/">diversity</a> of its contributors. The language was conceived and first implemented by <a href="http://en.wikipedia.org/wiki/Guido_van_Rossum">Guido van Rossum</a> in the late 1980’s. The first chapter of his <a href="http://docs.python.org/py3k/tutorial/appetite.html">Python 3 Tutorial</a> explains why Python is so popular, among the many languages available today.</p><p>Python excels as an instructional language because, throughout its history, Python’s developers have emphasized the human interpretability of Python code, reinforced by the <a href="http://www.python.org/dev/peps/pep-0020/">Zen of Python</a> guiding principles of beauty, simplicity, and readability. Python is particularly appropriate for this text because its broad set of features support a variety of different programming styles, which we will explore. While there is no single way to program in Python, there are a set of conventions shared across the developer community that facilitate reading, understanding, and extending existing programs. Python’s combination of great flexibility and accessibility allows students to explore many programming paradigms, and then apply their newly acquired knowledge to thousands of <a href="http://pypi.python.org/pypi">ongoing projects</a>.</p><p>These notes maintain the spirit of <a href="http://mitpress.mit.edu/sicp">SICP</a> by introducing the features of Python in step with techniques for abstraction and a rigorous model of computation. In addition, these notes provide a practical introduction to Python programming, including some advanced language features and illustrative examples. Increasing your facility with Python should come naturally as you progress through the text.</p><p>The best way to get started programming in Python is to interact with the interpreter directly. This section describes how to install Python 3, initiate an interactive session with the interpreter, and start programming.</p><h3 id="1-1-2-Installing-Python-3"><a href="#1-1-2-Installing-Python-3" class="headerlink" title="1.1.2  Installing Python 3"></a>1.1.2  Installing Python 3</h3><p>As with all great software, Python has many versions. This text will use the most recent stable version of Python 3. Many computers have older versions of Python installed already, such as Python 2.7, but those will not match the descriptions in this text. You should be able to use any computer, but expect to install Python 3. (Don’t worry, Python is free.)</p><p>You can download Python 3 from the Python downloads page by clicking on the version that begins with 3 (not 2). Follow the instructions of the installer to complete installation.</p><p>For further guidance, try these video tutorials on <a href="http://www.youtube.com/watch?v=54-wuFsPi0w">Windows installation</a> and <a href="http://www.youtube.com/watch?v=smHuBHxJdK8">Mac installation</a> of Python 3, created by Julia Oh.</p><h3 id="1-1-3-Interactive-Sessions"><a href="#1-1-3-Interactive-Sessions" class="headerlink" title="1.1.3  Interactive Sessions"></a>1.1.3  Interactive Sessions</h3><p>In an interactive Python session, you type some Python <em>code</em> after the <em>prompt</em>, <code>&gt;&gt;&gt;</code>. The Python <em>interpreter</em> reads and executes what you type, carrying out your various commands.</p><p>To start an interactive session, run the Python 3 application. Type <code>python3</code> at a terminal prompt (Mac&#x2F;Unix&#x2F;Linux) or open the Python 3 application in Windows.</p><p>If you see the Python prompt, <code>&gt;&gt;&gt;</code>, then you have successfully started an interactive session. These notes depict example interactions using the prompt, followed by some input.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-number">2</span> + <span class="hljs-number">2</span></span><br>4<br></code></pre></td></tr></table></figure><p><strong>Interactive controls.</strong> Each session keeps a history of what you have typed. To access that history, press <code>&lt;Control&gt;-P</code> (previous) and <code>&lt;Control&gt;-N</code> (next). <code>&lt;Control&gt;-D</code> exits a session, which discards this history. Up and down arrows also cycle through history on some systems.</p><h3 id="1-1-4-First-Example"><a href="#1-1-4-First-Example" class="headerlink" title="1.1.4  First Example"></a>1.1.4  First Example</h3><blockquote><p>And, as imagination bodies forth</p><p>The forms of things to unknown, and the poet’s pen</p><p>Turns them to shapes, and gives to airy nothing</p><p>A local habitation and a name.</p><p>—William Shakespeare, A Midsummer-Night’s Dream</p></blockquote><p>To give Python a proper introduction, we will begin with an example that uses several language features. In the next section, we will start from scratch and build up the language piece by piece. Think of this section as a sneak preview of features to come.</p><p>Python has built-in support for a wide range of common programming activities, such as manipulating text, displaying graphics, and communicating over the Internet. The line of Python code</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">from</span> urllib.request <span class="hljs-keyword">import</span> urlopen</span><br></code></pre></td></tr></table></figure><p>is an <code>import</code> statement that loads functionality for accessing data on the Internet. In particular, it makes available a function called <code>urlopen</code>, which can access the content at a uniform resource locator (URL), a location of something on the Internet.</p><p><strong>Statements &amp; Expressions</strong>. Python code consists of expressions and statements. Broadly, computer programs consist of instructions to either</p><ol><li>Compute some value</li><li>Carry out some action</li></ol><p>Statements typically describe actions. When the Python interpreter executes a statement, it carries out the corresponding action. On the other hand, expressions typically describe computations. When Python evaluates an expression, it computes the value of that expression. This chapter introduces several types of statements and expressions.</p><p>The assignment statement</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl">&gt;&gt;&gt; <span class="hljs-variable">shakespeare</span> = <span class="hljs-function"><span class="hljs-title">urlopen</span>(<span class="hljs-string">&#x27;http://composingprograms.com/shakespeare.txt&#x27;</span>)</span><br></code></pre></td></tr></table></figure><p>associates the name <code>shakespeare</code> with the value of the expression that follows <code>=</code>. That expression applies the <code>urlopen</code> function to a URL that contains the complete text of William Shakespeare’s 37 plays, all in a single text document.</p><p><strong>Functions</strong>. Functions encapsulate logic that manipulates data. <code>urlopen</code> is a function. A web address is a piece of data, and the text of Shakespeare’s plays is another. The process by which the former leads to the latter may be complex, but we can apply that process using only a simple expression because that complexity is tucked away within a function. Functions are the primary topic of this chapter.</p><p>Another assignment statement</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lisp">&gt;&gt;&gt; words = set(<span class="hljs-name">shakespeare</span>.read().decode().split())<br></code></pre></td></tr></table></figure><p>associates the name <code>words</code> to the set of all unique words that appear in Shakespeare’s plays, all 33,721 of them. The chain of commands to <code>read</code>, <code>decode</code>, and <code>split</code>, each operate on an intermediate computational entity: we <code>read</code> the data from the opened URL, then <code>decode</code> the data into text, and finally <code>split</code> the text into words. All of those words are placed in a <code>set</code>.</p><p><strong>Objects</strong>. A <code>set</code> is a type of object, one that supports set operations like computing intersections and membership. An object seamlessly bundles together data and the logic that manipulates that data, in a way that manages the complexity of both. Objects are the primary topic of Chapter 2. Finally, the expression</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs prolog">&gt;&gt;&gt; &#123;w for w in words if len(w) == <span class="hljs-number">6</span> and w[::-<span class="hljs-number">1</span>] in words&#125;<br>&#123;<span class="hljs-string">&#x27;redder&#x27;</span>, <span class="hljs-string">&#x27;drawer&#x27;</span>, <span class="hljs-string">&#x27;reward&#x27;</span>, <span class="hljs-string">&#x27;diaper&#x27;</span>, <span class="hljs-string">&#x27;repaid&#x27;</span>&#125;<br></code></pre></td></tr></table></figure><p>is a compound expression that evaluates to the set of all Shakespearian words that are simultaneously a word spelled in reverse. The cryptic notation <code>w[::-1]</code> enumerates each letter in a word, but the <code>-1</code> dictates to step backwards. When you enter an expression in an interactive session, Python prints its value on the following line.</p><p><strong>Interpreters</strong>. Evaluating compound expressions requires a precise procedure that interprets code in a predictable way. A program that implements such a procedure, evaluating compound expressions, is called an interpreter. The design and implementation of interpreters is the primary topic of Chapter 3.</p><p>When compared with other computer programs, interpreters for programming languages are unique in their generality. Python was not designed with Shakespeare in mind. However, its great flexibility allowed us to process a large amount of text with only a few statements and expressions.</p><p>In the end, we will find that all of these core concepts are closely related: functions are objects, objects are functions, and interpreters are instances of both. However, developing a clear understanding of each of these concepts and their role in organizing code is critical to mastering the art of programming.</p><h3 id="1-1-5-Errors"><a href="#1-1-5-Errors" class="headerlink" title="1.1.5  Errors"></a>1.1.5  Errors</h3><p>Python is waiting for your command. You are encouraged to experiment with the language, even though you may not yet know its full vocabulary and structure. However, be prepared for errors. While computers are tremendously fast and flexible, they are also extremely rigid. The nature of computers is described in <a href="http://web.stanford.edu/class/cs101/code-1-introduction.html">Stanford’s introductory course</a> as</p><blockquote><p>The fundamental equation of computers is:</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">computer</span> = powerful + stupid<br></code></pre></td></tr></table></figure><p>Computers are very powerful, looking at volumes of data very quickly. Computers can perform billions of operations per second, where each operation is pretty simple.</p><p>Computers are also shockingly stupid and fragile. The operations that they can do are extremely rigid, simple, and mechanical. The computer lacks anything like real insight … it’s nothing like the HAL 9000 from the movies. If nothing else, you should not be intimidated by the computer as if it’s some sort of brain. It’s very mechanical underneath it all.</p><p>Programming is about a person using their real insight to build something useful, constructed out of these teeny, simple little operations that the computer can do.</p><p>—Francisco Cai and Nick Parlante, Stanford CS101</p></blockquote><p>The rigidity of computers will immediately become apparent as you experiment with the Python interpreter: even the smallest spelling and formatting changes will cause unexpected output and errors.</p><p>Learning to interpret errors and diagnose the cause of unexpected errors is called <em>debugging</em>. Some guiding principles of debugging are:</p><ol><li><strong>Test incrementally</strong>: Every well-written program is composed of small, modular components that can be tested individually. Try out everything you write as soon as possible to identify problems early and gain confidence in your components.</li><li><strong>Isolate errors</strong>: An error in the output of a statement can typically be attributed to a particular modular component. When trying to diagnose a problem, trace the error to the smallest fragment of code you can before trying to correct it.</li><li><strong>Check your assumptions</strong>: Interpreters do carry out your instructions to the letter — no more and no less. Their output is unexpected when the behavior of some code does not match what the programmer believes (or assumes) that behavior to be. Know your assumptions, then focus your debugging effort on verifying that your assumptions actually hold.</li><li><strong>Consult others</strong>: You are not alone! If you don’t understand an error message, ask a friend, instructor, or search engine. If you have isolated an error, but can’t figure out how to correct it, ask someone else to take a look. A lot of valuable programming knowledge is shared in the process of group problem solving.</li></ol><p>Incremental testing, modular design, precise assumptions, and teamwork are themes that persist throughout this text. Hopefully, they will also persist throughout your computer science career.</p><h2 id="1-2-Elements-of-Programming"><a href="#1-2-Elements-of-Programming" class="headerlink" title="1.2  Elements of Programming"></a>1.2  Elements of Programming</h2><p>A programming language is more than just a means for instructing a computer to perform tasks. The language also serves as a framework within which we organize our ideas about computational processes. Programs serve to communicate those ideas among the members of a programming community. Thus, programs must be written for people to read, and only incidentally for machines to execute.</p><p>When we describe a language, we should pay particular attention to the means that the language provides for combining simple ideas to form more complex ideas. Every powerful language has three such mechanisms:</p><ul><li><strong>primitive expressions and statements</strong>, which represent the simplest building blocks that the language provides,</li><li><strong>means of combination</strong>, by which compound elements are built from simpler ones, and</li><li><strong>means of abstraction</strong>, by which compound elements can be named and manipulated as units.</li></ul><p>In programming, we deal with two kinds of elements: functions and data. (Soon we will discover that they are really not so distinct.) Informally, data is stuff that we want to manipulate, and functions describe the rules for manipulating the data. Thus, any powerful programming language should be able to describe primitive data and primitive functions, as well as have some methods for combining and abstracting both functions and data.</p><h3 id="1-2-1-Expressions"><a href="#1-2-1-Expressions" class="headerlink" title="1.2.1  Expressions"></a>1.2.1  Expressions</h3><p>Having experimented with the full Python interpreter in the previous section, we now start anew, methodically developing the Python language element by element. Be patient if the examples seem simplistic — more exciting material is soon to come.</p><p>We begin with primitive expressions. One kind of primitive expression is a number. More precisely, the expression that you type consists of the numerals that represent the number in base 10.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-number">42</span></span><br>42<br></code></pre></td></tr></table></figure><p>Expressions representing numbers may be combined with mathematical operators to form a compound expression, which the interpreter will evaluate:</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">-<span class="hljs-number">1</span> - -<span class="hljs-number">1</span></span><br>0<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-number">1</span>/<span class="hljs-number">2</span> + <span class="hljs-number">1</span>/<span class="hljs-number">4</span> + <span class="hljs-number">1</span>/<span class="hljs-number">8</span> + <span class="hljs-number">1</span>/<span class="hljs-number">16</span> + <span class="hljs-number">1</span>/<span class="hljs-number">32</span> + <span class="hljs-number">1</span>/<span class="hljs-number">64</span> + <span class="hljs-number">1</span>/<span class="hljs-number">128</span></span><br>0.9921875<br></code></pre></td></tr></table></figure><p>These mathematical expressions use <em>infix</em> notation, where the <em>operator</em> (e.g., <code>+</code>, <code>-</code>, <code>*</code>, or <code>/</code>) appears in between the <em>operands</em> (numbers). Python includes many ways to form compound expressions. Rather than attempt to enumerate them all immediately, we will introduce new expression forms as we go, along with the language features that they support.</p><h3 id="1-2-2-Call-Expressions"><a href="#1-2-2-Call-Expressions" class="headerlink" title="1.2.2  Call Expressions"></a>1.2.2  Call Expressions</h3><p>The most important kind of compound expression is a <em>call expression</em>, which applies a function to some arguments. Recall from algebra that the mathematical notion of a function is a mapping from some input arguments to an output value. For instance, the <code>max</code> function maps its inputs to a single output, which is the largest of the inputs. The way in which Python expresses function application is the same as in conventional mathematics.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">max</span>(<span class="hljs-number">7.5</span>, <span class="hljs-number">9.5</span>)</span><br>9.5<br></code></pre></td></tr></table></figure><p>This call expression has subexpressions: the <em>operator</em> is an expression that precedes parentheses, which enclose a comma-delimited list of <em>operand</em> expressions.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191721562.png"></p><p>The operator specifies a <em>function</em>. When this call expression is evaluated, we say that the function <code>max</code> is <em>called</em> with <em>arguments</em> 7.5 and 9.5, and <em>returns</em> a <em>value</em> of 9.5.</p><p>The order of the arguments in a call expression matters. For instance, the function <code>pow</code> raises its first argument to the power of its second argument.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">pow</span>(<span class="hljs-number">100</span>, <span class="hljs-number">2</span>)</span><br>10000<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">100</span>)</span><br>1267650600228229401496703205376<br></code></pre></td></tr></table></figure><p>Function notation has three principal advantages over the mathematical convention of infix notation. First, functions may take an arbitrary number of arguments:</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">max</span>(<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, -<span class="hljs-number">4</span>)</span><br>3<br></code></pre></td></tr></table></figure><p>No ambiguity can arise, because the function name always precedes its arguments.</p><p>Second, function notation extends in a straightforward way to <em>nested</em> expressions, where the elements are themselves compound expressions. In nested call expressions, unlike compound infix expressions, the structure of the nesting is entirely explicit in the parentheses.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">max</span>(<span class="hljs-built_in">min</span>(<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>), <span class="hljs-built_in">min</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>), -<span class="hljs-number">4</span>))</span><br>-2<br></code></pre></td></tr></table></figure><p>There is no limit (in principle) to the depth of such nesting and to the overall complexity of the expressions that the Python interpreter can evaluate. However, humans quickly get confused by multi-level nesting. An important role for you as a programmer is to structure expressions so that they remain interpretable by yourself, your programming partners, and other people who may read your expressions in the future.</p><p>Third, mathematical notation has a great variety of forms: multiplication appears between terms, exponents appear as superscripts, division as a horizontal bar, and a square root as a roof with slanted siding. Some of this notation is very hard to type! However, all of this complexity can be unified via the notation of call expressions. While Python supports common mathematical operators using infix notation (like <code>+</code> and <code>-</code>), any operator can be expressed as a function with a name.</p><h3 id="1-2-3-Importing-Library-Functions"><a href="#1-2-3-Importing-Library-Functions" class="headerlink" title="1.2.3  Importing Library Functions"></a>1.2.3  Importing Library Functions</h3><p>Python defines a very large number of functions, including the operator functions mentioned in the preceding section, but does not make all of their names available by default. Instead, it organizes the functions and other quantities that it knows about into modules, which together comprise the Python Library. To use these elements, one imports them. For example, the <code>math</code> module provides a variety of familiar mathematical functions:</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> sqrt</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">sqrt(<span class="hljs-number">256</span>)</span><br>16.0<br></code></pre></td></tr></table></figure><p>and the <code>operator</code> module provides access to functions corresponding to infix operators:</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> add, sub, mul</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">add(<span class="hljs-number">14</span>, <span class="hljs-number">28</span>)</span><br>42<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">sub(<span class="hljs-number">100</span>, mul(<span class="hljs-number">7</span>, add(<span class="hljs-number">8</span>, <span class="hljs-number">4</span>)))</span><br>16<br></code></pre></td></tr></table></figure><p>An <code>import</code> statement designates a module name (e.g., <code>operator</code> or <code>math</code>), and then lists the named attributes of that module to import (e.g., <code>sqrt</code>). Once a function is imported, it can be called multiple times.</p><p>There is no difference between using these operator functions (e.g., <code>add</code>) and the operator symbols themselves (e.g., <code>+</code>). Conventionally, most programmers use symbols and infix notation to express simple arithmetic.</p><p>The <a href="http://docs.python.org/py3k/library/index.html">Python 3 Library Docs</a> list the functions defined by each module, such as the <a href="http://docs.python.org/py3k/library/math.html">math module</a>. However, this documentation is written for developers who know the whole language well. For now, you may find that experimenting with a function tells you more about its behavior than reading the documentation. As you become familiar with the Python language and vocabulary, this documentation will become a valuable reference source.</p><h3 id="1-2-4-Names-and-the-Environment"><a href="#1-2-4-Names-and-the-Environment" class="headerlink" title="1.2.4  Names and the Environment"></a>1.2.4  Names and the Environment</h3><p>A critical aspect of a programming language is the means it provides for using names to refer to computational objects. If a value has been given a name, we say that the name <em>binds</em> to the value.</p><p>In Python, we can establish new bindings using the assignment statement, which contains a name to the left of <code>=</code> and a value to the right:</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">radius = <span class="hljs-number">10</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">radius</span><br>10<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-number">2</span> * radius</span><br>20<br></code></pre></td></tr></table></figure><p>Names are also bound via <code>import</code> statements.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> pi</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">pi * <span class="hljs-number">71</span> / <span class="hljs-number">223</span></span><br>1.0002380197528042<br></code></pre></td></tr></table></figure><p>The <code>=</code> symbol is called the <em>assignment</em> operator in Python (and many other languages). Assignment is our simplest means of <em>abstraction</em>, for it allows us to use simple names to refer to the results of compound operations, such as the <code>area</code> computed above. In this way, complex programs are constructed by building, step by step, computational objects of increasing complexity.</p><p>The possibility of binding names to values and later retrieving those values by name means that the interpreter must maintain some sort of memory that keeps track of the names, values, and bindings. This memory is called an <em>environment</em>.</p><p>Names can also be bound to functions. For instance, the name <code>max</code> is bound to the max function we have been using. Functions, unlike numbers, are tricky to render as text, so Python prints an identifying description instead, when asked to describe a function:</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs fortran">&gt;&gt;&gt; <span class="hljs-built_in">max</span><br>&lt;built-<span class="hljs-keyword">in</span> <span class="hljs-function"><span class="hljs-keyword">function</span></span> <span class="hljs-built_in">max</span>&gt;<br></code></pre></td></tr></table></figure><p>We can use assignment statements to give new names to existing functions.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">f = <span class="hljs-built_in">max</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">f</span><br>&lt;built-in function max&gt;<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">f(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>)</span><br>4<br></code></pre></td></tr></table></figure><p>And successive assignment statements can rebind a name to a new value.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">f = <span class="hljs-number">2</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">f</span><br>2<br></code></pre></td></tr></table></figure><p>In Python, names are often called <em>variable names</em> or <em>variables</em> because they can be bound to different values in the course of executing a program. When a name is bound to a new value through assignment, it is no longer bound to any previous value. One can even bind built-in names to new values.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">max</span> = <span class="hljs-number">5</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">max</span></span><br>5<br></code></pre></td></tr></table></figure><p>After assigning <code>max</code> to 5, the name <code>max</code> is no longer bound to a function, and so attempting to call <code>max(2, 3, 4)</code> will cause an error.</p><p>When executing an assignment statement, Python evaluates the expression to the right of <code>=</code> before changing the binding to the name on the left. Therefore, one can refer to a name in right-side expression, even if it is the name to be bound by the assignment statement.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">x = <span class="hljs-number">2</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">x = x + <span class="hljs-number">1</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">x</span><br>3<br></code></pre></td></tr></table></figure><p>We can also assign multiple values to multiple names in a single statement, where names on the left of <code>=</code> and expressions on the right of <code>=</code> are separated by commas.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">area, circumference = pi * radius * radius, <span class="hljs-number">2</span> * pi * radius</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">area</span><br>314.1592653589793<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">circumference</span><br>62.83185307179586<br></code></pre></td></tr></table></figure><p>Changing the value of one name does not affect other names. Below, even though the name <code>area</code> was bound to a value defined originally in terms of <code>radius</code>, the value of <code>area</code> has not changed. Updating the value of <code>area</code> requires another assignment statement.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">radius = <span class="hljs-number">11</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">area</span><br>314.1592653589793<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">area = pi * radius * radius</span><br>380.132711084365<br></code></pre></td></tr></table></figure><p>With multiple assignment, <em>all</em> expressions to the right of <code>=</code> are evaluated before <em>any</em> names to the left are bound to those values. As a result of this rule, swapping the values bound to two names can be performed in a single statement.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">x, y = <span class="hljs-number">3</span>, <span class="hljs-number">4.5</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">y, x = x, y</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">x</span><br>4.5<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">y</span><br>3<br></code></pre></td></tr></table></figure><h3 id="1-2-5-Evaluating-Nested-Expressions"><a href="#1-2-5-Evaluating-Nested-Expressions" class="headerlink" title="1.2.5  Evaluating Nested Expressions"></a>1.2.5  Evaluating Nested Expressions</h3><p>One of our goals in this chapter is to isolate issues about thinking procedurally. As a case in point, let us consider that, in evaluating nested call expressions, the interpreter is itself following a procedure.</p><p>To evaluate a call expression, Python will do the following:</p><ol><li>Evaluate the operator and operand subexpressions, then</li><li>Apply the function that is the value of the operator subexpression to the arguments that are the values of the operand subexpressions.</li></ol><p>Even this simple procedure illustrates some important points about processes in general. The first step dictates that in order to accomplish the evaluation process for a call expression we must first evaluate other expressions. Thus, the evaluation procedure is <em>recursive</em> in nature; that is, it includes, as one of its steps, the need to invoke the rule itself.</p><p>For example, evaluating</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs lisp">&gt;&gt;&gt; sub(<span class="hljs-name">pow</span>(<span class="hljs-number">2</span>, add(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>)), pow(<span class="hljs-number">2</span>, <span class="hljs-number">5</span>))<br><span class="hljs-number">2016</span><br></code></pre></td></tr></table></figure><p>requires that this evaluation procedure be applied four times. If we draw each expression that we evaluate, we can visualize the hierarchical structure of this process.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191722041.png"></p><p>This illustration is called an <em>expression tree</em>. In computer science, trees conventionally grow from the top down. The objects at each point in a tree are called nodes; in this case, they are expressions paired with their values.</p><p>Evaluating its root, the full expression at the top, requires first evaluating the branches that are its subexpressions. The leaf expressions (that is, nodes with no branches stemming from them) represent either functions or numbers. The interior nodes have two parts: the call expression to which our evaluation rule is applied, and the result of that expression. Viewing evaluation in terms of this tree, we can imagine that the values of the operands percolate upward, starting from the terminal nodes and then combining at higher and higher levels.</p><p>Next, observe that the repeated application of the first step brings us to the point where we need to evaluate, not call expressions, but primitive expressions such as numerals (e.g., 2) and names (e.g., <code>add</code>). We take care of the primitive cases by stipulating that</p><ul><li>A numeral evaluates to the number it names,</li><li>A name evaluates to the value associated with that name in the current environment.</li></ul><p>Notice the important role of an environment in determining the meaning of the symbols in expressions. In Python, it is meaningless to speak of the value of an expression such as</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">&gt;&gt;&gt; <span class="hljs-keyword">add</span>(<span class="hljs-keyword">x</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p>without specifying any information about the environment that would provide a meaning for the name <code>x</code> (or even for the name <code>add</code>). Environments provide the context in which evaluation takes place, which plays an important role in our understanding of program execution.</p><p>This evaluation procedure does not suffice to evaluate all Python code, only call expressions, numerals, and names. For instance, it does not handle assignment statements. Executing</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">x = <span class="hljs-number">3</span></span><br></code></pre></td></tr></table></figure><p>does not return a value nor evaluate a function on some arguments, since the purpose of assignment is instead to bind a name to a value. In general, statements are not evaluated but <em>executed</em>; they do not produce a value but instead make some change. Each type of expression or statement has its own evaluation or execution procedure.</p><p>A pedantic note: when we say that “a numeral evaluates to a number,” we actually mean that the Python interpreter evaluates a numeral to a number. It is the interpreter which endows meaning to the programming language. Given that the interpreter is a fixed program that always behaves consistently, we can say that numerals (and expressions) themselves evaluate to values in the context of Python programs.</p><h3 id="1-2-6-The-Non-Pure-Print-Function"><a href="#1-2-6-The-Non-Pure-Print-Function" class="headerlink" title="1.2.6  The Non-Pure Print Function"></a>1.2.6  The Non-Pure Print Function</h3><p>Throughout this text, we will distinguish between two types of functions.</p><p><strong>Pure functions.</strong> Functions have some input (their arguments) and return some output (the result of applying them). The built-in function</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">abs</span>(-<span class="hljs-number">2</span>)</span><br>2<br></code></pre></td></tr></table></figure><p>can be depicted as a small machine that takes input and produces output.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191722109.png"></p><p>The function <code>abs</code> is <em>pure</em>. Pure functions have the property that applying them has no effects beyond returning a value. Moreover, a pure function must always return the same value when called twice with the same arguments.</p><p><strong>Non-pure functions.</strong> In addition to returning a value, applying a non-pure function can generate <em>side effects</em>, which make some change to the state of the interpreter or computer. A common side effect is to generate additional output beyond the return value, using the <code>print</code> function.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">print</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)</span><br>1 2 3<br></code></pre></td></tr></table></figure><p>While <code>print</code> and <code>abs</code> may appear to be similar in these examples, they work in fundamentally different ways. The value that <code>print</code> returns is always <code>None</code>, a special Python value that represents nothing. The interactive Python interpreter does not automatically print the value <code>None</code>. In the case of <code>print</code>, the function itself is printing output as a side effect of being called.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191723757.png"></p><p>A nested expression of calls to <code>print</code> highlights the non-pure character of the function.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">print</span>(<span class="hljs-built_in">print</span>(<span class="hljs-number">1</span>), <span class="hljs-built_in">print</span>(<span class="hljs-number">2</span>))<br><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-literal">None</span> <span class="hljs-literal">None</span><br></code></pre></td></tr></table></figure><p>If you find this output to be unexpected, draw an expression tree to clarify why evaluating this expression produces this peculiar output.</p><p>Be careful with <code>print</code>! The fact that it returns <code>None</code> means that it <em>should not</em> be the expression in an assignment statement.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">two = <span class="hljs-built_in">print</span>(<span class="hljs-number">2</span>)</span><br>2<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">print</span>(two)</span><br>None<br></code></pre></td></tr></table></figure><p>Pure functions are restricted in that they cannot have side effects or change behavior over time. Imposing these restrictions yields substantial benefits. First, pure functions can be composed more reliably into compound call expressions. We can see in the non-pure function example above that <code>print</code> does not return a useful result when used in an operand expression. On the other hand, we have seen that functions such as <code>max</code>, <code>pow</code> and <code>sqrt</code> can be used effectively in nested expressions.</p><p>Second, pure functions tend to be simpler to test. A list of arguments will always lead to the same return value, which can be compared to the expected return value. Testing is discussed in more detail later in this chapter.</p><p>Third, Chapter 4 will illustrate that pure functions are essential for writing <em>concurrent</em> programs, in which multiple call expressions may be evaluated simultaneously.</p><p>By contrast, Chapter 2 investigates a range of non-pure functions and describes their uses.</p><p>For these reasons, we concentrate heavily on creating and using pure functions in the remainder of this chapter. The <code>print</code> function is only used so that we can see the intermediate results of computations.</p><h2 id="1-3-Defining-New-Functions"><a href="#1-3-Defining-New-Functions" class="headerlink" title="1.3  Defining New Functions"></a>1.3  Defining New Functions</h2><p>We have identified in Python some of the elements that must appear in any powerful programming language:</p><ol><li>Numbers and arithmetic operations are <em>primitive</em> built-in data values and functions.</li><li>Nested function application provides a means of <em>combining</em> operations.</li><li>Binding names to values provides a limited means of <em>abstraction</em>.</li></ol><p>Now we will learn about <em>function definitions</em>, a much more powerful abstraction technique by which a name can be bound to compound operation, which can then be referred to as a unit.</p><p>We begin by examining how to express the idea of <em>squaring</em>. We might say, “To square something, multiply it by itself.” This is expressed in Python as</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">&gt;&gt;&gt; def square(<span class="hljs-keyword">x</span>):<br>        return <span class="hljs-keyword">mul</span>(<span class="hljs-keyword">x</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">x</span>)<br></code></pre></td></tr></table></figure><p>which defines a new function that has been given the name <code>square</code>. This user-defined function is not built into the interpreter. It represents the compound operation of multiplying something by itself. The <code>x</code> in this definition is called a <em>formal parameter</em>, which provides a name for the thing to be multiplied. The definition creates this user-defined function and associates it with the name <code>square</code>.</p><p><strong>How to define a function.</strong> Function definitions consist of a <code>def</code> statement that indicates a <code>&lt;name&gt;</code> and a comma-separated list of named <code>&lt;formal parameters&gt;</code>, then a <code>return</code> statement, called the function body, that specifies the <code>&lt;return expression&gt;</code> of the function, which is an expression to be evaluated whenever the function is applied:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">def &lt;name&gt;(&lt;formal parameters&gt;):<br>    <span class="hljs-keyword">return</span> &lt;<span class="hljs-keyword">return</span> expression&gt;<br></code></pre></td></tr></table></figure><p>The second line <em>must</em> be indented — most programmers use four spaces to indent. The return expression is not evaluated right away; it is stored as part of the newly defined function and evaluated only when the function is eventually applied.</p><p>Having defined <code>square</code>, we can apply it with a call expression:</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">square(<span class="hljs-number">21</span>)</span><br>441<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">square(add(<span class="hljs-number">2</span>, <span class="hljs-number">5</span>))</span><br>49<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">square(square(<span class="hljs-number">3</span>))</span><br>81<br></code></pre></td></tr></table></figure><p>We can also use <code>square</code> as a building block in defining other functions. For example, we can easily define a function <code>sum_squares</code> that, given any two numbers as arguments, returns the sum of their squares:</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">sum_squares</span>(<span class="hljs-params">x, y</span>):</span><br>        return add(square(x), square(y))<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">sum_squares(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)</span><br>25<br></code></pre></td></tr></table></figure><p>User-defined functions are used in exactly the same way as built-in functions. Indeed, one cannot tell from the definition of <code>sum_squares</code> whether <code>square</code> is built into the interpreter, imported from a module, or defined by the user.</p><p>Both <code>def</code> statements and assignment statements bind names to values, and any existing bindings are lost. For example, <code>g</code> below first refers to a function of no arguments, then a number, and then a different function of two arguments.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">g</span>():</span><br>        return 1<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">g()</span><br>1<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">g = <span class="hljs-number">2</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">g</span><br>2<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">g</span>(<span class="hljs-params">h, i</span>):</span><br>        return h + i<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">g(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)</span><br>3<br></code></pre></td></tr></table></figure><h3 id="1-3-1-Environments"><a href="#1-3-1-Environments" class="headerlink" title="1.3.1  Environments"></a>1.3.1  Environments</h3><p>Our subset of Python is now complex enough that the meaning of programs is non-obvious. What if a formal parameter has the same name as a built-in function? Can two functions share names without confusion? To resolve such questions, we must describe environments in more detail.</p><p>An environment in which an expression is evaluated consists of a sequence of <em>frames</em>, depicted as boxes. Each frame contains <em>bindings</em>, each of which associates a name with its corresponding value. There is a single <em>global</em> frame. Assignment and import statements add entries to the first frame of the current environment. So far, our environment consists only of the global frame.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191735278.png"></p><p>This <em>environment diagram</em> shows the bindings of the current environment, along with the values to which names are bound. The environment diagrams in this text are interactive: you can step through the lines of the small program on the left to see the state of the environment evolve on the right. You can also click on the “Edit code in Online Python Tutor” link to load the example into the <a href="http://composingprograms.com/tutor.html">Online Python Tutor</a>, a tool created by <a href="http://www.pgbovine.net/">Philip Guo</a> for generating these environment diagrams. You are encouraged to create examples yourself and study the resulting environment diagrams.</p><p>Functions appear in environment diagrams as well. An <code>import</code> statement binds a name to a built-in function. A <code>def</code> statement binds a name to a user-defined function created by the definition. The resulting environment after importing <code>mul</code> and defining <code>square</code> appears below:</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191755574.png"></p><p>Each function is a line that starts with <code>func</code>, followed by the function name and formal parameters. Built-in functions such as <code>mul</code> do not have formal parameter names, and so <code>...</code> is always used instead.</p><p>The name of a function is repeated twice, once in the frame and again as part of the function itself. The name appearing in the function is called the <em>intrinsic name</em>. The name in a frame is a <em>bound name</em>. There is a difference between the two: different names may refer to the same function, but that function itself has only one intrinsic name.</p><p>The name bound to a function in a frame is the one used during evaluation. The intrinsic name of a function does not play a role in evaluation. Step through the example below using the <em>Forward</em> button to see that once the name <code>max</code> is bound to the value 3, it can no longer be used as a function.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191809648.png"></p><p>The error message <code>TypeError: &#39;int&#39; object is not callable</code> is reporting that the name <code>max</code> (currently bound to the number 3) is an integer and not a function. Therefore, it cannot be used as the operator in a call expression.</p><p><strong>Function Signatures.</strong> Functions differ in the number of arguments that they are allowed to take. To track these requirements, we draw each function in a way that shows the function name and its formal parameters. The user-defined function <code>square</code> takes only <code>x</code>; providing more or fewer arguments will result in an error. A description of the formal parameters of a function is called the function’s signature.</p><p>The function <code>max</code> can take an arbitrary number of arguments. It is rendered as <code>max(...)</code>. Regardless of the number of arguments taken, all built-in functions will be rendered as <code>&lt;name&gt;(...)</code>, because these primitive functions were never explicitly defined.</p><h3 id="1-3-2-Calling-User-Defined-Functions"><a href="#1-3-2-Calling-User-Defined-Functions" class="headerlink" title="1.3.2  Calling User-Defined Functions"></a>1.3.2  Calling User-Defined Functions</h3><p>To evaluate a call expression whose operator names a user-defined function, the Python interpreter follows a computational process. As with any call expression, the interpreter evaluates the operator and operand expressions, and then applies the named function to the resulting arguments.</p><p>Applying a user-defined function introduces a second <em>local</em> frame, which is only accessible to that function. To apply a user-defined function to some arguments:</p><ol><li>Bind the arguments to the names of the function’s formal parameters in a new <em>local</em> frame.</li><li>Execute the body of the function in the environment that starts with this frame.</li></ol><p>The environment in which the body is evaluated consists of two frames: first the local frame that contains formal parameter bindings, then the global frame that contains everything else. Each instance of a function application has its own independent local frame.</p><p>To illustrate an example in detail, several steps of the environment diagram for the same example are depicted below. After executing the first import statement, only the name <code>mul</code> is bound in the global frame.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191809993.png"></p><p>First, the definition statement for the function <code>square</code> is executed. Notice that the entire <code>def</code> statement is processed in a single step. The body of a function is not executed until the function is called (not when it is defined).</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191809942.png"></p><p>Next, The <code>square</code> function is called with the argument <code>-2</code>, and so a new frame is created with the formal parameter <code>x</code> bound to the value <code>-2</code>.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191810817.png"></p><p>Then, the name <code>x</code> is looked up in the current environment, which consists of the two frames shown. In both occurrences, <code>x</code> evaluates to <code>-2</code>, and so the <code>square</code> function returns 4.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191810068.png"></p><p>The “Return value” in the <code>square()</code> frame is not a name binding; instead it indicates the value returned by the function call that created the frame.</p><p>Even in this simple example, two different environments are used. The top-level expression <code>square(-2)</code> is evaluated in the global environment, while the return expression <code>mul(x, x)</code> is evaluated in the environment created for by calling <code>square</code>. Both <code>x</code> and <code>mul</code> are bound in this environment, but in different frames.</p><p>The order of frames in an environment affects the value returned by looking up a name in an expression. We stated previously that a name is evaluated to the value associated with that name in the current environment. We can now be more precise:</p><p><strong>Name Evaluation.</strong> A name evaluates to the value bound to that name in the earliest frame of the current environment in which that name is found.</p><p>Our conceptual framework of environments, names, and functions constitutes a <em>model of evaluation</em>; while some mechanical details are still unspecified (e.g., how a binding is implemented), our model does precisely and correctly describe how the interpreter evaluates call expressions. In Chapter 3 we will see how this model can serve as a blueprint for implementing a working interpreter for a programming language.</p><h3 id="1-3-3-Example-Calling-a-User-Defined-Function"><a href="#1-3-3-Example-Calling-a-User-Defined-Function" class="headerlink" title="1.3.3  Example: Calling a User-Defined Function"></a>1.3.3  Example: Calling a User-Defined Function</h3><p>Let us again consider our two simple function definitions and illustrate the process that evaluates a call expression for a user-defined function.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191811298.png"></p><p>Python first evaluates the name <code>sum_squares</code>, which is bound to a user-defined function in the global frame. The primitive numeric expressions 5 and 12 evaluate to the numbers they represent.</p><p>Next, Python applies <code>sum_squares</code>, which introduces a local frame that binds x to 5 and y to 12.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191811729.png"></p><p>The body of <code>sum_squares</code> contains this call expression:</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown">  add     (  square(x)  ,  square(y)  )<br><span class="hljs-strong">____</span><span class="hljs-strong">____</span>     <span class="hljs-strong">____</span><span class="hljs-strong">____</span>_     <span class="hljs-strong">____</span><span class="hljs-strong">____</span>_<br>operator     operand 0     operand 1<br></code></pre></td></tr></table></figure><p>All three subexpressions are evaluated in the current environment, which begins with the frame labeled <code>sum_squares()</code>. The operator subexpression <code>add</code> is a name found in the global frame, bound to the built-in function for addition. The two operand subexpressions must be evaluated in turn, before addition is applied. Both operands are evaluated in the current environment beginning with the frame labeled <code>sum_squares</code>.</p><p>In <code>operand 0</code>, <code>square</code> names a user-defined function in the global frame, while <code>x</code> names the number 5 in the local frame. Python applies <code>square</code> to 5 by introducing yet another local frame that binds x to 5.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191812314.png"></p><p>Using this environment, the expression <code>mul(x, x)</code> evaluates to 25.</p><p>Our evaluation procedure now turns to <code>operand 1</code>, for which <code>y</code> names the number 12. Python evaluates the body of <code>square</code> again, this time introducing yet another local frame that binds <code>x</code> to 12. Hence, <code>operand 1</code> evaluates to 144.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191812403.png"></p><p>Finally, applying addition to the arguments 25 and 144 yields a final return value for <code>sum_squares</code>: 169.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191812870.png"></p><p>This example illustrates many of the fundamental ideas we have developed so far. Names are bound to values, which are distributed across many independent local frames, along with a single global frame that contains shared names. A new local frame is introduced every time a function is called, even if the same function is called twice.</p><p>All of this machinery exists to ensure that names resolve to the correct values at the correct times during program execution. This example illustrates why our model requires the complexity that we have introduced. All three local frames contain a binding for the name <code>x</code>, but that name is bound to different values in different frames. Local frames keep these names separate.</p><h3 id="1-3-4-Local-Names"><a href="#1-3-4-Local-Names" class="headerlink" title="1.3.4  Local Names"></a>1.3.4  Local Names</h3><p>One detail of a function’s implementation that should not affect the function’s behavior is the implementer’s choice of names for the function’s formal parameters. Thus, the following functions should provide the same behavior:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">square</span>(<span class="hljs-params">x</span>):<br>        <span class="hljs-keyword">return</span> mul(x, x)<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">square</span>(<span class="hljs-params">y</span>):<br>        <span class="hljs-keyword">return</span> mul(y, y)<br></code></pre></td></tr></table></figure><p>This principle – that the meaning of a function should be independent of the parameter names chosen by its author – has important consequences for programming languages. The simplest consequence is that the parameter names of a function must remain local to the body of the function.</p><p>If the parameters were not local to the bodies of their respective functions, then the parameter <code>x</code> in <code>square</code> could be confused with the parameter <code>x</code> in <code>sum_squares</code>. Critically, this is not the case: the binding for <code>x</code> in different local frames are unrelated. The model of computation is carefully designed to ensure this independence.</p><p>We say that the <em>scope</em> of a local name is limited to the body of the user-defined function that defines it. When a name is no longer accessible, it is out of scope. This scoping behavior isn’t a new fact about our model; it is a consequence of the way environments work.</p><h3 id="1-3-5-Choosing-Names"><a href="#1-3-5-Choosing-Names" class="headerlink" title="1.3.5  Choosing Names"></a>1.3.5  Choosing Names</h3><p>The interchangeability of names does not imply that formal parameter names do not matter at all. On the contrary, well-chosen function and parameter names are essential for the human interpretability of function definitions!</p><p>The following guidelines are adapted from the <a href="http://www.python.org/dev/peps/pep-0008">style guide for Python code</a>, which serves as a guide for all (non-rebellious) Python programmers. A shared set of conventions smooths communication among members of a developer community. As a side effect of following these conventions, you will find that your code becomes more internally consistent.</p><ol><li>Function names are lowercase, with words separated by underscores. Descriptive names are encouraged.</li><li>Function names typically evoke operations applied to arguments by the interpreter (e.g., <code>print</code>, <code>add</code>, <code>square</code>) or the name of the quantity that results (e.g., <code>max</code>, <code>abs</code>, <code>sum</code>).</li><li>Parameter names are lowercase, with words separated by underscores. Single-word names are preferred.</li><li>Parameter names should evoke the role of the parameter in the function, not just the kind of argument that is allowed.</li><li>Single letter parameter names are acceptable when their role is obvious, but avoid “l” (lowercase ell), “O” (capital oh), or “I” (capital i) to avoid confusion with numerals.</li></ol><p>There are many exceptions to these guidelines, even in the Python standard library. Like the vocabulary of the English language, Python has inherited words from a variety of contributors, and the result is not always consistent.</p><h3 id="1-3-6-Functions-as-Abstractions"><a href="#1-3-6-Functions-as-Abstractions" class="headerlink" title="1.3.6  Functions as Abstractions"></a>1.3.6  Functions as Abstractions</h3><p>Though it is very simple, <code>sum_squares</code> exemplifies the most powerful property of user-defined functions. The function <code>sum_squares</code> is defined in terms of the function <code>square</code>, but relies only on the relationship that <code>square</code> defines between its input arguments and its output values.</p><p>We can write <code>sum_squares</code> without concerning ourselves with <em>how</em> to square a number. The details of how the square is computed can be suppressed, to be considered at a later time. Indeed, as far as <code>sum_squares</code> is concerned, <code>square</code> is not a particular function body, but rather an abstraction of a function, a so-called functional abstraction. At this level of abstraction, any function that computes the square is equally good.</p><p>Thus, considering only the values they return, the following two functions for squaring a number should be indistinguishable. Each takes a numerical argument and produces the square of that number as the value.</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs llvm">&gt;&gt;&gt; def square(<span class="hljs-keyword">x</span>):<br>        return <span class="hljs-keyword">mul</span>(<span class="hljs-keyword">x</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">x</span>)<br>&gt;&gt;&gt; def square(<span class="hljs-keyword">x</span>):<br>        return <span class="hljs-keyword">mul</span>(<span class="hljs-keyword">x</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">x</span><span class="hljs-number">-1</span>) + <span class="hljs-keyword">x</span><br></code></pre></td></tr></table></figure><p>In other words, a function definition should be able to suppress details. The users of the function may not have written the function themselves, but may have obtained it from another programmer as a “black box”. A programmer should not need to know how the function is implemented in order to use it. The Python Library has this property. Many developers use the functions defined there, but few ever inspect their implementation.</p><p><strong>Aspects of a functional abstraction.</strong> To master the use of a functional abstraction, it is often useful to consider its three core attributes. The <em>domain</em> of a function is the set of arguments it can take. The <em>range</em> of a function is the set of values it can return. The <em>intent</em> of a function is the relationship it computes between inputs and output (as well as any side effects it might generate). Understanding functional abstractions via their domain, range, and intent is critical to using them correctly in a complex program.</p><p>For example, any <code>square</code> function that we use to implement <code>sum_squares</code> should have these attributes:</p><ul><li>The <em>domain</em> is any single real number.</li><li>The <em>range</em> is any non-negative real number.</li><li>The <em>intent</em> is that the output is the square of the input.</li></ul><p>These attributes do not specify how the intent is carried out; that detail is abstracted away.</p><h3 id="1-3-7-Operators"><a href="#1-3-7-Operators" class="headerlink" title="1.3.7  Operators"></a>1.3.7  Operators</h3><p>Mathematical operators (such as <code>+</code> and <code>-</code>) provided our first example of a method of combination, but we have yet to define an evaluation procedure for expressions that contain these operators.</p><p>Python expressions with infix operators each have their own evaluation procedures, but you can often think of them as short-hand for call expressions. When you see</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-number">2</span> + <span class="hljs-number">3</span></span><br>5<br></code></pre></td></tr></table></figure><p>simply consider it to be short-hand for</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">add(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)</span><br>5<br></code></pre></td></tr></table></figure><p>Infix notation can be nested, just like call expressions. Python applies the normal mathematical rules of operator precedence, which dictate how to interpret a compound expression with multiple operators.</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tap">&gt;&gt;&gt;<span class="hljs-number"> 2 </span>+<span class="hljs-number"> 3 </span>*<span class="hljs-number"> 4 </span>+ 5<br>19<br></code></pre></td></tr></table></figure><p>evaluates to the same result as</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&gt;&gt;&gt; <span class="hljs-built_in">add</span>(<span class="hljs-built_in">add</span>(2, mul(3, 4)), 5)<br>19<br></code></pre></td></tr></table></figure><p>The nesting in the call expression is more explicit than the operator version, but also harder to read. Python also allows subexpression grouping with parentheses, to override the normal precedence rules or make the nested structure of an expression more explicit.</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode">&gt;&gt;&gt; <span class="hljs-comment">(2 + 3)</span> * <span class="hljs-comment">(4 + 5)</span><br><span class="hljs-number">45</span><br></code></pre></td></tr></table></figure><p>evaluates to the same result as</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&gt;&gt;&gt; mul(<span class="hljs-built_in">add</span>(2, 3), <span class="hljs-built_in">add</span>(4, 5))<br>45<br></code></pre></td></tr></table></figure><p>When it comes to division, Python provides two infix operators: <code>/</code> and <code>//</code>. The former is normal division, so that it results in a <em>floating point</em>, or decimal value, even if the divisor evenly divides the dividend:</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-number">5</span> / <span class="hljs-number">4</span></span><br>1.25<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-number">8</span> / <span class="hljs-number">4</span></span><br>2.0<br></code></pre></td></tr></table></figure><p>The <code>//</code> operator, on the other hand, rounds the result down to an integer:</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-number">5</span> // <span class="hljs-number">4</span></span><br>1<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">-<span class="hljs-number">5</span> // <span class="hljs-number">4</span></span><br>-2<br></code></pre></td></tr></table></figure><p>These two operators are shorthand for the <code>truediv</code> and <code>floordiv</code> functions.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">from</span> operator <span class="hljs-keyword">import</span> truediv, floordiv</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">truediv(<span class="hljs-number">5</span>, <span class="hljs-number">4</span>)</span><br>1.25<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">floordiv(<span class="hljs-number">5</span>, <span class="hljs-number">4</span>)</span><br>1<br></code></pre></td></tr></table></figure><p>You should feel free to use infix operators and parentheses in your programs. Idiomatic Python prefers operators over call expressions for simple mathematical operations.</p><h2 id="1-4-Designing-Functions"><a href="#1-4-Designing-Functions" class="headerlink" title="1.4  Designing Functions"></a>1.4  Designing Functions</h2><p>Functions are an essential ingredient of all programs, large and small, and serve as our primary medium to express computational processes in a programming language. So far, we have discussed the formal properties of functions and how they are applied. We now turn to the topic of what makes a good function. Fundamentally, the qualities of good functions all reinforce the idea that functions are abstractions.</p><ul><li>Each function should have exactly one job. That job should be identifiable with a short name and characterizable in a single line of text. Functions that perform multiple jobs in sequence should be divided into multiple functions.</li><li><em>Don’t repeat yourself</em> is a central tenet of software engineering. The so-called DRY principle states that multiple fragments of code should not describe redundant logic. Instead, that logic should be implemented once, given a name, and applied multiple times. If you find yourself copying and pasting a block of code, you have probably found an opportunity for functional abstraction.</li><li>Functions should be defined generally. Squaring is not in the Python Library precisely because it is a special case of the <code>pow</code> function, which raises numbers to arbitrary powers.</li></ul><p>These guidelines improve the readability of code, reduce the number of errors, and often minimize the total amount of code written. Decomposing a complex task into concise functions is a skill that takes experience to master. Fortunately, Python provides several features to support your efforts.</p><h3 id="1-4-1-Documentation"><a href="#1-4-1-Documentation" class="headerlink" title="1.4.1  Documentation"></a>1.4.1  Documentation</h3><p>A function definition will often include documentation describing the function, called a <em>docstring</em>, which must be indented along with the function body. Docstrings are conventionally triple quoted. The first line describes the job of the function in one line. The following lines can describe arguments and clarify the behavior of the function:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">pressure</span>(<span class="hljs-params">v, t, n</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;Compute the pressure in pascals of an ideal gas.</span><br><span class="hljs-string"></span><br><span class="hljs-string">        Applies the ideal gas law: http://en.wikipedia.org/wiki/Ideal_gas_law</span><br><span class="hljs-string"></span><br><span class="hljs-string">        v -- volume of gas, in cubic meters</span><br><span class="hljs-string">        t -- absolute temperature in degrees kelvin</span><br><span class="hljs-string">        n -- particles of gas</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        k = <span class="hljs-number">1.38e-23</span>  <span class="hljs-comment"># Boltzmann&#x27;s constant</span><br>        <span class="hljs-keyword">return</span> n * k * t / v<br></code></pre></td></tr></table></figure><p>When you call <code>help</code> with the name of a function as an argument, you see its docstring (type <code>q</code> to quit Python help).</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">help</span>(pressure)</span><br></code></pre></td></tr></table></figure><p>When writing Python programs, include docstrings for all but the simplest functions. Remember, code is written only once, but often read many times. The Python docs include <a href="http://www.python.org/dev/peps/pep-0257/">docstring guidelines</a> that maintain consistency across different Python projects.</p><p><strong>Comments</strong>. Comments in Python can be attached to the end of a line following the <code>#</code> symbol. For example, the comment <code>Boltzmann&#39;s constant</code> above describes <code>k</code>. These comments don’t ever appear in Python’s <code>help</code>, and they are ignored by the interpreter. They exist for humans alone.</p><h3 id="1-4-2-Default-Argument-Values"><a href="#1-4-2-Default-Argument-Values" class="headerlink" title="1.4.2  Default Argument Values"></a>1.4.2  Default Argument Values</h3><p>A consequence of defining general functions is the introduction of additional arguments. Functions with many arguments can be awkward to call and difficult to read.</p><p>In Python, we can provide default values for the arguments of a function. When calling that function, arguments with default values are optional. If they are not provided, then the default value is bound to the formal parameter name instead. For instance, if an application commonly computes pressure for one mole of particles, this value can be provided as a default:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">pressure</span>(<span class="hljs-params">v, t, n=<span class="hljs-number">6.022e23</span></span>):<br>        <span class="hljs-string">&quot;&quot;&quot;Compute the pressure in pascals of an ideal gas.</span><br><span class="hljs-string"></span><br><span class="hljs-string">        v -- volume of gas, in cubic meters</span><br><span class="hljs-string">        t -- absolute temperature in degrees kelvin</span><br><span class="hljs-string">        n -- particles of gas (default: one mole)</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        k = <span class="hljs-number">1.38e-23</span>  <span class="hljs-comment"># Boltzmann&#x27;s constant</span><br>        <span class="hljs-keyword">return</span> n * k * t / v<br></code></pre></td></tr></table></figure><p>The <code>=</code> symbol means two different things in this example, depending on the context in which it is used. In the <code>def</code> statement header, <code>=</code> does not perform assignment, but instead indicates a default value to use when the <code>pressure</code> function is called. By contrast, the assignment statement to <code>k</code> in the body of the function binds the name <code>k</code> to an approximation of Boltzmann’s constant.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">pressure(<span class="hljs-number">1</span>, <span class="hljs-number">273.15</span>)</span><br>2269.974834<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">pressure(<span class="hljs-number">1</span>, <span class="hljs-number">273.15</span>, <span class="hljs-number">3</span> * <span class="hljs-number">6.022e23</span>)</span><br>6809.924502<br></code></pre></td></tr></table></figure><p>The <code>pressure</code> function is defined to take three arguments, but only two are provided in the first call expression above. In this case, the value for <code>n</code> is taken from the <code>def</code> statement default. If a third argument is provided, the default is ignored.</p><p>As a guideline, most data values used in a function’s body should be expressed as default values to named arguments, so that they are easy to inspect and can be changed by the function caller. Some values that never change, such as the fundamental constant <code>k</code>, can be bound in the function body or in the global frame.</p><h2 id="1-5-Control"><a href="#1-5-Control" class="headerlink" title="1.5  Control"></a>1.5  Control</h2><p>The expressive power of the functions that we can define at this point is very limited, because we have not introduced a way to make comparisons and to perform different operations depending on the result of a comparison. <em>Control statements</em> will give us this ability. They are statements that control the flow of a program’s execution based on the results of logical comparisons.</p><p>Statements differ fundamentally from the expressions that we have studied so far. They have no value. Instead of computing something, executing a control statement determines what the interpreter should do next.</p><h3 id="1-5-1-Statements"><a href="#1-5-1-Statements" class="headerlink" title="1.5.1  Statements"></a>1.5.1  Statements</h3><p>So far, we have primarily considered how to evaluate expressions. However, we have seen three kinds of statements already: assignment, <code>def</code>, and <code>return</code> statements. These lines of Python code are not themselves expressions, although they all contain expressions as components.</p><p>Rather than being evaluated, statements are <em>executed</em>. Each statement describes some change to the interpreter state, and executing a statement applies that change. As we have seen for <code>return</code> and assignment statements, executing statements can involve evaluating subexpressions contained within them.</p><p>Expressions can also be executed as statements, in which case they are evaluated, but their value is discarded. Executing a pure function has no effect, but executing a non-pure function can cause effects as a consequence of function application.</p><p>Consider, for instance,</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">&gt;&gt;&gt; def square(<span class="hljs-keyword">x</span>):<br>        <span class="hljs-keyword">mul</span>(<span class="hljs-keyword">x</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">x</span>) # Watch out! This <span class="hljs-keyword">call</span> doesn&#x27;t return a value.<br></code></pre></td></tr></table></figure><p>This example is valid Python, but probably not what was intended. The body of the function consists of an expression. An expression by itself is a valid statement, but the effect of the statement is that the <code>mul</code> function is called, and the result is discarded. If you want to do something with the result of an expression, you need to say so: you might store it with an assignment statement or return it with a return statement:</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">&gt;&gt;&gt; def square(<span class="hljs-keyword">x</span>):<br>        return <span class="hljs-keyword">mul</span>(<span class="hljs-keyword">x</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">x</span>)<br></code></pre></td></tr></table></figure><p>Sometimes it does make sense to have a function whose body is an expression, when a non-pure function like <code>print</code> is called.</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs isbl">&gt;&gt;&gt; <span class="hljs-variable">def</span> <span class="hljs-function"><span class="hljs-title">print_square</span>(<span class="hljs-variable">x</span>):</span><br><span class="hljs-function">        <span class="hljs-title">print</span>(<span class="hljs-title">square</span>(<span class="hljs-variable">x</span>))</span><br></code></pre></td></tr></table></figure><p>At its highest level, the Python interpreter’s job is to execute programs, composed of statements. However, much of the interesting work of computation comes from evaluating expressions. Statements govern the relationship among different expressions in a program and what happens to their results.</p><h3 id="1-5-2-Compound-Statements"><a href="#1-5-2-Compound-Statements" class="headerlink" title="1.5.2  Compound Statements"></a>1.5.2  Compound Statements</h3><p>In general, Python code is a sequence of statements. A simple statement is a single line that doesn’t end in a colon. A compound statement is so called because it is composed of other statements (simple and compound). Compound statements typically span multiple lines and start with a one-line header ending in a colon, which identifies the type of statement. Together, a header and an indented suite of statements is called a clause. A compound statement consists of one or more clauses:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>:<br>    <span class="hljs-tag">&lt;<span class="hljs-name">statement</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">statement</span>&gt;</span><br>    ...<br><span class="hljs-tag">&lt;<span class="hljs-name">separating</span> <span class="hljs-attr">header</span>&gt;</span>:<br>    <span class="hljs-tag">&lt;<span class="hljs-name">statement</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">statement</span>&gt;</span><br>    ...<br>...<br></code></pre></td></tr></table></figure><p>We can understand the statements we have already introduced in these terms.</p><ul><li>Expressions, return statements, and assignment statements are simple statements.</li><li>A <code>def</code> statement is a compound statement. The suite that follows the <code>def</code> header defines the function body.</li></ul><p>Specialized evaluation rules for each kind of header dictate when and if the statements in its suite are executed. We say that the header controls its suite. For example, in the case of <code>def</code> statements, we saw that the return expression is not evaluated immediately, but instead stored for later use when the defined function is eventually called.</p><p>We can also understand multi-line programs now.</p><ul><li>To execute a sequence of statements, execute the first statement. If that statement does not redirect control, then proceed to execute the rest of the sequence of statements, if any remain.</li></ul><p>This definition exposes the essential structure of a recursively defined <em>sequence</em>: a sequence can be decomposed into its first element and the rest of its elements. The “rest” of a sequence of statements is itself a sequence of statements! Thus, we can recursively apply this execution rule. This view of sequences as recursive data structures will appear again in later chapters.</p><p>The important consequence of this rule is that statements are executed in order, but later statements may never be reached, because of redirected control.</p><p><strong>Practical Guidance.</strong> When indenting a suite, all lines must be indented the same amount and in the same way (use spaces, not tabs). Any variation in indentation will cause an error.</p><h3 id="1-5-3-Defining-Functions-II-Local-Assignment"><a href="#1-5-3-Defining-Functions-II-Local-Assignment" class="headerlink" title="1.5.3  Defining Functions II: Local Assignment"></a>1.5.3  Defining Functions II: Local Assignment</h3><p>Originally, we stated that the body of a user-defined function consisted only of a <code>return</code> statement with a single return expression. In fact, functions can define a sequence of operations that extends beyond a single expression.</p><p>Whenever a user-defined function is applied, the sequence of clauses in the suite of its definition is executed in a local environment — an environment starting with a local frame created by calling that function. A <code>return</code> statement redirects control: the process of function application terminates whenever the first <code>return</code> statement is executed, and the value of the <code>return</code> expression is the returned value of the function being applied.</p><p>Assignment statements can appear within a function body. For instance, this function returns the absolute difference between two quantities as a percentage of the first, using a two-step calculation:</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191817447.png"></p><p>The effect of an assignment statement is to bind a name to a value in the <em>first</em> frame of the current environment. As a consequence, assignment statements within a function body cannot affect the global frame. The fact that functions can only manipulate their local environment is critical to creating <em>modular</em> programs, in which pure functions interact only via the values they take and return.</p><p>Of course, the <code>percent_difference</code> function could be written as a single expression, as shown below, but the return expression is more complex.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">percent_difference</span>(<span class="hljs-params">x, y</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">100</span> * <span class="hljs-built_in">abs</span>(x-y) / x<br><span class="hljs-meta">&gt;&gt;&gt; </span>percent_difference(<span class="hljs-number">40</span>, <span class="hljs-number">50</span>)<br><span class="hljs-number">25.0</span><br></code></pre></td></tr></table></figure><p>So far, local assignment hasn’t increased the expressive power of our function definitions. It will do so, when combined with other control statements. In addition, local assignment also plays a critical role in clarifying the meaning of complex expressions by assigning names to intermediate quantities.</p><h3 id="1-5-4-Conditional-Statements"><a href="#1-5-4-Conditional-Statements" class="headerlink" title="1.5.4  Conditional Statements"></a>1.5.4  Conditional Statements</h3><p>Python has a built-in function for computing absolute values.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-built_in">abs</span>(-<span class="hljs-number">2</span>)</span><br>2<br></code></pre></td></tr></table></figure><p>We would like to be able to implement such a function ourselves, but we have no obvious way to define a function that has a comparison and a choice. We would like to express that if <code>x</code> is positive, <code>abs(x)</code> returns <code>x</code>. Furthermore, if <code>x</code> is 0, <code>abs(x)</code> returns 0. Otherwise, <code>abs(x)</code> returns <code>-x</code>. In Python, we can express this choice with a conditional statement.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191818095.png"></p><p>This implementation of <code>absolute_value</code> raises several important issues:</p><p><strong>Conditional statements</strong>. A conditional statement in Python consists of a series of headers and suites: a required <code>if</code> clause, an optional sequence of <code>elif</code> clauses, and finally an optional <code>else</code> clause:</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">if</span> <span class="hljs-symbol">&lt;expression&gt;</span>:<br>    <span class="hljs-symbol">&lt;suite&gt;</span><br>elif <span class="hljs-symbol">&lt;expression&gt;</span>:<br>    <span class="hljs-symbol">&lt;suite&gt;</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-symbol">&lt;suite&gt;</span><br></code></pre></td></tr></table></figure><p>When executing a conditional statement, each clause is considered in order. The computational process of executing a conditional clause follows.</p><ol><li>Evaluate the header’s expression.</li><li>If it is a true value, execute the suite. Then, skip over all subsequent clauses in the conditional statement.</li></ol><p>If the <code>else</code> clause is reached (which only happens if all <code>if</code> and <code>elif</code> expressions evaluate to false values), its suite is executed.</p><p><strong>Boolean contexts</strong>. Above, the execution procedures mention “a false value” and “a true value.” The expressions inside the header statements of conditional blocks are said to be in <em>boolean contexts</em>: their truth values matter to control flow, but otherwise their values are not assigned or returned. Python includes several false values, including 0, <code>None</code>, and the <em>boolean</em> value <code>False</code>. All other numbers are true values. In Chapter 2, we will see that every built-in kind of data in Python has both true and false values.</p><p><strong>Boolean values</strong>. Python has two boolean values, called <code>True</code> and <code>False</code>. Boolean values represent truth values in logical expressions. The built-in comparison operations, <code>&gt;, &lt;, &gt;=, &lt;=, ==, !=</code>, return these values.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">4</span> &lt; <span class="hljs-number">2</span><br><span class="hljs-literal">False</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-number">5</span> &gt;= <span class="hljs-number">5</span><br><span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure><p>This second example reads “5 is greater than or equal to 5”, and corresponds to the function <code>ge</code> in the <code>operator</code> module.</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&gt;&gt;&gt; <span class="hljs-number">0</span> <span class="hljs-operator">=</span><span class="hljs-operator">=</span> -<span class="hljs-number">0</span><br>True<br></code></pre></td></tr></table></figure><p>This final example reads “0 equals -0”, and corresponds to <code>eq</code> in the <code>operator</code> module. Notice that Python distinguishes assignment (<code>=</code>) from equality comparison (<code>==</code>), a convention shared across many programming languages.</p><p><strong>Boolean operators</strong>. Three basic logical operators are also built into Python:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-literal">True</span> <span class="hljs-keyword">and</span> <span class="hljs-literal">False</span><br><span class="hljs-literal">False</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-literal">True</span> <span class="hljs-keyword">or</span> <span class="hljs-literal">False</span><br><span class="hljs-literal">True</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">not</span> <span class="hljs-literal">False</span><br><span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure><p>Logical expressions have corresponding evaluation procedures. These procedures exploit the fact that the truth value of a logical expression can sometimes be determined without evaluating all of its subexpressions, a feature called <em>short-circuiting</em>.</p><p>To evaluate the expression <code>&lt;left&gt; and &lt;right&gt;</code>:</p><ol><li>Evaluate the subexpression <code>&lt;left&gt;</code>.</li><li>If the result is a false value <code>v</code>, then the expression evaluates to <code>v</code>.</li><li>Otherwise, the expression evaluates to the value of the subexpression <code>&lt;right&gt;</code>.</li></ol><p>To evaluate the expression <code>&lt;left&gt; or &lt;right&gt;</code>:</p><ol><li>Evaluate the subexpression <code>&lt;left&gt;</code>.</li><li>If the result is a true value <code>v</code>, then the expression evaluates to <code>v</code>.</li><li>Otherwise, the expression evaluates to the value of the subexpression <code>&lt;right&gt;</code>.</li></ol><p>To evaluate the expression <code>not &lt;exp&gt;</code>:</p><ol><li>Evaluate <code>&lt;exp&gt;</code>; The value is <code>True</code> if the result is a false value, and <code>False</code> otherwise.</li></ol><p>These values, rules, and operators provide us with a way to combine the results of comparisons. Functions that perform comparisons and return boolean values typically begin with <code>is</code>, not followed by an underscore (e.g., <code>isfinite</code>, <code>isdigit</code>, <code>isinstance</code>, etc.).</p><h3 id="1-5-5-Iteration"><a href="#1-5-5-Iteration" class="headerlink" title="1.5.5  Iteration"></a>1.5.5  Iteration</h3><p>In addition to selecting which statements to execute, control statements are used to express repetition. If each line of code we wrote were only executed once, programming would be a very unproductive exercise. Only through repeated execution of statements do we unlock the full potential of computers. We have already seen one form of repetition: a function can be applied many times, although it is only defined once. Iterative control structures are another mechanism for executing the same statements many times.</p><p>Consider the sequence of Fibonacci numbers, in which each number is the sum of the preceding two:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">21</span>, ...<br></code></pre></td></tr></table></figure><p>Each value is constructed by repeatedly applying the sum-previous-two rule. The first and second are fixed to 0 and 1. For instance, the eighth Fibonacci number is 13.</p><p>We can use a <code>while</code> statement to enumerate <code>n</code> Fibonacci numbers. We need to track how many values we’ve created (<code>k</code>), along with the kth value (<code>curr</code>) and its predecessor (<code>pred</code>). Step through this function and observe how the Fibonacci numbers evolve one by one, bound to <code>curr</code>.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191818999.png"></p><p>Remember that commas seperate multiple names and values in an assignment statement. The line:</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima"><span class="hljs-built_in">pred</span>, curr = curr, <span class="hljs-built_in">pred</span> + curr<br></code></pre></td></tr></table></figure><p>has the effect of rebinding the name <code>pred</code> to the value of <code>curr</code>, and simultanously rebinding <code>curr</code> to the value of <code>pred + curr</code>. All of the expressions to the right of <code>=</code> are evaluated before any rebinding takes place.</p><p>This order of events – evaluating everything on the right of <code>=</code> before updating any bindings on the left – is essential for correctness of this function.</p><p>A <code>while</code> clause contains a header expression followed by a suite:</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">while</span> <span class="hljs-symbol">&lt;expression&gt;</span>:<br>    <span class="hljs-symbol">&lt;suite&gt;</span><br></code></pre></td></tr></table></figure><p>To execute a <code>while</code> clause:</p><ol><li>Evaluate the header’s expression.</li><li>If it is a true value, execute the suite, then return to step 1.</li></ol><p>In step 2, the entire suite of the <code>while</code> clause is executed before the header expression is evaluated again.</p><p>In order to prevent the suite of a <code>while</code> clause from being executed indefinitely, the suite should always change some binding in each pass.</p><p>A <code>while</code> statement that does not terminate is called an infinite loop. Press <code>&lt;Control&gt;-C</code> to force Python to stop looping.</p><h3 id="1-5-6-Testing"><a href="#1-5-6-Testing" class="headerlink" title="1.5.6  Testing"></a>1.5.6  Testing</h3><p><em>Testing</em> a function is the act of verifying that the function’s behavior matches expectations. Our language of functions is now sufficiently complex that we need to start testing our implementations.</p><p>A <em>test</em> is a mechanism for systematically performing this verification. Tests typically take the form of another function that contains one or more sample calls to the function being tested. The returned value is then verified against an expected result. Unlike most functions, which are meant to be general, tests involve selecting and validating calls with specific argument values. Tests also serve as documentation: they demonstrate how to call a function and what argument values are appropriate.</p><p><strong>Assertions.</strong> Programmers use <code>assert</code> statements to verify expectations, such as the output of a function being tested. An <code>assert</code> statement has an expression in a boolean context, followed by a quoted line of text (single or double quotes are both fine, but be consistent) that will be displayed if the expression evaluates to a false value.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">assert</span> fib(<span class="hljs-number">8</span>) == <span class="hljs-number">13</span>, <span class="hljs-string">&#x27;The 8th Fibonacci number should be 13&#x27;</span></span><br></code></pre></td></tr></table></figure><p>When the expression being asserted evaluates to a true value, executing an assert statement has no effect. When it is a false value, <code>assert</code> causes an error that halts execution.</p><p>A test function for <code>fib</code> should test several arguments, including extreme values of <code>n</code>.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">&gt;&gt;&gt; def <span class="hljs-title function_">fib_test</span><span class="hljs-params">()</span>:<br>        <span class="hljs-keyword">assert</span> <span class="hljs-title function_">fib</span><span class="hljs-params">(<span class="hljs-number">2</span>)</span> == <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;The 2nd Fibonacci number should be 1&#x27;</span><br>        <span class="hljs-keyword">assert</span> <span class="hljs-title function_">fib</span><span class="hljs-params">(<span class="hljs-number">3</span>)</span> == <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;The 3rd Fibonacci number should be 1&#x27;</span><br>        <span class="hljs-keyword">assert</span> <span class="hljs-title function_">fib</span><span class="hljs-params">(<span class="hljs-number">50</span>)</span> == <span class="hljs-number">7778742049</span>, <span class="hljs-string">&#x27;Error at the 50th Fibonacci number&#x27;</span><br></code></pre></td></tr></table></figure><p>When writing Python in files, rather than directly into the interpreter, tests are typically written in the same file or a neighboring file with the suffix <code>_test.py</code>.</p><p><strong>Doctests.</strong> Python provides a convenient method for placing simple tests directly in the docstring of a function. The first line of a docstring should contain a one-line description of the function, followed by a blank line. A detailed description of arguments and behavior may follow. In addition, the docstring may include a sample interactive session that calls the function:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">sum_naturals</span>(<span class="hljs-params">n</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;Return the sum of the first n natural numbers.</span><br><span class="hljs-string"></span><br><span class="hljs-string">        &gt;&gt;&gt; sum_naturals(10)</span><br><span class="hljs-string">        55</span><br><span class="hljs-string">        &gt;&gt;&gt; sum_naturals(100)</span><br><span class="hljs-string">        5050</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        total, k = <span class="hljs-number">0</span>, <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> k &lt;= n:<br>            total, k = total + k, k + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> total<br></code></pre></td></tr></table></figure><p>Then, the interaction can be verified via the <a href="http://docs.python.org/py3k/library/doctest.html">doctest module</a>. Below, the <code>globals</code> function returns a representation of the global environment, which the interpreter needs in order to evaluate expressions.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">from</span> doctest <span class="hljs-keyword">import</span> testmod</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">testmod()</span><br>TestResults(failed=0, attempted=2)<br></code></pre></td></tr></table></figure><p>To verify the doctest interactions for only a single function, we use a <code>doctest</code> function called <code>run_docstring_examples</code>. This function is (unfortunately) a bit complicated to call. Its first argument is the function to test. The second should always be the result of the expression <code>globals()</code>, a built-in function that returns the global environment. The third argument is <code>True</code> to indicate that we would like “verbose” output: a catalog of all tests run.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">from</span> doctest <span class="hljs-keyword">import</span> run_docstring_examples</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">run_docstring_examples(sum_naturals, <span class="hljs-built_in">globals</span>(), <span class="hljs-literal">True</span>)</span><br>Finding tests in NoName<br>Trying:<br>    sum_naturals(10)<br>Expecting:<br>    55<br>ok<br>Trying:<br>    sum_naturals(100)<br>Expecting:<br>    5050<br>ok<br></code></pre></td></tr></table></figure><p>When the return value of a function does not match the expected result, the <code>run_docstring_examples</code> function will report this problem as a test failure.</p><p>When writing Python in files, all doctests in a file can be run by starting Python with the doctest command line option:</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python3</span> -<span class="hljs-keyword">m</span> doctest <span class="hljs-symbol">&lt;python_source_file&gt;</span><br></code></pre></td></tr></table></figure><p>The key to effective testing is to write (and run) tests immediately after implementing new functions. It is even good practice to write some tests before you implement, in order to have some example inputs and outputs in your mind. A test that applies a single function is called a <em>unit test</em>. Exhaustive unit testing is a hallmark of good program design.</p><h2 id="1-6-Higher-Order-Functions"><a href="#1-6-Higher-Order-Functions" class="headerlink" title="1.6  Higher-Order Functions"></a>1.6  Higher-Order Functions</h2><p>We have seen that functions are a method of abstraction that describe compound operations independent of the particular values of their arguments. That is, in <code>square</code>,</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">square</span>(<span class="hljs-params">x</span>):<br>        <span class="hljs-keyword">return</span> x * x<br></code></pre></td></tr></table></figure><p>we are not talking about the square of a particular number, but rather about a method for obtaining the square of any number. Of course, we could get along without ever defining this function, by always writing expressions such as</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-number">3</span> * <span class="hljs-number">3</span></span><br>9<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-number">5</span> * <span class="hljs-number">5</span></span><br>25<br></code></pre></td></tr></table></figure><p>and never mentioning <code>square</code> explicitly. This practice would suffice for simple computations such as <code>square</code>, but would become arduous for more complex examples such as <code>abs</code> or <code>fib</code>. In general, lacking function definition would put us at the disadvantage of forcing us to work always at the level of the particular operations that happen to be primitives in the language (multiplication, in this case) rather than in terms of higher-level operations. Our programs would be able to compute squares, but our language would lack the ability to express the concept of squaring.</p><p>One of the things we should demand from a powerful programming language is the ability to build abstractions by assigning names to common patterns and then to work in terms of the names directly. Functions provide this ability. As we will see in the following examples, there are common programming patterns that recur in code, but are used with a number of different functions. These patterns can also be abstracted, by giving them names.</p><p>To express certain general patterns as named concepts, we will need to construct functions that can accept other functions as arguments or return functions as values. Functions that manipulate functions are called higher-order functions. This section shows how higher-order functions can serve as powerful abstraction mechanisms, vastly increasing the expressive power of our language.</p><h3 id="1-6-1-Functions-as-Arguments"><a href="#1-6-1-Functions-as-Arguments" class="headerlink" title="1.6.1  Functions as Arguments"></a>1.6.1  Functions as Arguments</h3><p>Consider the following three functions, which all compute summations. The first, <code>sum_naturals</code>, computes the sum of natural numbers up to <code>n</code>:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">sum_naturals</span>(<span class="hljs-params">n</span>):<br>        total, k = <span class="hljs-number">0</span>, <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> k &lt;= n:<br>            total, k = total + k, k + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> total<br><span class="hljs-meta">&gt;&gt;&gt; </span>sum_naturals(<span class="hljs-number">100</span>)<br><span class="hljs-number">5050</span><br></code></pre></td></tr></table></figure><p>The second, <code>sum_cubes</code>, computes the sum of the cubes of natural numbers up to <code>n</code>.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">sum_cubes</span>(<span class="hljs-params">n</span>):<br>        total, k = <span class="hljs-number">0</span>, <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> k &lt;= n:<br>            total, k = total + k*k*k, k + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> total<br><span class="hljs-meta">&gt;&gt;&gt; </span>sum_cubes(<span class="hljs-number">100</span>)<br><span class="hljs-number">25502500</span><br></code></pre></td></tr></table></figure><p>The third, <code>pi_sum</code>, computes the sum of terms in the series</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191819153.png"></p><p>which converges to pi very slowly.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">pi_sum</span>(<span class="hljs-params">n</span>):<br>        total, k = <span class="hljs-number">0</span>, <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> k &lt;= n:<br>            total, k = total + <span class="hljs-number">8</span> / ((<span class="hljs-number">4</span>*k-<span class="hljs-number">3</span>) * (<span class="hljs-number">4</span>*k-<span class="hljs-number">1</span>)), k + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> total<br><span class="hljs-meta">&gt;&gt;&gt; </span>pi_sum(<span class="hljs-number">100</span>)<br><span class="hljs-number">3.1365926848388144</span><br></code></pre></td></tr></table></figure><p>These three functions clearly share a common underlying pattern. They are for the most part identical, differing only in name and the function of <code>k</code> used to compute the term to be added. We could generate each of the functions by filling in slots in the same template:</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stata">def &lt;name&gt;(<span class="hljs-keyword">n</span>):<br>    <span class="hljs-keyword">total</span>, k = 0, 1<br>    <span class="hljs-keyword">while</span> k &lt;= <span class="hljs-keyword">n</span>:<br>        <span class="hljs-keyword">total</span>, k = <span class="hljs-keyword">total</span> + &lt;term&gt;(k), k + 1<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">total</span><br></code></pre></td></tr></table></figure><p>The presence of such a common pattern is strong evidence that there is a useful abstraction waiting to be brought to the surface. Each of these functions is a summation of terms. As program designers, we would like our language to be powerful enough so that we can write a function that expresses the concept of summation itself rather than only functions that compute particular sums. We can do so readily in Python by taking the common template shown above and transforming the “slots” into formal parameters:</p><p>In the example below, <code>summation</code> takes as its two arguments the upper bound <code>n</code> together with the function <code>term</code> that computes the kth term. We can use <code>summation</code> just as we would any function, and it expresses summations succinctly. Take the time to step through this example, and notice how binding <code>cube</code> to the local names <code>term</code> ensures that the result <code>1*1*1 + 2*2*2 + 3*3*3 = 36</code> is computed correctly. In this example, frames which are no longer needed are removed to save space.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191819820.png"></p><p>Using an <code>identity</code> function that returns its argument, we can also sum natural numbers using exactly the same <code>summation</code> function.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">summation</span>(<span class="hljs-params">n, term</span>):<br>        total, k = <span class="hljs-number">0</span>, <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> k &lt;= n:<br>            total, k = total + term(k), k + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> total<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">identity</span>(<span class="hljs-params">x</span>):<br>        <span class="hljs-keyword">return</span> x<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">sum_naturals</span>(<span class="hljs-params">n</span>):<br>        <span class="hljs-keyword">return</span> summation(n, identity)<br><span class="hljs-meta">&gt;&gt;&gt; </span>sum_naturals(<span class="hljs-number">10</span>)<br><span class="hljs-number">55</span><br></code></pre></td></tr></table></figure><p>The <code>summation</code> function can also be called directly, without definining another function for a specific sequence.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">summation(<span class="hljs-number">10</span>, square)</span><br>385<br></code></pre></td></tr></table></figure><p>We can define <code>pi_sum</code> using our <code>summation</code> abstraction by defining a function <code>pi_term</code> to compute each term. We pass the argument <code>1e6</code>, a shorthand for <code>1 * 10^6 = 1000000</code>, to generate a close approximation to pi.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">pi_term</span>(<span class="hljs-params">x</span>):</span><br>        return 8 / ((4*x-3) * (4*x-1))<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">pi_sum</span>(<span class="hljs-params">n</span>):</span><br>        return summation(n, pi_term)<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">pi_sum(<span class="hljs-number">1e6</span>)</span><br>3.141592153589902<br></code></pre></td></tr></table></figure><h3 id="1-6-2-Functions-as-General-Methods"><a href="#1-6-2-Functions-as-General-Methods" class="headerlink" title="1.6.2  Functions as General Methods"></a>1.6.2  Functions as General Methods</h3><p>We introduced user-defined functions as a mechanism for abstracting patterns of numerical operations so as to make them independent of the particular numbers involved. With higher-order functions, we begin to see a more powerful kind of abstraction: some functions express general methods of computation, independent of the particular functions they call.</p><p>Despite this conceptual extension of what a function means, our environment model of how to evaluate a call expression extends gracefully to the case of higher-order functions, without change. When a user-defined function is applied to some arguments, the formal parameters are bound to the values of those arguments (which may be functions) in a new local frame.</p><p>Consider the following example, which implements a general method for iterative improvement and uses it to compute the <a href="http://www.geom.uiuc.edu/~demo5337/s97b/art.htm">golden ratio</a>. The golden ratio, often called “phi”, is a number near 1.6 that appears frequently in nature, art, and architecture.</p><p>An iterative improvement algorithm begins with a <code>guess</code> of a solution to an equation. It repeatedly applies an <code>update</code> function to improve that guess, and applies a <code>close</code> comparison to check whether the current <code>guess</code> is “close enough” to be considered correct.</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">&gt;&gt;&gt; def improve(<span class="hljs-keyword">update</span>, <span class="hljs-keyword">close</span>, guess=<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">close</span>(guess):<br>            guess = <span class="hljs-keyword">update</span>(guess)<br>        <span class="hljs-keyword">return</span> guess<br></code></pre></td></tr></table></figure><p>This <code>improve</code> function is a general expression of repetitive refinement. It doesn’t specify what problem is being solved: those details are left to the <code>update</code> and <code>close</code> functions passed in as arguments.</p><p>Among the well-known properties of the golden ratio are that it can be computed by repeatedly summing the inverse of any positive number with 1, and that it is one less than its square. We can express these properties as functions to be used with <code>improve</code>.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">golden_update</span>(<span class="hljs-params">guess</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>/guess + <span class="hljs-number">1</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">square_close_to_successor</span>(<span class="hljs-params">guess</span>):<br>        <span class="hljs-keyword">return</span> approx_eq(guess * guess, guess + <span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p>Above, we introduce a call to <code>approx_eq</code> that is meant to return <code>True</code> if its arguments are approximately equal to each other. To implement, <code>approx_eq</code>, we can compare the absolute value of the difference between two numbers to a small tolerance value.</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs perl">&gt;&gt;&gt; def approx_e<span class="hljs-string">q(x, y, tolerance=1e-15)</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">abs</span>(<span class="hljs-keyword">x</span> - <span class="hljs-keyword">y</span>) &lt; tolerance<br></code></pre></td></tr></table></figure><p>Calling <code>improve</code> with the arguments <code>golden_update</code> and <code>square_close_to_successor</code> will compute a finite approximation to the golden ratio.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">improve(golden_update, square_close_to_successor)</span><br>1.6180339887498951<br></code></pre></td></tr></table></figure><p>By tracing through the steps of evaluation, we can see how this result is computed. First, a local frame for <code>improve</code> is constructed with bindings for <code>update</code>, <code>close</code>, and <code>guess</code>. In the body of <code>improve</code>, the name <code>close</code> is bound to <code>square_close_to_successor</code>, which is called on the initial value of <code>guess</code>. Trace through the rest of the steps to see the computational process that evolves to compute the golden ratio.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191820732.png"></p><p>This example illustrates two related big ideas in computer science. First, naming and functions allow us to abstract away a vast amount of complexity. While each function definition has been trivial, the computational process set in motion by our evaluation procedure is quite intricate. Second, it is only by virtue of the fact that we have an extremely general evaluation procedure for the Python language that small components can be composed into complex processes. Understanding the procedure of interpreting programs allows us to validate and inspect the process we have created.</p><p>As always, our new general method <code>improve</code> needs a test to check its correctness. The golden ratio can provide such a test, because it also has an exact closed-form solution, which we can compare to this iterative result.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> sqrt</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">phi = <span class="hljs-number">1</span>/<span class="hljs-number">2</span> + sqrt(<span class="hljs-number">5</span>)/<span class="hljs-number">2</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">improve_test</span>():</span><br>        approx_phi = improve(golden_update, square_close_to_successor)<br>        assert approx_eq(phi, approx_phi), &#x27;phi differs from its approximation&#x27;<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">improve_test()</span><br></code></pre></td></tr></table></figure><p>For this test, no news is good news: <code>improve_test</code> returns <code>None</code> after its <code>assert</code> statement is executed successfully.</p><h3 id="1-6-3-Defining-Functions-III-Nested-Definitions"><a href="#1-6-3-Defining-Functions-III-Nested-Definitions" class="headerlink" title="1.6.3  Defining Functions III: Nested Definitions"></a>1.6.3  Defining Functions III: Nested Definitions</h3><p>The above examples demonstrate how the ability to pass functions as arguments significantly enhances the expressive power of our programming language. Each general concept or equation maps onto its own short function. One negative consequence of this approach is that the global frame becomes cluttered with names of small functions, which must all be unique. Another problem is that we are constrained by particular function signatures: the <code>update</code> argument to <code>improve</code> must take exactly one argument. Nested function definitions address both of these problems, but require us to enrich our environment model.</p><p>Let’s consider a new problem: computing the square root of a number. In programming languages, “square root” is often abbreviated as <code>sqrt</code>. Repeated application of the following update converges to the square root of <code>a</code>:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">average</span>(<span class="hljs-params">x, y</span>):<br>        <span class="hljs-keyword">return</span> (x + y)/<span class="hljs-number">2</span><br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">sqrt_update</span>(<span class="hljs-params">x, a</span>):<br>        <span class="hljs-keyword">return</span> average(x, a/x)<br></code></pre></td></tr></table></figure><p>This two-argument update function is incompatible with <code>improve</code> (it takes two arguments, not one), and it provides only a single update, while we really care about taking square roots by repeated updates. The solution to both of these issues is to place function definitions inside the body of other definitions.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">sqrt</span>(<span class="hljs-params">a</span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">sqrt_update</span>(<span class="hljs-params">x</span>):<br>            <span class="hljs-keyword">return</span> average(x, a/x)<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">sqrt_close</span>(<span class="hljs-params">x</span>):<br>            <span class="hljs-keyword">return</span> approx_eq(x * x, a)<br>        <span class="hljs-keyword">return</span> improve(sqrt_update, sqrt_close)<br></code></pre></td></tr></table></figure><p>Like local assignment, local <code>def</code> statements only affect the current local frame. These functions are only in scope while <code>sqrt</code> is being evaluated. Consistent with our evaluation procedure, these local <code>def</code> statements don’t even get evaluated until <code>sqrt</code> is called.</p><p><strong>Lexical scope.</strong> Locally defined functions also have access to the name bindings in the scope in which they are defined. In this example, <code>sqrt_update</code> refers to the name <code>a</code>, which is a formal parameter of its enclosing function <code>sqrt</code>. This discipline of sharing names among nested definitions is called <em>lexical scoping</em>. Critically, the inner functions have access to the names in the environment where they are defined (not where they are called).</p><p>We require two extensions to our environment model to enable lexical scoping.</p><ol><li>Each user-defined function has a parent environment: the environment in which it was defined.</li><li>When a user-defined function is called, its local frame extends its parent environment.</li></ol><p>Previous to <code>sqrt</code>, all functions were defined in the global environment, and so they all had the same parent: the global environment. By contrast, when Python evaluates the first two clauses of <code>sqrt</code>, it create functions that are associated with a local environment. In the call</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs isbl">&gt;&gt;&gt; <span class="hljs-function"><span class="hljs-title">sqrt</span>(<span class="hljs-number">256</span>)</span><br><span class="hljs-number">16.0</span><br></code></pre></td></tr></table></figure><p>the environment first adds a local frame for <code>sqrt</code> and evaluates the <code>def</code> statements for <code>sqrt_update</code> and <code>sqrt_close</code>.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191820683.png"></p><p>Function values each have a new annotation that we will include in environment diagrams from now on, a <em>parent</em>. The parent of a function value is the first frame of the environment in which that function was defined. Functions without parent annotations were defined in the global environment. When a user-defined function is called, the frame created has the same parent as that function.</p><p>Subsequently, the name <code>sqrt_update</code> resolves to this newly defined function, which is passed as an argument to <code>improve</code>. Within the body of <code>improve</code>, we must apply our <code>update</code> function (bound to <code>sqrt_update</code>) to the initial guess <code>x</code> of 1. This final application creates an environment for <code>sqrt_update</code> that begins with a local frame containing only <code>x</code>, but with the parent frame <code>sqrt</code> still containing a binding for <code>a</code>.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191821208.png"></p><p>The most critical part of this evaluation procedure is the transfer of the parent for <code>sqrt_update</code> to the frame created by calling <code>sqrt_update</code>. This frame is also annotated with <code>[parent=f1]</code>.</p><p><strong>Extended Environments</strong>. An environment can consist of an arbitrarily long chain of frames, which always concludes with the global frame. Previous to this <code>sqrt</code> example, environments had at most two frames: a local frame and the global frame. By calling functions that were defined within other functions, via nested <code>def</code> statements, we can create longer chains. The environment for this call to <code>sqrt_update</code> consists of three frames: the local <code>sqrt_update</code> frame, the <code>sqrt</code> frame in which <code>sqrt_update</code> was defined (labeled <code>f1</code>), and the global frame.</p><p>The return expression in the body of <code>sqrt_update</code> can resolve a value for <code>a</code> by following this chain of frames. Looking up a name finds the first value bound to that name in the current environment. Python checks first in the <code>sqrt_update</code> frame – no <code>a</code> exists. Python checks next in the parent frame, <code>f1</code>, and finds a binding for <code>a</code> to 256.</p><p>Hence, we realize two key advantages of lexical scoping in Python.</p><ul><li>The names of a local function do not interfere with names external to the function in which it is defined, because the local function name will be bound in the current local environment in which it was defined, rather than the global environment.</li><li>A local function can access the environment of the enclosing function, because the body of the local function is evaluated in an environment that extends the evaluation environment in which it was defined.</li></ul><p>The <code>sqrt_update</code> function carries with it some data: the value for <code>a</code> referenced in the environment in which it was defined. Because they “enclose” information in this way, locally defined functions are often called <em>closures</em>.</p><h3 id="1-6-4-Functions-as-Returned-Values"><a href="#1-6-4-Functions-as-Returned-Values" class="headerlink" title="1.6.4  Functions as Returned Values"></a>1.6.4  Functions as Returned Values</h3><p>We can achieve even more expressive power in our programs by creating functions whose returned values are themselves functions. An important feature of lexically scoped programming languages is that locally defined functions maintain their parent environment when they are returned. The following example illustrates the utility of this feature.</p><p>Once many simple functions are defined, function <em>composition</em> is a natural method of combination to include in our programming language. That is, given two functions <code>f(x)</code> and <code>g(x)</code>, we might want to define <code>h(x) = f(g(x))</code>. We can define function composition using our existing tools:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">compose1</span>(<span class="hljs-params">f, g</span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">h</span>(<span class="hljs-params">x</span>):<br>            <span class="hljs-keyword">return</span> f(g(x))<br>        <span class="hljs-keyword">return</span> h<br></code></pre></td></tr></table></figure><p>The environment diagram for this example shows how the names <code>f</code> and <code>g</code> are resolved correctly, even in the presence of conflicting names.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191821735.png"></p><p>The 1 in <code>compose1</code> is meant to signify that the composed functions all take a single argument. This naming convention is not enforced by the interpreter; the 1 is just part of the function name.</p><p>At this point, we begin to observe the benefits of our effort to define precisely the environment model of computation. No modification to our environment model is required to explain our ability to return functions in this way.</p><h3 id="1-6-5-Example-Newton’s-Method"><a href="#1-6-5-Example-Newton’s-Method" class="headerlink" title="1.6.5  Example: Newton’s Method"></a>1.6.5  Example: Newton’s Method</h3><p>This extended example shows how function return values and local definitions can work together to express general ideas concisely. We will implement an algorithm that is used broadly in machine learning, scientific computing, hardware design, and optimization.</p><p>Newton’s method is a classic iterative approach to finding the arguments of a mathematical function that yield a return value of 0. These values are called the <em>zeros</em> of the function. Finding a zero of a function is often equivalent to solving some other problem of interest, such as computing a square root.</p><p>A motivating comment before we proceed: it is easy to take for granted the fact that we know how to compute square roots. Not just Python, but your phone, web browser, or pocket calculator can do so for you. However, part of learning computer science is understanding how quantities like these can be computed, and the general approach presented here is applicable to solving a large class of equations beyond those built into Python.</p><p>Newton’s method is an iterative improvement algorithm: it improves a guess of the zero for any function that is <em>differentiable</em>, which means that it can be approximated by a straight line at any point. Newton’s method follows these linear approximations to find function zeros.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191843146.png"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191822519.png" alt="img"></p><p>A <code>newton_update</code> expresses the computational process of following this tangent line to 0, for a function <code>f</code> and its derivative <code>df</code>.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">newton_update</span>(<span class="hljs-params">f, df</span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">x</span>):<br>            <span class="hljs-keyword">return</span> x - f(x) / df(x)<br>        <span class="hljs-keyword">return</span> update<br></code></pre></td></tr></table></figure><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191843782.png"></p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs perl">&gt;&gt;&gt; def find_zero(f, df):<br>        def near_zero(<span class="hljs-keyword">x</span>):<br>            <span class="hljs-keyword">return</span> approx_e<span class="hljs-string">q(f(x)</span>, <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> improve(newton_update(f, df), near_zero)<br></code></pre></td></tr></table></figure><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191842997.png"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191822805.png"></p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191842811.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">square_root_newton</span>(<span class="hljs-params">a</span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x</span>):<br>            <span class="hljs-keyword">return</span> x * x - a<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">df</span>(<span class="hljs-params">x</span>):<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * x<br>        <span class="hljs-keyword">return</span> find_zero(f, df)<br><span class="hljs-meta">&gt;&gt;&gt; </span>square_root_newton(<span class="hljs-number">64</span>)<br><span class="hljs-number">8.0</span><br></code></pre></td></tr></table></figure><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191841110.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">power</span>(<span class="hljs-params">x, n</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;Return x * x * x * ... * x for x repeated n times.&quot;&quot;&quot;</span><br>        product, k = <span class="hljs-number">1</span>, <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> k &lt; n:<br>            product, k = product * x, k + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> product<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">nth_root_of_a</span>(<span class="hljs-params">n, a</span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x</span>):<br>            <span class="hljs-keyword">return</span> power(x, n) - a<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">df</span>(<span class="hljs-params">x</span>):<br>            <span class="hljs-keyword">return</span> n * power(x, n-<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span> find_zero(f, df)<br><span class="hljs-meta">&gt;&gt;&gt; </span>nth_root_of_a(<span class="hljs-number">2</span>, <span class="hljs-number">64</span>)<br><span class="hljs-number">8.0</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>nth_root_of_a(<span class="hljs-number">3</span>, <span class="hljs-number">64</span>)<br><span class="hljs-number">4.0</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>nth_root_of_a(<span class="hljs-number">6</span>, <span class="hljs-number">64</span>)<br><span class="hljs-number">2.0</span><br></code></pre></td></tr></table></figure><p>The approximation error in all of these computations can be reduced by changing the <code>tolerance</code> in <code>approx_eq</code> to a smaller number.</p><p>As you experiment with Newton’s method, be aware that it will not always converge. The initial guess of <code>improve</code> must be sufficiently close to the zero, and various conditions about the function must be met. Despite this shortcoming, Newton’s method is a powerful general computational method for solving differentiable equations. Very fast algorithms for logarithms and large integer division employ variants of the technique in modern computers.</p><h3 id="1-6-6-Currying"><a href="#1-6-6-Currying" class="headerlink" title="1.6.6  Currying"></a>1.6.6  Currying</h3><p>We can use higher-order functions to convert a function that takes multiple arguments into a chain of functions that each take a single argument. More specifically, given a function <code>f(x, y)</code>, we can define a function <code>g</code> such that <code>g(x)(y)</code> is equivalent to <code>f(x, y)</code>. Here, <code>g</code> is a higher-order function that takes in a single argument <code>x</code> and returns another function that takes in a single argument <code>y</code>. This transformation is called <em>currying</em>.</p><p>As an example, we can define a curried version of the <code>pow</code> function:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">curried_pow</span>(<span class="hljs-params">x</span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">h</span>(<span class="hljs-params">y</span>):<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(x, y)<br>        <span class="hljs-keyword">return</span> h<br><span class="hljs-meta">&gt;&gt;&gt; </span>curried_pow(<span class="hljs-number">2</span>)(<span class="hljs-number">3</span>)<br><span class="hljs-number">8</span><br></code></pre></td></tr></table></figure><p>Some programming languages, such as Haskell, only allow functions that take a single argument, so the programmer must curry all multi-argument procedures. In more general languages such as Python, currying is useful when we require a function that takes in only a single argument. For example, the <em>map</em> pattern applies a single-argument function to a sequence of values. In later chapters, we will see more general examples of the map pattern, but for now, we can implement the pattern in a function:</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">&gt;&gt;&gt; def map_to_range(<span class="hljs-built_in">start</span>, <span class="hljs-keyword">end</span>, f):<br>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">start</span> &lt; <span class="hljs-keyword">end</span>:<br>            print(f(<span class="hljs-built_in">start</span>))<br>            <span class="hljs-built_in">start</span> = <span class="hljs-built_in">start</span> + <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>We can use <code>map_to_range</code> and <code>curried_pow</code> to compute the first ten powers of two, rather than specifically writing a function to do so:</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs lisp">&gt;&gt;&gt; map_to_range(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, curried_pow(<span class="hljs-number">2</span>))<br><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">4</span><br><span class="hljs-number">8</span><br><span class="hljs-number">16</span><br><span class="hljs-number">32</span><br><span class="hljs-number">64</span><br><span class="hljs-number">128</span><br><span class="hljs-number">256</span><br><span class="hljs-number">512</span><br></code></pre></td></tr></table></figure><p>We can similarly use the same two functions to compute powers of other numbers. Currying allows us to do so without writing a specific function for each number whose powers we wish to compute.</p><p>In the above examples, we manually performed the currying transformation on the <code>pow</code> function to obtain <code>curried_pow</code>. Instead, we can define functions to automate currying, as well as the inverse <em>uncurrying</em> transformation:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">curry2</span>(<span class="hljs-params">f</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;Return a curried version of the given two-argument function.&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">g</span>(<span class="hljs-params">x</span>):<br>            <span class="hljs-keyword">def</span> <span class="hljs-title function_">h</span>(<span class="hljs-params">y</span>):<br>                <span class="hljs-keyword">return</span> f(x, y)<br>            <span class="hljs-keyword">return</span> h<br>        <span class="hljs-keyword">return</span> g<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">uncurry2</span>(<span class="hljs-params">g</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;Return a two-argument version of the given curried function.&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x, y</span>):<br>            <span class="hljs-keyword">return</span> g(x)(y)<br>        <span class="hljs-keyword">return</span> f<br><span class="hljs-meta">&gt;&gt;&gt; </span>pow_curried = curry2(<span class="hljs-built_in">pow</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>pow_curried(<span class="hljs-number">2</span>)(<span class="hljs-number">5</span>)<br><span class="hljs-number">32</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>map_to_range(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, pow_curried(<span class="hljs-number">2</span>))<br><span class="hljs-number">1</span><br><span class="hljs-number">2</span><br><span class="hljs-number">4</span><br><span class="hljs-number">8</span><br><span class="hljs-number">16</span><br><span class="hljs-number">32</span><br><span class="hljs-number">64</span><br><span class="hljs-number">128</span><br><span class="hljs-number">256</span><br><span class="hljs-number">512</span><br></code></pre></td></tr></table></figure><p>The <code>curry2</code> function takes in a two-argument function <code>f</code> and returns a single-argument function <code>g</code>. When <code>g</code> is applied to an argument <code>x</code>, it returns a single-argument function <code>h</code>. When <code>h</code> is applied to <code>y</code>, it calls <code>f(x, y)</code>. Thus, <code>curry2(f)(x)(y)</code> is equivalent to <code>f(x, y)</code>. The <code>uncurry2</code> function reverses the currying transformation, so that <code>uncurry2(curry2(f))</code> is equivalent to <code>f</code>.</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode">&gt;&gt;&gt; u<span class="hljs-symbol">ncurry2</span><span class="hljs-comment">(pow_curried)</span><span class="hljs-comment">(2, 5)</span><br><span class="hljs-number">32</span><br></code></pre></td></tr></table></figure><h3 id="1-6-7-Lambda-Expressions"><a href="#1-6-7-Lambda-Expressions" class="headerlink" title="1.6.7  Lambda Expressions"></a>1.6.7  Lambda Expressions</h3><p>So far, each time we have wanted to define a new function, we needed to give it a name. But for other types of expressions, we don’t need to associate intermediate values with a name. That is, we can compute <code>a*b + c*d</code> without having to name the subexpressions <code>a*b</code> or <code>c*d</code>, or the full expression. In Python, we can create function values on the fly using <code>lambda</code> expressions, which evaluate to unnamed functions. A lambda expression evaluates to a function that has a single return expression as its body. Assignment and control statements are not allowed.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">compose1</span>(<span class="hljs-params">f, g</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> x: f(g(x))<br></code></pre></td></tr></table></figure><p>We can understand the structure of a <code>lambda</code> expression by constructing a corresponding English sentence:</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs isbl">     <span class="hljs-variable">lambda</span>            <span class="hljs-variable">x</span>            :          <span class="hljs-function"><span class="hljs-title">f</span>(<span class="hljs-title">g</span>(<span class="hljs-variable">x</span>))</span><br><span class="hljs-string">&quot;A function that    takes x    and returns     f(g(x))&quot;</span><br></code></pre></td></tr></table></figure><p>The result of a lambda expression is called a lambda function. It has no intrinsic name (and so Python prints <code>&lt;lambda&gt;</code> for the name), but otherwise it behaves like any other function.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">s = <span class="hljs-keyword">lambda</span> x: x * x</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">s</span><br>&lt;function &lt;lambda&gt; at 0xf3f490&gt;<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">s(<span class="hljs-number">12</span>)</span><br>144<br></code></pre></td></tr></table></figure><p>In an environment diagram, the result of a lambda expression is a function as well, named with the greek letter λ (lambda). Our compose example can be expressed quite compactly with lambda expressions.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191822583.png"></p><p>Some programmers find that using unnamed functions from lambda expressions to be shorter and more direct. However, compound <code>lambda</code> expressions are notoriously illegible, despite their brevity. The following definition is correct, but many programmers have trouble understanding it quickly.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">compose1 = <span class="hljs-keyword">lambda</span> f,g: <span class="hljs-keyword">lambda</span> x: f(g(x))</span><br></code></pre></td></tr></table></figure><p>In general, Python style prefers explicit <code>def</code> statements to lambda expressions, but allows them in cases where a simple function is needed as an argument or return value.</p><p>Such stylistic rules are merely guidelines; you can program any way you wish. However, as you write programs, think about the audience of people who might read your program one day. When you can make your program easier to understand, you do those people a favor.</p><p>The term <em>lambda</em> is a historical accident resulting from the incompatibility of written mathematical notation and the constraints of early type-setting systems.</p><blockquote><p>It may seem perverse to use lambda to introduce a procedure&#x2F;function. The notation goes back to Alonzo Church, who in the 1930’s started with a “hat” symbol; he wrote the square function as “ŷ . y × y”. But frustrated typographers moved the hat to the left of the parameter and changed it to a capital lambda: “Λy . y × y”; from there the capital lambda was changed to lowercase, and now we see “λy . y × y” in math books and <code>(lambda (y) (* y y))</code> in Lisp.</p><p>—Peter Norvig (norvig.com&#x2F;lispy2.html)</p></blockquote><p>Despite their unusual etymology, <code>lambda</code> expressions and the corresponding formal language for function application, the <em>lambda calculus</em>, are fundamental computer science concepts shared far beyond the Python programming community. We will revisit this topic when we study the design of interpreters in Chapter 3.</p><h3 id="1-6-8-Abstractions-and-First-Class-Functions"><a href="#1-6-8-Abstractions-and-First-Class-Functions" class="headerlink" title="1.6.8  Abstractions and First-Class Functions"></a>1.6.8  Abstractions and First-Class Functions</h3><p>We began this section with the observation that user-defined functions are a crucial abstraction mechanism, because they permit us to express general methods of computing as explicit elements in our programming language. Now we’ve seen how higher-order functions permit us to manipulate these general methods to create further abstractions.</p><p>As programmers, we should be alert to opportunities to identify the underlying abstractions in our programs, build upon them, and generalize them to create more powerful abstractions. This is not to say that one should always write programs in the most abstract way possible; expert programmers know how to choose the level of abstraction appropriate to their task. But it is important to be able to think in terms of these abstractions, so that we can be ready to apply them in new contexts. The significance of higher-order functions is that they enable us to represent these abstractions explicitly as elements in our programming language, so that they can be handled just like other computational elements.</p><p>In general, programming languages impose restrictions on the ways in which computational elements can be manipulated. Elements with the fewest restrictions are said to have first-class status. Some of the “rights and privileges” of first-class elements are:</p><ol><li>They may be bound to names.</li><li>They may be passed as arguments to functions.</li><li>They may be returned as the results of functions.</li><li>They may be included in data structures.</li></ol><p>Python awards functions full first-class status, and the resulting gain in expressive power is enormous.</p><h3 id="1-6-9-Function-Decorators"><a href="#1-6-9-Function-Decorators" class="headerlink" title="1.6.9  Function Decorators"></a>1.6.9  Function Decorators</h3><p>Python provides special syntax to apply higher-order functions as part of executing a <code>def</code> statement, called a decorator. Perhaps the most common example is a trace.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">trace</span>(<span class="hljs-params">fn</span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapped</span>(<span class="hljs-params">x</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;-&gt; &#x27;</span>, fn, <span class="hljs-string">&#x27;(&#x27;</span>, x, <span class="hljs-string">&#x27;)&#x27;</span>)<br>            <span class="hljs-keyword">return</span> fn(x)<br>        <span class="hljs-keyword">return</span> wrapped<br><span class="hljs-meta">&gt;&gt;&gt; </span>@trace<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">triple</span>(<span class="hljs-params">x</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">3</span> * x<br><span class="hljs-meta">&gt;&gt;&gt; </span>triple(<span class="hljs-number">12</span>)<br>-&gt;  &lt;function triple at <span class="hljs-number">0x102a39848</span>&gt; ( <span class="hljs-number">12</span> )<br><span class="hljs-number">36</span><br></code></pre></td></tr></table></figure><p>In this example, A higher-order function <code>trace</code> is defined, which returns a function that precedes a call to its argument with a <code>print</code> statement that outputs the argument. The <code>def</code> statement for <code>triple</code> has an annotation, <code>@trace</code>, which affects the execution rule for <code>def</code>. As usual, the function <code>triple</code> is created. However, the name <code>triple</code> is not bound to this function. Instead, the name <code>triple</code> is bound to the returned function value of calling <code>trace</code> on the newly defined <code>triple</code> function. In code, this decorator is equivalent to:</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">triple</span>(<span class="hljs-params">x</span>):</span><br>        return 3 * x<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">triple = trace(triple)</span><br></code></pre></td></tr></table></figure><p>In the projects associated with this text, decorators are used for tracing, as well as selecting which functions to call when a program is run from the command line.</p><p><strong>Extra for experts.</strong> The decorator symbol <code>@</code> may also be followed by a call expression. The expression following <code>@</code> is evaluated first (just as the name <code>trace</code> was evaluated above), the <code>def</code> statement second, and finally the result of evaluating the decorator expression is applied to the newly defined function, and the result is bound to the name in the <code>def</code> statement. A <a href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/50_function_decorators.html">short tutorial on decorators</a> by Ariel Ortiz gives further examples for interested students.</p><h2 id="1-7-Recursive-Functions"><a href="#1-7-Recursive-Functions" class="headerlink" title="1.7  Recursive Functions"></a>1.7  Recursive Functions</h2><p>A function is called <em>recursive</em> if the body of the function calls the function itself, either directly or indirectly. That is, the process of executing the body of a recursive function may in turn require applying that function again. Recursive functions do not use any special syntax in Python, but they do require some effort to understand and create.</p><p>We’ll begin with an example problem: write a function that sums the digits of a natural number. When designing recursive functions, we look for ways in which a problem can be broken down into simpler problems. In this case, the operators <code>%</code> and <code>//</code> can be used to separate a number into two parts: its last digit and all but its last digit.</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-number">18117</span> % <span class="hljs-number">10</span></span><br>7<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-number">18117</span> // <span class="hljs-number">10</span></span><br>1811<br></code></pre></td></tr></table></figure><p>The sum of the digits of 18117 is <code>1+8+1+1+7 = 18</code>. Just as we can separate the number, we can separate this sum into the last digit, 7, and the sum of all but the last digit, <code>1+8+1+1 = 11</code>. This separation gives us an algorithm: to sum the digits of a number <code>n</code>, add its last digit <code>n % 10</code> to the sum of the digits of <code>n // 10</code>. There’s one special case: if a number has only one digit, then the sum of its digits is itself. This algorithm can be implemented as a recursive function.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">sum_digits</span>(<span class="hljs-params">n</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;Return the sum of the digits of positive integer n.&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">10</span>:<br>            <span class="hljs-keyword">return</span> n<br>        <span class="hljs-keyword">else</span>:<br>            all_but_last, last = n // <span class="hljs-number">10</span>, n % <span class="hljs-number">10</span><br>            <span class="hljs-keyword">return</span> sum_digits(all_but_last) + last<br></code></pre></td></tr></table></figure><p>This definition of <code>sum_digits</code> is both complete and correct, even though the <code>sum_digits</code> function is called within its own body. The problem of summing the digits of a number is broken down into two steps: summing all but the last digit, then adding the last digit. Both of these steps are simpler than the original problem. The function is recursive because the first step is the same kind of problem as the original problem. That is, <code>sum_digits</code> is exactly the function we need in order to implement <code>sum_digits</code>.</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs isbl">&gt;&gt;&gt; <span class="hljs-function"><span class="hljs-title">sum_digits</span>(<span class="hljs-number">9</span>)</span><br><span class="hljs-number">9</span><br>&gt;&gt;&gt; <span class="hljs-function"><span class="hljs-title">sum_digits</span>(<span class="hljs-number">18117</span>)</span><br><span class="hljs-number">18</span><br>&gt;&gt;&gt; <span class="hljs-function"><span class="hljs-title">sum_digits</span>(<span class="hljs-number">9437184</span>)</span><br><span class="hljs-number">36</span><br>&gt;&gt;&gt; <span class="hljs-function"><span class="hljs-title">sum_digits</span>(<span class="hljs-number">11408855402054064613470328848384</span>)</span><br><span class="hljs-number">126</span><br></code></pre></td></tr></table></figure><p>We can understand precisely how this recursive function applies successfully using our environment model of computation. No new rules are required.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191845912.png"></p><p>When the <code>def</code> statement is executed, the name <code>sum_digits</code> is bound to a new function, but the body of that function is not yet executed. Therefore, the circular nature of <code>sum_digits</code> is not a problem yet. Then, <code>sum_digits</code> is called on 738:</p><ol><li><p>A local frame for <code>sum_digits</code> with <code>n</code> bound to 738 is created, and the body of <code>sum_digits</code> is executed in the environment that starts with that frame.</p></li><li><p>Since 738 is not less than 10, the assignment statement on line 4 is executed, splitting 738 into 73 and 8.</p></li><li><p>In the following return statement, <code>sum_digits</code> is called on 73, the value of <code>all_but_last</code> in the current environment.</p></li><li><p>Another local frame for <code>sum_digits</code> is created, this time with <code>n</code> bound to 73. The body of <code>sum_digits</code> is again executed in the new environment that starts with this frame.</p></li><li><p>Since 73 is also not less than 10, 73 is split into 7 and 3 and <code>sum_digits</code> is called on 7, the value of <code>all_but_last</code> evaluated in this frame.</p></li><li><p>A third local frame for <code>sum_digits</code> is created, with <code>n</code> bound to 7.</p></li><li><p>In the environment starting with this frame, it is true that <code>n &lt; 10</code>, and therefore 7 is returned.</p></li><li><p>In the second local frame, this return value 7 is summed with 3, the value of <code>last</code>, to return 10.</p></li><li><p>In the first local frame, this return value 10 is summed with 8, the value of <code>last</code>, to return 18.</p></li></ol><p>This recursive function applies correctly, despite its circular character, because it is applied twice, but with a different argument each time. Moreover, the second application was a simpler instance of the digit summing problem than the first. Generate the environment diagram for the call <code>sum_digits(18117)</code> to see that each successive call to <code>sum_digits</code> takes a smaller argument than the last, until eventually a single-digit input is reached.</p><p>This example also illustrates how functions with simple bodies can evolve complex computational processes by using recursion.</p><h3 id="1-7-1-The-Anatomy-of-Recursive-Functions"><a href="#1-7-1-The-Anatomy-of-Recursive-Functions" class="headerlink" title="1.7.1  The Anatomy of Recursive Functions"></a>1.7.1  The Anatomy of Recursive Functions</h3><p>A common pattern can be found in the body of many recursive functions. The body begins with a <em>base case</em>, a conditional statement that defines the behavior of the function for the inputs that are simplest to process. In the case of <code>sum_digits</code>, the base case is any single-digit argument, and we simply return that argument. Some recursive functions will have multiple base cases.</p><p>The base cases are then followed by one or more <em>recursive calls</em>. Recursive calls always have a certain character: they simplify the original problem. Recursive functions express computation by simplifying problems incrementally. For example, summing the digits of 7 is simpler than summing the digits of 73, which in turn is simpler than summing the digits of 738. For each subsequent call, there is less work left to be done.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191846494.png"></p><p>A natural implementation using a <code>while</code> statement accumulates the total by multiplying together each positive integer up to <code>n</code>.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">fact_iter</span>(<span class="hljs-params">n</span>):<br>        total, k = <span class="hljs-number">1</span>, <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> k &lt;= n:<br>            total, k = total * k, k + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> total<br><span class="hljs-meta">&gt;&gt;&gt; </span>fact_iter(<span class="hljs-number">4</span>)<br><span class="hljs-number">24</span><br></code></pre></td></tr></table></figure><p>On the other hand, a recursive implementation of factorial can express <code>fact(n)</code> in terms of <code>fact(n-1)</code>, a simpler problem. The base case of the recursion is the simplest form of the problem: <code>fact(1)</code> is 1.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191846347.png"></p><p>These two factorial functions differ conceptually. The iterative function constructs the result from the base case of 1 to the final total by successively multiplying in each term. The recursive function, on the other hand, constructs the result directly from the final term, <code>n</code>, and the result of the simpler problem, <code>fact(n-1)</code>.</p><p>As the recursion “unwinds” through successive applications of the <em>fact</em> function to simpler and simpler problem instances, the result is eventually built starting from the base case. The recursion ends by passing the argument 1 to <code>fact</code>; the result of each call depends on the next until the base case is reached.</p><p>The correctness of this recursive function is easy to verify from the standard definition of the mathematical function for factorial:</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191846534.png"></p><p>While we can unwind the recursion using our model of computation, it is often clearer to think about recursive calls as functional abstractions. That is, we should not care about how <code>fact(n-1)</code> is implemented in the body of <code>fact</code>; we should simply trust that it computes the factorial of <code>n-1</code>. Treating a recursive call as a functional abstraction has been called a <em>recursive leap of faith</em>. We define a function in terms of itself, but simply trust that the simpler cases will work correctly when verifying the correctness of the function. In this example, we trust that <code>fact(n-1)</code> will correctly compute <code>(n-1)!</code>; we must only check that <code>n!</code> is computed correctly if this assumption holds. In this way, verifying the correctness of a recursive function is a form of proof by induction.</p><p>The functions <em>fact_iter</em> and <em>fact</em> also differ because the former must introduce two additional names, <code>total</code> and <code>k</code>, that are not required in the recursive implementation. In general, iterative functions must maintain some local state that changes throughout the course of computation. At any point in the iteration, that state characterizes the result of completed work and the amount of work remaining. For example, when <code>k</code> is 3 and total is 2, there are still two terms remaining to be processed, 3 and 4. On the other hand, <em>fact</em> is characterized by its single argument <code>n</code>. The state of the computation is entirely contained within the structure of the environment, which has return values that take the role of <code>total</code>, and binds <code>n</code> to different values in different frames rather than explicitly tracking <code>k</code>.</p><p>Recursive functions leverage the rules of evaluating call expressions to bind names to values, often avoiding the nuisance of correctly assigning local names during iteration. For this reason, recursive functions can be easier to define correctly. However, learning to recognize the computational processes evolved by recursive functions certainly requires practice.</p><h3 id="1-7-2-Mutual-Recursion"><a href="#1-7-2-Mutual-Recursion" class="headerlink" title="1.7.2  Mutual Recursion"></a>1.7.2  Mutual Recursion</h3><p>When a recursive procedure is divided among two functions that call each other, the functions are said to be <em>mutually recursive</em>. As an example, consider the following definition of even and odd for non-negative integers:</p><ul><li>a number is even if it is one more than an odd number</li><li>a number is odd if it is one more than an even number</li><li>0 is even</li></ul><p>Using this definition, we can implement mutually recursive functions to determine whether a number is even or odd:</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191847202.png"></p><p>Mutually recursive functions can be turned into a single recursive function by breaking the abstraction boundary between the two functions. In this example, the body of <code>is_odd</code> can be incorporated into that of <code>is_even</code>, making sure to replace <code>n</code> with <code>n-1</code> in the body of <code>is_odd</code> to reflect the argument passed into it:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_even</span>(<span class="hljs-params">n</span>):<br>        <span class="hljs-keyword">if</span> n == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">if</span> (n-<span class="hljs-number">1</span>) == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">return</span> is_even((n-<span class="hljs-number">1</span>)-<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p>As such, mutual recursion is no more mysterious or powerful than simple recursion, and it provides a mechanism for maintaining abstraction within a complicated recursive program.</p><h3 id="1-7-3-Printing-in-Recursive-Functions"><a href="#1-7-3-Printing-in-Recursive-Functions" class="headerlink" title="1.7.3  Printing in Recursive Functions"></a>1.7.3  Printing in Recursive Functions</h3><p>The computational process evolved by a recursive function can often be visualized using calls to <code>print</code>. As an example, we will implement a function <code>cascade</code> that prints all prefixes of a number from largest to smallest to largest.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">cascade</span>(<span class="hljs-params">n</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;Print a cascade of prefixes of n.&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">10</span>:<br>            <span class="hljs-built_in">print</span>(n)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(n)<br>            cascade(n//<span class="hljs-number">10</span>)<br>            <span class="hljs-built_in">print</span>(n)<br><span class="hljs-meta">&gt;&gt;&gt; </span>cascade(<span class="hljs-number">2013</span>)<br><span class="hljs-number">2013</span><br><span class="hljs-number">201</span><br><span class="hljs-number">20</span><br><span class="hljs-number">2</span><br><span class="hljs-number">20</span><br><span class="hljs-number">201</span><br><span class="hljs-number">2013</span><br></code></pre></td></tr></table></figure><p>In this recursive function, the base case is a single-digit number, which is printed. Otherwise, a recursive call is placed between two calls to <code>print</code>.</p><p>It is not a rigid requirement that base cases be expressed before recursive calls. In fact, this function can be expressed more compactly by observing that <code>print(n)</code> is repeated in both clauses of the conditional statement, and therefore can precede it.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">cascade</span>(<span class="hljs-params">n</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;Print a cascade of prefixes of n.&quot;&quot;&quot;</span><br>        <span class="hljs-built_in">print</span>(n)<br>        <span class="hljs-keyword">if</span> n &gt;= <span class="hljs-number">10</span>:<br>            cascade(n//<span class="hljs-number">10</span>)<br>            <span class="hljs-built_in">print</span>(n)<br></code></pre></td></tr></table></figure><p>As another example of mutual recursion, consider a two-player game in which there are <code>n</code> initial pebbles on a table. The players take turns, removing either one or two pebbles from the table, and the player who removes the final pebble wins. Suppose that Alice and Bob play this game, each using a simple strategy:</p><ul><li>Alice always removes a single pebble</li><li>Bob removes two pebbles if an even number of pebbles is on the table, and one otherwise</li></ul><p>Given <code>n</code> initial pebbles and Alice starting, who wins the game?</p><p>A natural decomposition of this problem is to encapsulate each strategy in its own function. This allows us to modify one strategy without affecting the other, maintaining the abstraction barrier between the two. In order to incorporate the turn-by-turn nature of the game, these two functions call each other at the end of each turn.</p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs isbl">&gt;&gt;&gt; <span class="hljs-variable">def</span> <span class="hljs-function"><span class="hljs-title">play_alice</span>(<span class="hljs-variable">n</span>):</span><br><span class="hljs-function">        <span class="hljs-variable"><span class="hljs-keyword">if</span></span> <span class="hljs-variable">n</span> == <span class="hljs-number">0</span>:</span><br><span class="hljs-function">            <span class="hljs-title">print</span>(<span class="hljs-string">&quot;Bob wins!&quot;</span>)</span><br>        <span class="hljs-variable"><span class="hljs-keyword">else</span></span>:<br>            <span class="hljs-function"><span class="hljs-title">play_bob</span>(<span class="hljs-variable">n</span>-<span class="hljs-number">1</span>)</span><br>&gt;&gt;&gt; <span class="hljs-variable">def</span> <span class="hljs-function"><span class="hljs-title">play_bob</span>(<span class="hljs-variable">n</span>):</span><br><span class="hljs-function">        <span class="hljs-variable"><span class="hljs-keyword">if</span></span> <span class="hljs-variable">n</span> == <span class="hljs-number">0</span>:</span><br><span class="hljs-function">            <span class="hljs-title">print</span>(<span class="hljs-string">&quot;Alice wins!&quot;</span>)</span><br>        <span class="hljs-variable">elif</span> <span class="hljs-function"><span class="hljs-title">is_even</span>(<span class="hljs-variable">n</span>):</span><br><span class="hljs-function">            <span class="hljs-title">play_alice</span>(<span class="hljs-variable">n</span>-<span class="hljs-number">2</span>)</span><br>        <span class="hljs-variable"><span class="hljs-keyword">else</span></span>:<br>            <span class="hljs-function"><span class="hljs-title">play_alice</span>(<span class="hljs-variable">n</span>-<span class="hljs-number">1</span>)</span><br>&gt;&gt;&gt; <span class="hljs-function"><span class="hljs-title">play_alice</span>(<span class="hljs-number">20</span>)</span><br><span class="hljs-variable">Bob</span> <span class="hljs-variable">wins</span><span class="hljs-variable">!</span><br></code></pre></td></tr></table></figure><p>In <code>play_bob</code>, we see that multiple recursive calls may appear in the body of a function. However, in this example, each call to <code>play_bob</code> calls <code>play_alice</code> at most once. In the next section, we consider what happens when a single function call makes multiple direct recursive calls.</p><h3 id="1-7-4-Tree-Recursion"><a href="#1-7-4-Tree-Recursion" class="headerlink" title="1.7.4  Tree Recursion"></a>1.7.4  Tree Recursion</h3><p>Another common pattern of computation is called tree recursion, in which a function calls itself more than once. As an example, consider computing the sequence of Fibonacci numbers, in which each number is the sum of the preceding two.</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307191848392.png"></p><p>This recursive definition is tremendously appealing relative to our previous attempts: it exactly mirrors the familiar definition of Fibonacci numbers. A function with multiple recursive calls is said to be <em>tree recursive</em> because each call branches into multiple smaller calls, each of which branches into yet smaller calls, just as the branches of a tree become smaller but more numerous as they extend from the trunk.</p><p>We were already able to define a function to compute Fibonacci numbers without tree recursion. In fact, our previous attempts were more efficient, a topic discussed later in the text. Next, we consider a problem for which the tree recursive solution is substantially simpler than any iterative alternative.</p><h3 id="1-7-5-Example-Partitions"><a href="#1-7-5-Example-Partitions" class="headerlink" title="1.7.5  Example: Partitions"></a>1.7.5  Example: Partitions</h3><p>The number of partitions of a positive integer <code>n</code>, using parts up to size <code>m</code>, is the number of ways in which <code>n</code> can be expressed as the sum of positive integer parts up to <code>m</code> in increasing order. For example, the number of partitions of 6 using parts up to 4 is 9.</p><ol><li><code>6 = 2 + 4</code></li><li><code>6 = 1 + 1 + 4</code></li><li><code>6 = 3 + 3</code></li><li><code>6 = 1 + 2 + 3</code></li><li><code>6 = 1 + 1 + 1 + 3</code></li><li><code>6 = 2 + 2 + 2</code></li><li><code>6 = 1 + 1 + 2 + 2</code></li><li><code>6 = 1 + 1 + 1 + 1 + 2</code></li><li><code>6 = 1 + 1 + 1 + 1 + 1 + 1</code></li></ol><p>We will define a function <code>count_partitions(n, m)</code> that returns the number of different partitions of <code>n</code> using parts up to <code>m</code>. This function has a simple solution as a tree-recursive function, based on the following observation:</p><p>The number of ways to partition <code>n</code> using integers up to <code>m</code> equals</p><ol><li>the number of ways to partition <code>n-m</code> using integers up to <code>m</code>, and</li><li>the number of ways to partition <code>n</code> using integers up to <code>m-1</code>.</li></ol><p>To see why this is true, observe that all the ways of partitioning <code>n</code> can be divided into two groups: those that include at least one <code>m</code> and those that do not. Moreover, each partition in the first group is a partition of <code>n-m</code>, followed by <code>m</code> added at the end. In the example above, the first two partitions contain 4, and the rest do not.</p><p>Therefore, we can recursively reduce the problem of partitioning <code>n</code> using integers up to <code>m</code> into two simpler problems: (1) partition a smaller number <code>n-m</code>, and (2) partition with smaller components up to <code>m-1</code>.</p><p>To complete the implementation, we need to specify the following base cases:</p><ol><li>There is one way to partition 0: include no parts.</li><li>There are 0 ways to partition a negative <code>n</code>.</li><li>There are 0 ways to partition any <code>n</code> greater than 0 using parts of size 0 or less.</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">def</span> <span class="hljs-title function_">count_partitions</span>(<span class="hljs-params">n, m</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;Count the ways to partition n using parts up to m.&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">if</span> n == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> n &lt; <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>        <span class="hljs-keyword">elif</span> m == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> count_partitions(n-m, m) + count_partitions(n, m-<span class="hljs-number">1</span>)<br><span class="hljs-meta">&gt;&gt;&gt; </span>count_partitions(<span class="hljs-number">6</span>, <span class="hljs-number">4</span>)<br><span class="hljs-number">9</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>count_partitions(<span class="hljs-number">5</span>, <span class="hljs-number">5</span>)<br><span class="hljs-number">7</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>count_partitions(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>)<br><span class="hljs-number">42</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>count_partitions(<span class="hljs-number">15</span>, <span class="hljs-number">15</span>)<br><span class="hljs-number">176</span><br><span class="hljs-meta">&gt;&gt;&gt; </span>count_partitions(<span class="hljs-number">20</span>, <span class="hljs-number">20</span>)<br><span class="hljs-number">627</span><br></code></pre></td></tr></table></figure><p>We can think of a tree-recursive function as exploring different possibilities. In this case, we explore the possibility that we use a part of size <code>m</code> and the possibility that we do not. The first and second recursive calls correspond to these possibilities.</p><p>Implementing this function without recursion would be substantially more involved. Interested readers are encouraged to try.</p>]]></content>
    
    
    <summary type="html">Composing Programs by John DeNero, based on the textbook Structure and Interpretation of Computer Programs by Harold Abelson and Gerald Jay Sussman.</summary>
    
    
    
    <category term="Major" scheme="https://www.0co.dev/categories/Major/"/>
    
    <category term="CS61A" scheme="https://www.0co.dev/categories/Major/CS61A/"/>
    
    
    <category term="CS61A" scheme="https://www.0co.dev/tags/CS61A/"/>
    
  </entry>
  
  <entry>
    <title>虚拟的山河大学与真实的教育困境</title>
    <link href="https://www.0co.dev/ShanHe-University-Review/"/>
    <id>https://www.0co.dev/ShanHe-University-Review/</id>
    <published>2023-07-16T12:35:40.000Z</published>
    <updated>2023-10-31T03:06:22.000Z</updated>
    
    <content type="html"><![CDATA[<p class='note note-success'>本文转载自虎嗅年轻内容公众号“那個NG”（ID：huxiu4youth)。</p><p>七月是高考的回响。<br>这个夏天，一座虚拟的大学在互联网世界拔地而起，这座学校名叫“山河大学”，只收留心碎的“山河四省”考生。<br>寒门、普通家庭、教育资源、分配公平。当山河大学的玩笑被互联网遗忘之后，那些心酸的个体，继续用一生消化高考的梦魇。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307162037969.jpeg"></p><p>山河大学，顾名思义是山河四省的大学，由河北、河南、山东和山西的考生共同在互联网拟建而成。这所虚拟大学只招收山河四省的考生。原因很简单，作为高考大省，他们的教育资源却匮乏得可怜。以2023年的数据为例，河北、河南、山东和山西的高考报名人数分别为83万、131万、80万和33.7万人，合计327.7万人，约占全国考生人数的25%。</p><p>在四省范围内，只有4所211高校、2所985高校（且唯二的985高校都位于山东)。河南、河北、山西三省总人口约2亿，却无一所985院校。河南仅有一所211高校郑州大学，已经是许多留在省内的河南考生能够触及的天花板。</p><p>华南师范大学教授林勇通过整理2018年各省份录取数据后，以清华北大的录取率来看，靠前的是：北京（0.603%）、天津（0.135%）、上海（0.098%），排名最后五位的省份里，河北（0.016%）、河南（0.014%）均榜上有名。</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307162037063.jpeg" alt="7月6日，教育部回应“山河大学”"></p><p>于是这些曾经淋过雨的年轻人大胆设想，我们是不是能为后来人撑伞——如果四省考生每人出资1000元，就能筹集三十多亿的资金，可以建立一所位于四省交界处的综合性大学。</p><p>号召一出，一呼百应，那些已经毕业的山河四省考生，甚至是外省的路人，都愿意为这所根本不存在的大学众筹捐款。于是，“上午看到了想法，中午看到了方案，下午看到了校徽，晚上看到了宿舍。”</p><p><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307162045402.jpeg" alt="山河大学的“官网”页面"></p><p> 选址就在四省的交界处，官网、校徽、校训、校歌、录取通知书、校园平面图在几天之内迅速落地。甚至他们还建立了山河大学的社群，组建起了研究生院、文学院、艺术学院、法学院、材料学院等等。除了认领各院院长的职位，甚至还有人竞聘宿管和保安。这些散落全国各地的山河四省学子们，陷入一个明知是梦的梦：解救和自己一样受困于教育资源的年轻人，打捞那个苦读十年却仍然追不上别人起点的自己。</p><p> 至于山河大学的校长为什么是杜甫，或许是因为“国破山河在”恰好有“山河”二字；但另一个原因更让人信服。杜甫写过那句“安得广厦千万间，大庇天下寒士俱欢颜”。这座虚拟大学，变成了山河四省“高考弃儿”们的应许之地。</p><p>它的简介朴素而有力：让每一个山河四省的学子都“有学上”。他们在学校简介上勾勒着一个理想大学：宿舍有空调、上床下桌、独立卫浴、食堂低价美味、专业有趣、师资雄厚。现实中确实存在这样的大学，但对于普通的山河四省考生来说，想要进入这样的大学，必须以外省人想象不到的难度，扒几层皮去攀爬应试教育的金字塔尖。</p><p> 进入大学之前，我以为我为了应试教育付出的前18年已经够悲苦了。直到我遇到了来自山东与河南的同班同学。他们的分数比我高几十分，但我们坐在同一间教室、同一间宿舍。因为大部分学校的招生计划都会优先面向省内，所以其他省份的招生名额更少。所以山河四省的学子要出省上大学，就必须考取比本地学生更高的分数。与此同时，班里也有来自北京与天津的同学。不能否认他们也很努力，但童年付出的劳累与代价，是无法和来自山河四省的同学相提并论的。这就像“辛苦”与“痛苦”的差别，中国孩子都苦，但程度不同。所以在招生简章里，你能看到山河四省的学子们积压已久的愤懑：山河四省考生可直接报名，除四省以外其他省考生需高考达到700分。这是一种对过往不公的回击，哪怕只是在精神层面上的回击。</p><p>教育资源优渥地区的考生，无法理解什么叫“夺命21次模考”，无法理解衡水模式会给一个人带来一生的阴影，也无法理解什么叫“一分恨不得掰成三分去报志愿”。 我认识一位衡水一中的毕业生，十年前她高考，省排名在50名左右，但在班里，连前10名都没挤进去。残酷如斯。这些来自应试教育和大逃杀模式的疤痕，即便到了30岁，仍然摸上去新鲜滚烫，让他们即便步入社会，也活得像一只全身紧绷的猫，总是夜半梦回跑操背书的凌晨5点。这是教育资源的天堑，只能由这亿万个个体慢慢消化。“小明用了2小时走到少年宫，而我用了18年。”</p><p> 张雪峰和山河大学，就像一个杨桃的两个切面，尝起来都是同样的苦涩。正是有了教育资源分配不公，才有了民间的“志愿圣人”张雪峰。<br> 一句“理科590分学新闻就把他打晕”把张雪峰送上了高考后的第一波热搜。</p><p>而这句话引起的波澜更有趣。在一则十几秒的视频里，一位大学生拿出自己的学生证，大喊一声：“不要听张雪峰那小子的话啊！”新闻学卓越人才实验班，五院四系，华东政法大学，毕业后直接“黄袍加身”送外卖，就业率“百分之百”。到此为止，到底要不要学新闻的争议，才完成了完美的闭环。</p><p> <img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307162038769.jpeg" alt="图源：B站"></p><p> 太多人争论人文社科到底是不是无用学科。但我更在意“不要学新闻”背后的半句话—— <strong>“如果家境优渥，选择更多，不存在错不错的问题。但是大多数家庭，条件没有那么好，选专业就要选适合自己的，能让自己吃上饭的。”</strong></p><p> <img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307162039623.jpeg" alt="图源：微博"></p><p> 问题争议不在于专业本身，而是张雪峰的受众群体，是广大普通家庭的普通考生。有人调侃道，你猜国家电网的家长会不会去挤张雪峰的直播间？ 当知识分子指责张雪峰市侩、势力、摧毁年轻人的理想主义的时候，我的建议是不妨去他的直播间里静坐一晚。 你自以为是常识的东西，放在大多数普通人身上，变成了一望无际的信息差。就像前几天流传的一则“感人视频”：一位甘肃白银的考生填志愿，父亲说，只要是带“人民”两个字的都报。</p><p> 他的建议虽然只是一家之言，不一定正确，不一定帮得了所有人，但或多或少能把许多缺乏基础认知的家庭从晃晃悠悠的钢丝上拽一把。一位母亲想让女儿当空姐，上来就问张雪峰，500分能不能报考“航空航天”的专业。张雪峰疑惑地盘问了半天，才听懂家长是想送孩子去当空姐。原因也很简单。空姐听上去体面，据说很赚钱。张雪峰直接把最难听甚至得罪人的话撂在台面上：你们家孩子有底线吗？<br> 因为让一个有底线的人变得没有底线很容易，而让一个没底线的人变得有底线很难。如果孩子是一个内向缺乏主见的人，为什么非要把她丢进一个更容易被环境影响的行业中去？“为什么在能够把握命运的时候，非要去做一个服务员呢？”</p><p> 张雪峰还能在最短时间内，给一个普通家庭传递行业内部信息。 一位母亲拿着孩子的成绩来咨询，张雪峰在一秒之内给出答案：去滨州学院学机务专业，毕业对口修飞机，就差把“毕业包分配”说出口了。而在连麦之前，家长根本不知道有这所学校、有这门职业。而这所学校一旦改名为山东航空学院后，考生的500分成绩就不一定能够得上了。</p><p> 许多曾经属于利益圈层内部交流的信息，被张雪峰拿在台面上“委婉地”说透了。一位家长想让孩子进入国家电网工作，张雪峰明确地给出一句话： 如果你家里不是国家电网的子弟，那你只能学电气专业才能进，其他任何专业都不行；如果你家里是国家电网的职工，那你学一些相关的边缘专业也能进。而中国烟草更不同了。一位家长连麦，想让孩子通过学烟草专业进入中国烟草就业。张雪峰听完都笑了：烟草专业和烟草公司完全是两码事。</p><p> 他也能在最短时间内叫醒一个飘在云端的年轻人。有人看完《我在故宫修文物》就想学考古；看完《法医秦明》就想学法医；看完《华尔街之狼》就想学金融；看完《催眠大师》就想学心理学。</p><p> <strong>张雪峰给年轻人的梦中专业狠狠祛魅。</strong>有人想学法医。张雪峰告诉家长：能不能在装满腐肉的缸里待半个小时？接受了这个再谈法医的事。想学金融？家里能给资源支持吗？女孩能喝酒吗？性格够外向吗？这些问题看上去非常冒犯。但如果你随机抽取一名踏入金融行业的普通毕业生，他&#x2F;她一定明白张雪峰为何这么问。别人搞金融是华尔街之狼，你搞金融是国贸之牛马。你以为金融就是每天晚上美酒雪茄德州扑克，结果现在收入打折还要连夜通读掼蛋教程。家长总以为，跟钱有关的职业就一定能带来钱。但事实是，只要你的父母能在银行存够2000万，不管你是什么专业都能进银行。还有一位考生一心想学哲学，规划自己一路硕博，最终进高校当老师的美好人生——说得就像出门买菜那么轻巧，其中的痛苦、竞争和漫长的等待都被他丝滑绕开。张雪峰只是淡淡地问了他一句：将来吃不饱饭怎么办？学生沉默半晌回答：哦，我觉得不会的。</p><p> 一位女生称自己想学心理学，未来成为一名心理医生，开一家自己的心理咨询所。张雪峰连续抛出几个致命问题：“如果找不到工作你还学吗？” “北师大心理学毕业的都开不了自己的心理诊所，你觉得你这个分数段行吗？” “大多数的人都没有钱买房，没有钱过好自己的生活，你觉得他会给心理医生多少钱？” 有的家庭认为孩子英语成绩不错，想要学语言专业，以后就能进外交部。 张雪峰反问：“你知道有个东西叫做科大讯飞吗？” 甚至连外语院校的学生也在评论区现身说法： 那些真正进入外交部的人，绝不是老百姓想象中的“英语好的孩子”那么简单。即便是在一群外语天才里，又有几个能成功进入外交部工作？</p><p> 有学生想走中外合作办学，以后出国留学。 张雪峰的建议是，把这40万现金取出来，放在面前看一个小时。用父母的血汗钱换留学，值得吗？ 说白了就是那句最朴素的话：“谁家挣钱都不容易”。 因为走这条路的，既有家里不差钱的人，也有砸锅卖铁也要供孩子读书的普通人。他劝的是后者。</p><p> 在他的直播间里，家长们的开场白总是会出现一句：孩子有主见，孩子有个性，孩子不听我的。 于是张雪峰成为中国家长的代理人，把真话用最难听的方式说给最不愿意听真话的18岁孩子。 一位家长连麦，孩子能考600分，想要选一个不脏不累还能挣钱的专业，比如金融，可惜家里没有资源支持。 张雪峰在推荐了一系列专业后，最后确定学口腔是这个分数的最优选。 家长却支支吾吾：“孩子对口腔比较排斥，她嫌脏。” 画面中的张雪峰激动起来。他捧起面前的零食开始往镜头前砸：让她想象这些都是money，你问问她：还脏吗？ 挣钱这件事就没有不脏不累的。只不过“脏”的程度，“脏”的地方不一样罢了。 <strong>人在18岁这个年纪总会这样想：那个“站着把钱挣了”的例外，凭什么不是我？</strong> <strong>到了28岁才会晃过神来：原来，跪着挣钱的坑位都不多了。</strong></p><p> 其实，张雪峰并没有像大众刻板印象中那样，挥舞实用主义的大棒打死所有人。 大家都说他站在理想主义的反面，但他偶尔也有眼神一亮的时刻。 一个能考650分的女孩告诉家长，未来想学量子力学。甚至想好了以后要去中科院读博。优秀如此，家长还是长吁短叹：“这可怎么办”“毕竟是女孩”，不想让她走上科研这条险途。 但张雪峰却一反常态支持了这个女孩的决定。原因很简单，有些人读物理学可能是出于功利性质，想靠冷门专业冲一冲名校；而这个女生的追求非常纯粹：“我做科研不是想挣多少钱，也不是想搞多大贡献，就是单纯想比别人走得更远。”</p><p>说到底，张雪峰的方法论其实没有多么高深，普通人甚至也可以拿着这套“八连问”去帮身边的考生做排除题。 所有考生在连麦的流水线上，在几分钟内被迅速归类为几个因子：家庭条件、文科理科、分数高低、图稳定还是求赚钱。虽然被许多教育专家诟病此法不通人性，但不得不承认这套战术（在现阶段）非常高效，让评论区的大学生都为之惊叹：我就是这个专业的，张雪峰是真懂。学医吗？推荐口腔医学和临床医学，偶尔推荐中医。学农吗？推荐动物医学，偶尔推荐茶学和烟草。当老师吗？推荐国家免费师范生，非定向不能直接就业师范类一般不推荐，分低的推荐学前教育。 学文理兼招吗？推荐法学，会计，审计，财务管理，汉语言文学，分低的推荐护理。学理工科（不带化学物理)吗？推荐数学，统计，计算机。 学带化学的吗？推荐药学。学力学吗？推荐航空航天，机械，分低推荐交通类。学电学吗？推荐电子信息，电气自动化。除了这些，求稳定可以考军校，警校。想考公，直接报计算机、法学、财会、汉语言文学。当条条大路通牛马的时候，张雪峰至少还帮你指了一条“能快速省力当上牛马”的道路。在他的视频弹幕与评论区里，最常看到的话是：如果当年有张雪峰骂醒我就好了。渡人，而且专渡没有资源没有信息渠道的普通人，放在哪个朝代看，都算是大善事。<strong>毕竟有钱人各显神通，早就坐着游轮渡河了。</strong> <strong>张雪峰只不过是让穷人的小筏子尽量别翻船，因为他知道，这一翻可能什么都没了。</strong></p><p> 曾经，我经手过一个“对谈策划”。一边是北京某著名中学的毕业生，一边是小镇做题家。北京某著名中学的毕业生告诉我，记忆中的高中生活由社团、电影节和舞会组成。而小镇做题家的阵营，是我和我的同事们：一群挤破脑袋，牺牲了整个青春期，最后终于获得给北京房东打工资格的年轻人。北京某著名中学的春季舞会和衡水一中的食堂苦读都是教育的切面，人生早就在我们懵懂的时刻分野。</p><p>抖音上的家境富裕的18岁少年晒出了“不用高考组合”的合影，身穿晚礼服的他们分别去了伦敦、纽约和洛杉矶；而另一边，张雪峰的直播间挤满了等待连麦的家长，为了“不耽误孩子”，这些家长不惜在志愿咨询上花费上万元。他们朴素地希望孩子考出的每一分，都不要浪费在一个有就业危机的专业上。从某种角度来看，张雪峰甚至在为普通家庭做公益。除了他，哪个好心人会出力不讨好地替一个孩子量身打造就业路线？他推荐的专业，最后指向的都是就业，甚至把一个孩子未来的五险一金和结婚嫁娶都纳入考量。而这样的职业规划指导，在我们目前的教育系统中是空白的。</p><p>11年前的夏天，我也正在填报高考志愿。<br>而我的高中班主任的办公室大门，只会向冲击清北复交的尖子生、以及能够花钱读联合办学的富裕家庭打开。普通家庭、普通成绩的我，获得的志愿咨询时间只有10秒，以及一句：还行，你随便报吧。 回到家，我和父母三个人大眼瞪小眼。不要指望一个从未进入社会的18岁高中生，在几天之内就能确认自己未来的职业方向；也不要指望没有读过大学的工人父母，能够眼光犀利地为你预判未来十年的行业趋势。这时我看到了父母在前18年都未曾显现过的迷茫和无助：父母倾尽全力能托举你的时刻，从今天起，到此为止了。11年前没有抖音，也没有志愿指导，只有门户网站以及一本厚厚的院校手册。拿着纸和笔，就这么一个一个专业划过去。然后一头撞进一个自己完全不了解的专业中去。至于未来是坑是平地还是山坡，近似于赌博。<strong>家庭资源充足的人，父辈的人脉和文化资本就是最好的指导，他们会按照指定好的路线，进入一个家族成员熟悉的行业中去。家庭资源匮乏的人，举目四望，想问都不知道该问谁。</strong>运气好的人，选对了专业混到一口饭吃；运气不好的家庭，稀里糊涂选了一个就业前景一片黯淡的专业。四年后站在人才市场的洪流之中，都不知道自己到底是哪一步出错了。</p><p> 如何看待张雪峰和山河大学，最终还是不可免俗地变成一个阶层问题。家境殷实的人，学了艺术出了国，回国后能办独立画展。你问ta，究竟是理想重要还是饭碗重要，ta大概率会回答你：是坚持理想才有了ta如今的成就。 那如果换成山区的孩子、农村的孩子、县城的孩子呢？ 理想是一小部分人用来点缀人生的奢侈品。这句话非常政治不正确，不好听，却是事实。中国的精英阶层脚不沾地太久，许多从未就业过的教授、专家与知识分子们，指责张雪峰“污染”了某个专业，“亵渎”了高等教育，“忽悠”了考生家长们，甚至还不忘教育“大学生选专业不要以赚钱为标准”。</p><p>事实上，高等教育走到今天，提升自我价值的部分逐渐萎缩，如今已经彻底变成了筛选人才的技术工具。这个时候，张雪峰告诉你如果巧妙地利用工具为自己谋利，其实就是在教你，如何在最大程度上保全普通家庭前18年付出的教育成本。当然，他的建议不适用于所有人，但总有人能被他“捞”一把。职业规划教育，填补了那些欠缺社会资源与文化资本的普通家庭的空白。也许它现在以“网红老师”的面目出现，还不够完美，但至少也比没有强。</p><p>如果我今年18岁，我一定会看不惯张雪峰，他就像是我父母请来的爹味代理人和帮凶，满嘴功利主义和稳定至上。而现在我快要30岁，我向张雪峰妥协了：如果考生没有想法，父母帮不上忙，不妨听听他的建议。也许他给你指的路很乏味，但是他真的想让你挣到钱，有份工作糊口。张雪峰的直播间，或许就是普通家庭在命运之锤砸下来之前，能做的最后一次主动闪避。中国人朴素地相信着“教育改变命运”的道理，农耕文明流淌在我们血液里的规则，就是一份耕耘换来一分收获。从山河大学到张雪峰，七月份的争辩，背后藏着中国人最质朴的期盼——好的教育，就是让人拥有平等的资格，只要努力就能换来体面的未来。</p>]]></content>
    
    
    <summary type="html">本文转载自虎嗅年轻内容公众号“那個NG”（ID：huxiu4youth)。</summary>
    
    
    
    <category term="Daily" scheme="https://www.0co.dev/categories/Daily/"/>
    
    
    <category term="Daily" scheme="https://www.0co.dev/tags/Daily/"/>
    
  </entry>
  
  <entry>
    <title>怎样系统地学习CS61A——以CS61A（Fa22）为例</title>
    <link href="https://www.0co.dev/CS61A-How-to-Learn/"/>
    <id>https://www.0co.dev/CS61A-How-to-Learn/</id>
    <published>2023-07-14T09:11:53.000Z</published>
    <updated>2023-10-31T10:37:14.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Overview-1"><a href="#Overview-1" class="headerlink" title="Overview[1]"></a>Overview<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="[Syllabus & Course Policies | CS 61A Fall 2022 (berkeley.edu)](https://inst.eecs.berkeley.edu/~cs61a/fa22/articles/about/)">[1]</span></a></sup></h2><p>The <code>CS 61</code> series is an introduction to computer science, with particular emphasis on software and on machines from a programmer’s point of view.</p><ol><li><code>CS 61A</code> concentrates on the idea of abstraction, allowing the programmer to think in terms appropriate to the problem rather than in low-level operations dictated by the computer hardware.</li><li><code>CS 61B</code> deals with the more advanced engineering aspects of software, such as constructing and analyzing large programs.</li><li><code>CS 61C </code>focuses on machines and how they execute programs.</li></ol><p>In <code>CS 61A</code>, we are interested in teaching you about programming, not about how to use one particular programming language. We consider a series of techniques for managing program complexity, such as functional programming and object-oriented programming.</p><p><code>CS 61A</code> primarily uses the <code>Python 3</code> programming language. <code>Python</code> is a popular language in both industry and academia. It is also particularly well-suited to the task of exploring the topics taught in this course. It is an open-source language developed by a large volunteer community that prides itself on the diversity of its contributors.</p><p>Mastery of a particular programming language is a very useful side effect of <code>CS 61A</code>. However, our goal is not to dictate what language you use in your future endeavors. Instead, our hope is that once you have learned the concepts involved in programming, you will find that picking up a new programming language is but a few days’ work. In fact, you will be asked to learn at least two other languages, <code>Scheme</code> and <code>SQL</code>, during the course.</p><blockquote><p><code>CS 61</code> 系列是计算机科学的入门读物，尤其侧重于从程序员的角度介绍软件和机器。</p><ol><li><code>CS 61A</code>侧重于抽象概念，让程序员以适合问题的术语进行思考，而不是以计算机硬件规定的低级操作进行思考。</li><li><code>CS 61B </code>涉及软件更高级的工程方面，如构建和分析大型程序。</li><li><code>CS 61C</code> 侧重于机器及其如何执行程序。</li></ol><p>在 <code>CS 61A</code>中，我们感兴趣的是教你如何编程，而不是如何使用一种特定的编程语言。我们会考虑一系列管理程序复杂性的技术，如函数式编程和面向对象编程。</p><p><code>CS 61A</code>主要使用 <code>Python 3</code>编程语言。<code>Python</code>在工业界和学术界都很流行。它也特别适合探索本课程所教授的主题。它是一种开源语言，由一个庞大的志愿者社区开发，该社区以其贡献者的多样性而自豪。</p><p>掌握一门特定的编程语言是学习 <code>CS 61A</code>的一个非常有用的“副作用”。但是，我们的目标并不是规定您在未来的工作中使用哪种语言。相反，我们希望您一旦掌握了编程所涉及的概念，就会发现学习一门新的编程语言不过是几天的事情。事实上，在本课程中，您将被要求至少学习另外两种语言:<code>Scheme</code>和 <code>SQL</code>。</p></blockquote><h2 id="How-to-Learn"><a href="#How-to-Learn" class="headerlink" title="How to Learn"></a>How to Learn</h2><p>这是官方网站：</p><blockquote><p> <a href="https://inst.eecs.berkeley.edu/~cs61a/fa22/">CS 61A Fall 2022 (berkeley.edu)</a></p></blockquote><p>官方网站包含有录课视频链接，电子课本参考，以及课后练习（分为<code>homework</code>，<code>lab</code>，<code>project</code>，<code>discussion</code>【要求本校学生】四类），建议独立完成再结合他人答案思考，部分优秀大佬的答案真的能使人豁然开朗，下面是本人的答案，仅供参考：</p><blockquote><p><a href="https://github.com/MegaSuite/CS61A-Fall22">CS61A-FA22</a></p></blockquote><p>其中，官网中的电子课本链接可能由于DNS解析问题无法访问，在原有的链接前添加<code>www.</code>即可，或者参照我此篇文章：</p><blockquote><a href="/CS61A-Reference/" title="CS61A-Reference">CS61A-Reference</a></blockquote><p>教学视频中提到的<code>python-tutor</code>可以通过以下链接访问:</p><blockquote><p><a href="https://pythontutor.com/cp/composingprograms.html#mode=edit">Online Python Tutor - Composing Programs - Python 3</a></p></blockquote><p>对于某些造成我个人困扰的问题，我也在博客中进行了单独的文章分析，包括但不限于以下篇目：</p><blockquote><a href="/CS61A-lab03-Q5/" title="CS61A-lab03_Q5">CS61A-lab03_Q5</a></blockquote><blockquote><a href="/CS61A-lab03-ChurchNumeral/" title="CS61A-lab03-Q6_ChurchNumeral丘奇数">CS61A-lab03-Q6_ChurchNumeral丘奇数</a></blockquote><p><del>观看教学视频需要<em>科学上网</em>，都学这专业了，大概没人不会吧（</del></p><p>解决了这些问题，你就可以开始在知识的海洋里遨游了，相信我，<code>CS61A</code>不会让你失望，无论是课程的深度还是相关配套设施的用心程度，都不是某些只把升职放在心上的所谓国内讲师可以比的（我也不想这么说，但现实就是这样）。其他的相关问题，网上也有许多大佬进行了解答，这里就不做赘述了</p><div class="note note-primary">            <p>欢迎来到Ethereal State，祝你能愉悦地获得知识！</p>          </div><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://inst.eecs.berkeley.edu/~cs61a/fa22/articles/about/">Syllabus &amp; Course Policies | CS 61A Fall 2022 (berkeley.edu)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">The CS 61 series is an introduction to computer science, with particular emphasis on software and on machines from a programmer&#39;s point of view.</summary>
    
    
    
    <category term="Major" scheme="https://www.0co.dev/categories/Major/"/>
    
    <category term="CS61A" scheme="https://www.0co.dev/categories/Major/CS61A/"/>
    
    
    <category term="CS61A" scheme="https://www.0co.dev/tags/CS61A/"/>
    
  </entry>
  
  <entry>
    <title>CS61A-lab03-Q6_ChurchNumeral丘奇数</title>
    <link href="https://www.0co.dev/CS61A-lab03-ChurchNumeral/"/>
    <id>https://www.0co.dev/CS61A-lab03-ChurchNumeral/</id>
    <published>2023-07-09T07:09:34.000Z</published>
    <updated>2023-11-25T12:51:01.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Q6-Church-Numerals"><a href="#Q6-Church-Numerals" class="headerlink" title="Q6: Church Numerals"></a>Q6: Church Numerals</h2><blockquote><p>The logician <code>Alonzo Church</code> invented a system of representing non-negative integers entirely using functions. The purpose was to show that functions are sufficient to describe all of number theory: if we have functions, we do not need to assume that numbers exist, but instead we can invent them.</p><p>Your goal in this problem is to rediscover this representation known as <code>Church numerals</code>. <code>Church numerals</code> are a way to represent non-negative integers via repeated function application. Specifically, church numerals ( such as <code>zero</code>, <code>one</code>, and <code>two</code> below ) are <em>functions</em> that take in a function <code>f</code> and return a new function which, when called, repeats <code>f</code> a number of times on some argument <code>x</code>. Here are the definitions of <code>zero</code>, as well as a <code>successor</code> function, which takes in a church numeral <code>n</code> as an argument and returns a function that represents the church numeral one higher than <code>n</code>:</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">zero</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> x: x<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">successor</span>(<span class="hljs-params">n</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> f: <span class="hljs-keyword">lambda</span> x: f(n(f)(x))<br></code></pre></td></tr></table></figure><blockquote><p>First, define functions <code>one</code> and <code>two</code> such that they have the same behavior as <code>successor(zero)</code> and <code>successsor(successor(zero))</code> respectively, but <em>do not call <code>successor</code> in your implementation</em>.</p><p>Next, implement a function <code>church_to_int</code> that converts a church numeral argument to a regular Python integer.</p><p>Finally, implement functions <code>add_church</code>, <code>mul_church</code>, and <code>pow_church</code> that perform addition, multiplication, and exponentiation on church numerals.</p></blockquote><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">one</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Church numeral 1: same as successor(zero)&quot;&quot;&quot;</span><br>    <span class="hljs-string">&quot;*** YOUR CODE HERE ***&quot;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> x: f(x)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">two</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Church numeral 2: same as successor(successor(zero))&quot;&quot;&quot;</span><br>    <span class="hljs-string">&quot;*** YOUR CODE HERE ***&quot;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> x:f(f(x))<br><br>three = successor(two)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">church_to_int</span>(<span class="hljs-params">n</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Convert the Church numeral n to a Python integer.</span><br><span class="hljs-string"></span><br><span class="hljs-string">    &gt;&gt;&gt; church_to_int(zero)</span><br><span class="hljs-string">    0</span><br><span class="hljs-string">    &gt;&gt;&gt; church_to_int(one)</span><br><span class="hljs-string">    1</span><br><span class="hljs-string">    &gt;&gt;&gt; church_to_int(two)</span><br><span class="hljs-string">    2</span><br><span class="hljs-string">    &gt;&gt;&gt; church_to_int(three)</span><br><span class="hljs-string">    3</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-string">&quot;*** YOUR CODE HERE ***&quot;</span><br>    <span class="hljs-keyword">return</span> n(<span class="hljs-keyword">lambda</span> x: x+<span class="hljs-number">1</span>)(<span class="hljs-number">0</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_church</span>(<span class="hljs-params">m, n</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Return the Church numeral for m + n, for Church numerals m and n.</span><br><span class="hljs-string"></span><br><span class="hljs-string">    &gt;&gt;&gt; church_to_int(add_church(two, three))</span><br><span class="hljs-string">    5</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-string">&quot;*** YOUR CODE HERE ***&quot;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> f: <span class="hljs-keyword">lambda</span> x: m(f)(n(f)(x))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul_church</span>(<span class="hljs-params">m, n</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Return the Church numeral for m * n, for Church numerals m and n.</span><br><span class="hljs-string"></span><br><span class="hljs-string">    &gt;&gt;&gt; four = successor(three)</span><br><span class="hljs-string">    &gt;&gt;&gt; church_to_int(mul_church(two, three))</span><br><span class="hljs-string">    6</span><br><span class="hljs-string">    &gt;&gt;&gt; church_to_int(mul_church(three, four))</span><br><span class="hljs-string">    12</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-string">&quot;*** YOUR CODE HERE ***&quot;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> f: m(n(f))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pow_church</span>(<span class="hljs-params">m, n</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Return the Church numeral m ** n, for Church numerals m and n.</span><br><span class="hljs-string"></span><br><span class="hljs-string">    &gt;&gt;&gt; church_to_int(pow_church(two, three))</span><br><span class="hljs-string">    8</span><br><span class="hljs-string">    &gt;&gt;&gt; church_to_int(pow_church(three, two))</span><br><span class="hljs-string">    9</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-string">&quot;*** YOUR CODE HERE ***&quot;</span><br>    <span class="hljs-keyword">return</span> n(m)<br></code></pre></td></tr></table></figure><h2 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h2><p>根据我们对<code>zero</code>和<code>successor</code>两个函数的观察，<code>zero</code>就相当于自然数<code>0</code>的定义，而<code>successor</code>实际上相当于一个递增函数。</p><p>我们要做的，就是以这个<code>0</code>的定义为起点，定义出所有自然数以及他们的基础运算。</p><p>题目中提到，函数<code>one</code>的行为应该和<code>successor(zero)</code>的行为一致，也就是说：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">one = successor(zero)<br>two = successor(one) = successor(successor(zero))<br></code></pre></td></tr></table></figure><p>观察<code>successor</code>，可以仿照其结构写出<code>one</code>函数和<code>two</code>函数：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">one</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> x: f(zero(f)(x))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">two</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> x: f(one(f)(x))<br></code></pre></td></tr></table></figure><p>其实，<code>zero(f)(x)</code>就是<code>x</code>，而<code>one(f)(x)</code>就是<code>f(x)</code>，所以我们也可以这样写：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">one</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> x: f(x)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">two</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> x: f(f(x))<br></code></pre></td></tr></table></figure><p>由<code>successor</code>的定义，我们可以发现自然数<code>N</code>对应的函数<code>n</code>的定义应当为：</p><blockquote><p><code>n(f) = f((n - 1)(f))=f(f(f(f(f(x)))))</code>  </p><p>#n个<code>f</code></p></blockquote><p>如果我们按照这样的定义方式，定义自然数<code>n</code>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">n</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> x: f((n-<span class="hljs-number">1</span>)(f)(x))<br></code></pre></td></tr></table></figure><h3 id="church-to-int"><a href="#church-to-int" class="headerlink" title="church_to_int"></a><code>church_to_int</code></h3><p> <code>church_to_int</code> 本质上就是计数嵌套的 <code>f</code>有多少个。每走一层就给计数变量加一。</p><p>考虑将<code> f</code> 设置为自增函数 <code>increment</code> 。这样，传入的参数值就是计数变量的初值，函数的返回值就是终值了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">two</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> x: f(f(x))<br><br>increment = <span class="hljs-keyword">lambda</span> x: x + <span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">church_to_int</span>(<span class="hljs-params">n</span>):<br>    <span class="hljs-keyword">return</span> n(increment)(<span class="hljs-number">0</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">e.g.</span><br><span class="hljs-string">church_to_int(two)</span><br><span class="hljs-string">↓</span><br><span class="hljs-string">two(lambda x: x + 1)(0)</span><br><span class="hljs-string">↓</span><br><span class="hljs-string">    ↓ # 构造two(f)</span><br><span class="hljs-string">↓</span><br><span class="hljs-string">(lambda x: x + 1)((lambda x: x + 1)(0))</span><br><span class="hljs-string">↓</span><br><span class="hljs-string">2</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>事实上，有了<code>n(f)(x)</code>就是<code>n</code>的思想以后，用平常思维就可以写出答案正确的解：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_church</span>(<span class="hljs-params">m, n</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> f: <span class="hljs-keyword">lambda</span> x: n(f)(x) + m(f)(x)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul_church</span>(<span class="hljs-params">m, n</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> f: <span class="hljs-keyword">lambda</span> x: m(f)(x) * n(f)(x)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pow_church</span>(<span class="hljs-params">m, n</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> f: <span class="hljs-keyword">lambda</span> x: m(f)(x) ** n(f)(x)<br></code></pre></td></tr></table></figure><p><strong>显然，这不会也不应该是最佳答案</strong></p><h3 id="add-church"><a href="#add-church" class="headerlink" title="add_church"></a><code>add_church</code></h3><p>我们把<code>m</code>和<code>n</code>各自看成整体。<code>m</code>是<code>m</code>个<code>f</code>函数嵌套的整体，可以看成是关于函数<code>f</code>的函数，<code>n</code>是<code>n</code>个<code>f</code>函数嵌套的整体.</p><p>当<code>m</code>和<code>n</code>传入的参数<code>f</code>相同时，我们要求<code>m+n</code>，即想办法获得一个<code>m+n</code>层的高阶函数.</p><p>用数学表达式为：<code>f(f(f(.....[f(f(f(x)))].....)))</code>，内部的括号为<code>n</code>层f嵌套，外层为<code>m</code>层括号嵌套。</p><p>考虑计算 <code>m+n</code>，也就是把 <code>m+n</code>个<code> f</code> 套在一起。而我们知道<code>m(f)</code>可以实现 <code>m</code>次嵌套,<code>n(f)</code>可以实现 <code>n</code> 次嵌套。</p><p>那么，我们在<code>n(f)</code>外面套一个<code>m(f)</code>即可：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_church</span>(<span class="hljs-params">m, n</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> f: <span class="hljs-keyword">lambda</span> x: m(f)(n(f)(x))<br></code></pre></td></tr></table></figure><h3 id="mul-church"><a href="#mul-church" class="headerlink" title="mul_church"></a><code>mul_church</code></h3><p>计算 <code>n×m</code>也就是 <code>m</code> 个<code> n</code> 相加，我们需要先把函数<code>f</code>嵌套<code>n</code>次，再把嵌套之后得到的<code>n</code>函数值嵌套<code>m</code>次。</p><p>这一次对于<code>m</code>函数而言，它的参数不再是函数<code>f</code>，而是嵌套之后的函数值<code>n</code>。</p><p>换言之，即 <code>n(f)</code> 自己套自己套上 <code>m</code>次：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul_church</span>(<span class="hljs-params">m, n</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> f: m(n(f))<br><span class="hljs-string">&#x27;&#x27;&#x27;or</span><br><span class="hljs-string">    return lambda f: lambda x: m(n(f))(x)</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="pow-church"><a href="#pow-church" class="headerlink" title="pow_church"></a><code>pow_church</code></h3><p><code>m(f)</code> 的功用是将 <code>m</code>个<code> f</code> 嵌套起来，那么 <code>n(m(f))</code>的功用也就是将 <code>n</code>个<code>m(f)</code>嵌套起来，即</p><p align='center'><img src="https://blog-pic-storage.oss-cn-shanghai.aliyuncs.com/img/202307281702055.png" style="zoom:50%;" /></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">pow_church</span>(<span class="hljs-params">m, n</span>):<br>    <span class="hljs-keyword">return</span> n(m)<br>    <span class="hljs-string">&#x27;&#x27;&#x27;or</span><br><span class="hljs-string">    return lambda f: n(m)(f)</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h3><p><code>m x n</code>写成：<code>lambda f: m(n(f))</code>， <code>m^n</code>写成：<code>lambda f: n(m)(f)</code>。这两者看起来非常非常相似，为什么结果相差这么大呢？</p><blockquote><p>最简单的解释就是<strong>作用对象不同</strong>。</p><p>先来看第一条：<code>lambda f: m(n(f))</code>。把<code>m</code>和<code>n</code>分别看成是一个整体，在这行代码当中，<code>n</code>接收了一个参数<code>f</code>。而<code>m</code>接收的参数是<code>n(f)</code>。我们可以做一个换元，我们假设<code>g = n(f)</code>，那么<code>m</code>函数的入参就是<code>g</code>。</p><p>再来看第二条代码：<code>lambda f: n(m)(f)</code>，这里<code>m</code>函数没有入参，而<code>n</code>函数的入参是<code>m</code>。</p><p>表面上一个入参是<code>n(f)</code>一个是<code>m</code>，好像差不多。其实相差很大。</p><p><code>n(f)</code>是<code>n</code>函数作用于<code>f</code>上的结果，这个结果不再具备将函数嵌套<code>n</code>层的能力。所以外层再套上<code>m</code>函数，得到的也只是这个结果本身嵌套<code>m</code>次。</p><p>而<code>n(m)</code>不同，传入的参数是<code>m</code>本身，而非<code>m</code>作用之后的结果，<code>m</code>函数的功能就是将输入的函数嵌套<code>m</code>次，所以当它经过<code>n</code>函数作用于自身的时候，总层数会不停地乘上<code>m</code>。</p></blockquote><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/505962536">日拱一卒，伯克利CS61A，作业3</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.cnblogs.com/Shimarin/p/13823520.html">CS61A Homework: Church Numerals</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> ↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/267917164">记录一道颇有意思的CS61A python作业题Church numerals</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <summary type="html">CS61A-lab03-Q6-ChurchNumerals</summary>
    
    
    
    <category term="Major" scheme="https://www.0co.dev/categories/Major/"/>
    
    <category term="CS61A" scheme="https://www.0co.dev/categories/Major/CS61A/"/>
    
    
    <category term="CS61A" scheme="https://www.0co.dev/tags/CS61A/"/>
    
  </entry>
  
  <entry>
    <title>华中科技大学物理实验报告</title>
    <link href="https://www.0co.dev/HUST-physics-exps/"/>
    <id>https://www.0co.dev/HUST-physics-exps/</id>
    <published>2023-07-06T02:24:21.000Z</published>
    <updated>2023-10-31T03:06:32.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="物理实验【一】"><a href="#物理实验【一】" class="headerlink" title="物理实验【一】"></a>物理实验【一】</h1><h2 id="密立根油滴"><a href="#密立根油滴" class="headerlink" title="密立根油滴"></a>密立根油滴</h2><p><a href="https://blog.csdn.net/lee1hong/article/details/111825258?spm=1001.2014.3001.5501">软件学院</a><br><a href="https://mp.weixin.qq.com/s?__biz=MzU4Mzg0MTMzMA==&amp;mid=100005676&amp;idx=1&amp;sn=545ea872b068b360bdca9a1329941d09&amp;scene=19#wechat_redirect">自动化学院</a><br><a href="https://mp.weixin.qq.com/s/Fu1dgxkQULMBvJsALF0PWA">化学学院</a><br><a href="https://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000067&amp;idx=3&amp;sn=bc2dd4bda2b1ed20fbadbe054c56069a&amp;scene=19#wechat_redirect">机械学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTE2NzE5OA==&amp;mid=100003770&amp;idx=1&amp;sn=6a95b3476d4e8a14822b59d8b822c7bf&amp;scene=19#wechat_redirect">网安学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4Nzc0NjY2OA==&amp;mid=2247506999&amp;idx=3&amp;sn=e96fe7a49bf8ab62d4c83d331f25c67c&amp;scene=19#wechat_redirect">电信学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MjM5MzIzOTQ5Mw==&amp;mid=2653754983&amp;idx=3&amp;sn=68d2ff1d3e66d4e18c03ea2ffc62a3c5&amp;scene=19#wechat_redirect">aia小灵通</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg5Mjc2ODc0NQ==&amp;mid=2247495827&amp;idx=7&amp;sn=c450fac7390e58a723b900305232e04c&amp;scene=19#wechat_redirect">青春计算机</a></p><h2 id="伏安特性"><a href="#伏安特性" class="headerlink" title="伏安特性"></a>伏安特性</h2><p><a href="https://blog.csdn.net/lee1hong/article/details/111824882?spm=1001.2014.3001.5501">软件学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4Mzg0MTMzMA==&amp;mid=100005630&amp;idx=1&amp;sn=8f2a9841248ce8006109bffe572e4c19&amp;scene=19#wechat_redirect">自动化学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000067&amp;idx=8&amp;sn=c561b79e288801cceaf37ce033633f6c&amp;scene=19#wechat_redirect">化学学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000067&amp;idx=8&amp;sn=c561b79e288801cceaf37ce033633f6c&amp;scene=19#wechat_redirect">机械学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTE2NzE5OA==&amp;mid=100003812&amp;idx=1&amp;sn=6e6b5570adb89bc3f17e794c13b70cd0&amp;scene=19#wechat_redirect">网安学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4Nzc0NjY2OA==&amp;mid=2247506999&amp;idx=5&amp;sn=fa2e2e324d219064eaba0bd4ec6b59be&amp;scene=19#wechat_redirect">电信学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MjM5MzIzOTQ5Mw==&amp;mid=2653754929&amp;idx=2&amp;sn=ce4c4a0b86811f54f4dbcc1f91afb4b0&amp;scene=19#wechat_redirect">aia小灵通</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg5Mjc2ODc0NQ==&amp;mid=2247495827&amp;idx=2&amp;sn=b42b9db6035e4cced6387c65601b3c67&amp;scene=19#wechat_redirect">青春计算机</a></p><h2 id="多功能摆"><a href="#多功能摆" class="headerlink" title="多功能摆"></a>多功能摆</h2><p><a href="http://mp.weixin.qq.com/s?__biz=MzU4Mzg0MTMzMA==&amp;mid=100005698&amp;idx=1&amp;sn=a871e583bc1969496050adf361754308&amp;scene=19#wechat_redirect">自动化学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000067&amp;idx=5&amp;sn=18079d69ab2e5cf36726f653f4faade9&amp;scene=19#wechat_redirect">机械学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4Nzc0NjY2OA==&amp;mid=2247506999&amp;idx=2&amp;sn=4e9736271b168bdcdb6633fb06ed3246&amp;scene=19#wechat_redirect">电信学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MjM5MzIzOTQ5Mw==&amp;mid=2653754929&amp;idx=3&amp;sn=789fd1f2333f8c35cf62a4c8c106f059&amp;scene=19#wechat_redirect">aia小灵通</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg5Mjc2ODc0NQ==&amp;mid=2247495827&amp;idx=4&amp;sn=44cdf5258694a544fb0af929c2f19cdb&amp;scene=19#wechat_redirect">青春计算机</a></p><h2 id="组合光学"><a href="#组合光学" class="headerlink" title="组合光学"></a>组合光学</h2><p><a href="http://mp.weixin.qq.com/s?__biz=MzU4Mzg0MTMzMA==&amp;mid=100005829&amp;idx=1&amp;sn=d7aceac199527379bcf78d7f4140f7b2&amp;scene=19#wechat_redirect">自动化学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000103&amp;idx=7&amp;sn=c2d07cbf5404e59b9c2d831bca2c0860&amp;scene=19#wechat_redirect">机械学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTE2NzE5OA==&amp;mid=2247491880&amp;idx=1&amp;sn=30eecc6cf3a53b647c81b64f3b9c056b&amp;scene=19#wechat_redirect">网安学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4Nzc0NjY2OA==&amp;mid=2247506999&amp;idx=6&amp;sn=ca3dff12c156b4c618205b22f55a8b36&amp;scene=19#wechat_redirect">电信学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg5Mjc2ODc0NQ==&amp;mid=2247495827&amp;idx=1&amp;sn=4809be573a12a9a92465c7478cc4696f&amp;scene=19#wechat_redirect">青春计算机</a></p><h2 id="声速测量"><a href="#声速测量" class="headerlink" title="声速测量"></a>声速测量</h2><p><a href="http://mp.weixin.qq.com/s?__biz=MzU4Mzg0MTMzMA==&amp;mid=100005640&amp;idx=1&amp;sn=7fddefcd59432a8d59597e008220446a&amp;scene=19#wechat_redirect">自动化学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000067&amp;idx=1&amp;sn=4bb60defd241b12eaf2f2593e2d386d6&amp;scene=19#wechat_redirect">机械学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTE2NzE5OA==&amp;mid=100003761&amp;idx=1&amp;sn=47e27bd07adf657dcc76787e8807acde&amp;scene=19#wechat_redirect">网安学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4Nzc0NjY2OA==&amp;mid=2247506999&amp;idx=4&amp;sn=be56c0fd62b4bfa02978155335bdc5fa&amp;scene=19#wechat_redirect">电信学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MjM5MzIzOTQ5Mw==&amp;mid=2653754929&amp;idx=1&amp;sn=7b5ea2513088161096241c08f3ef8668&amp;scene=19#wechat_redirect">aia小灵通</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg5Mjc2ODc0NQ==&amp;mid=2247495827&amp;idx=8&amp;sn=0b393e65403c0033cba82307f9c2d20f&amp;scene=19#wechat_redirect">青春计算机</a></p><h2 id="音叉振动"><a href="#音叉振动" class="headerlink" title="音叉振动"></a>音叉振动</h2><p><a href="http://mp.weixin.qq.com/s?__biz=MzU4Mzg0MTMzMA==&amp;mid=100005715&amp;idx=1&amp;sn=1e22de4fabd373e90f6f98f5de9e9d40&amp;scene=19#wechat_redirect">自动化学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000103&amp;idx=6&amp;sn=91948e9d0607235219273f649dba55a7&amp;scene=19#wechat_redirect">机械学院</a><br><a href="https://mp.weixin.qq.com/s?__biz=Mzg4MTE2NzE5OA==&amp;mid=2247491882&amp;idx=1&amp;sn=f26d652a8393622a051f47c60cc69b59&amp;scene=19#wechat_redirect">网安学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4Nzc0NjY2OA==&amp;mid=2247506999&amp;idx=7&amp;sn=ded9d0eba201ae4780081113439557e8&amp;scene=19#wechat_redirect">电信学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MjM5MzIzOTQ5Mw==&amp;mid=2653755082&amp;idx=7&amp;sn=791fabdcff3259afb18e14b2754b9bba&amp;scene=19#wechat_redirect">aia小灵通</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg5Mjc2ODc0NQ==&amp;mid=2247495827&amp;idx=5&amp;sn=5fb67f2242c88abd66228ecf3efc3030&amp;scene=19#wechat_redirect">青春计算机</a></p><h2 id="示波器的使用"><a href="#示波器的使用" class="headerlink" title="示波器的使用"></a>示波器的使用</h2><p><a href="https://blog.csdn.net/lee1hong/article/details/111825347?spm=1001.2014.3001.5501">软件学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4Mzg0MTMzMA==&amp;mid=100005654&amp;idx=1&amp;sn=0f9142932968c54ec49457fa6f4006b6&amp;scene=19#wechat_redirect">自动化学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000067&amp;idx=6&amp;sn=5fd5255e7c8ee1493f221966863f8717&amp;scene=19#wechat_redirect">机械学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTE2NzE5OA==&amp;mid=100003742&amp;idx=1&amp;sn=835a024c9ed6b9890e252c4ce8a937db&amp;scene=19#wechat_redirect">网安学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4Nzc0NjY2OA==&amp;mid=2247506999&amp;idx=1&amp;sn=1e9302e58f2c30cc9f73ee8af76b504d&amp;scene=19#wechat_redirect">电信学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MjM5MzIzOTQ5Mw==&amp;mid=2653754983&amp;idx=4&amp;sn=d14f2fd825119e47725052a2c89fa09a&amp;scene=19#wechat_redirect">aia小灵通</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg5Mjc2ODc0NQ==&amp;mid=2247495827&amp;idx=6&amp;sn=61a85d2eda9da4a241078b384c41d53d&amp;scene=19#wechat_redirect">青春计算机</a></p><h2 id="分光计"><a href="#分光计" class="headerlink" title="分光计"></a>分光计</h2><p><a href="https://mp.weixin.qq.com/s/Lg-fbee41rn-4SyuQjIccQ">机械学院</a><br><a href="https://mp.weixin.qq.com/s/r9OlqEAMAFfUumh8AlwCUQ">自动化学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTE2NzE5OA==&amp;mid=100003516&amp;idx=1&amp;sn=a6bfb816092887bf48a4b885e7f3a69b&amp;scene=19#wechat_redirect">网安学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MjM5MzIzOTQ5Mw==&amp;mid=2653754983&amp;idx=1&amp;sn=4e0b110f03c8d79de04217a47d495069&amp;scene=19#wechat_redirect">aia小灵通</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg5Mjc2ODc0NQ==&amp;mid=2247495827&amp;idx=3&amp;sn=1cc5706873e559959a8dfbf108c5c906&amp;scene=19#wechat_redirect">青春计算机</a></p><h1 id="物理实验【二】"><a href="#物理实验【二】" class="headerlink" title="物理实验【二】"></a>物理实验【二】</h1><h2 id="RLC电路的暂态过程"><a href="#RLC电路的暂态过程" class="headerlink" title="RLC电路的暂态过程"></a>RLC电路的暂态过程</h2><p><a href="http://mp.weixin.qq.com/s?__biz=MzU4Mzg0MTMzMA==&amp;mid=100005768&amp;idx=1&amp;sn=9eef4a993181fcba4837c98b0a6adf31&amp;scene=19#wechat_redirect">自动化学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4Nzc0NjY2OA==&amp;mid=2247506998&amp;idx=4&amp;sn=525285d85a30d532b28ec7aa995506b7&amp;scene=19#wechat_redirect">电信学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000103&amp;idx=1&amp;sn=ce4104c0f67d6e1ec4ebf973ccfe252a&amp;scene=19#wechat_redirect">机械学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTE2NzE5OA==&amp;mid=2247491887&amp;idx=1&amp;sn=2d81f5cc3b755dce71f591dbace8489d&amp;scene=19#wechat_redirect">网安学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MjM5MzIzOTQ5Mw==&amp;mid=2653755082&amp;idx=2&amp;sn=bf64dc1dc4f90ad4170eb8298e341ffc&amp;scene=19#wechat_redirect">aia小灵通</a></p><h2 id="霍尔效应"><a href="#霍尔效应" class="headerlink" title="霍尔效应"></a>霍尔效应</h2><p><a href="https://blog.csdn.net/lee1hong/article/details/111825385?spm=1001.2014.3001.5502">软件学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4Mzg0MTMzMA==&amp;mid=100005619&amp;idx=1&amp;sn=eba9bcd3bb3adcb0ef82bb1c6943c865&amp;scene=19#wechat_redirect">自动化学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4Nzc0NjY2OA==&amp;mid=2247506998&amp;idx=7&amp;sn=f5af8cd0726140baf7926fac19a0f641&amp;scene=19#wechat_redirect">电信学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000067&amp;idx=2&amp;sn=e249116da77d01f2df2a23d92731c926&amp;scene=19#wechat_redirect">机械学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTE2NzE5OA==&amp;mid=100003750&amp;idx=1&amp;sn=49660cedbee59013925b1d40b63cbd44&amp;scene=19#wechat_redirect">网安学院</a><br><a href="https://mp.weixin.qq.com/s?__biz=MzU5Mjg2ODkxNg==&amp;mid=100001375&amp;idx=4&amp;sn=50a59e9fcb80be1aa419dacc44713071&amp;chksm=7e186504496fec128e8b73266e003bcf8b204df61a92fc8721f51688200e50ff73674cdd7dde&amp;mpshare=1&amp;scene=23&amp;srcid=0724krFS4nircvo6xkjgXfeR&amp;sharer_sharetime=1658592115438&amp;sharer_shareid=555b3bc50bfb7b5c8fe4ad35fe242d68#rd">化学学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MjM5MzIzOTQ5Mw==&amp;mid=2653754983&amp;idx=2&amp;sn=16027172f5623400baa8e7182c495de1&amp;scene=19#wechat_redirect">aia小灵通</a></p><h2 id="偏振光"><a href="#偏振光" class="headerlink" title="偏振光"></a>偏振光</h2><p><a href="http://mp.weixin.qq.com/s?__biz=MzU4Mzg0MTMzMA==&amp;mid=100005752&amp;idx=1&amp;sn=128dc87b4cc827cc8bb633333d179aca&amp;scene=19#wechat_redirect">自动化学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4Nzc0NjY2OA==&amp;mid=2247506998&amp;idx=3&amp;sn=304597f6f9ff308cec10efdcfcde978f&amp;scene=19#wechat_redirect">电信学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000103&amp;idx=4&amp;sn=66e36556b4380930c08f70116c8ff2cb&amp;scene=19#wechat_redirect">机械学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTE2NzE5OA==&amp;mid=2247491886&amp;idx=1&amp;sn=6929d031e9e5f3618d835f8e276992c2&amp;scene=19#wechat_redirect">网安学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MjM5MzIzOTQ5Mw==&amp;mid=2653755082&amp;idx=5&amp;sn=f77adc03594bbb3b591acb21472bf18a&amp;scene=19#wechat_redirect">aia小灵通</a></p><h2 id="液体的表面张力"><a href="#液体的表面张力" class="headerlink" title="液体的表面张力"></a>液体的表面张力</h2><p><a href="http://mp.weixin.qq.com/s?__biz=MzU4Mzg0MTMzMA==&amp;mid=100005730&amp;idx=1&amp;sn=10268528250d29cf488c57bac99d51ac&amp;scene=19#wechat_redirect">自动化学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4Nzc0NjY2OA==&amp;mid=2247506998&amp;idx=2&amp;sn=360a805eac4b01ecd95a32726457e4d3&amp;scene=19#wechat_redirect">电信学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000103&amp;idx=5&amp;sn=89d4d2dacc48c0735489170b30d97db9&amp;scene=19#wechat_redirect">机械学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTE2NzE5OA==&amp;mid=2247491884&amp;idx=1&amp;sn=fab7018bcc86ce69e95d93cc51fddd93&amp;scene=19#wechat_redirect">网安学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MjM5MzIzOTQ5Mw==&amp;mid=2653755082&amp;idx=6&amp;sn=f15f377230263ead443cea0e7ea14962&amp;scene=19#wechat_redirect">aia小灵通</a></p><h2 id="导热系数的测量"><a href="#导热系数的测量" class="headerlink" title="导热系数的测量"></a>导热系数的测量</h2><p><a href="http://mp.weixin.qq.com/s?__biz=MzU4Mzg0MTMzMA==&amp;mid=100005800&amp;idx=1&amp;sn=d2394a0fce4b12c566712a74ec1439c5&amp;scene=19#wechat_redirect">自动化学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4Nzc0NjY2OA==&amp;mid=2247506998&amp;idx=6&amp;sn=5643cd5fe27d628248965fdef88eb349&amp;scene=19#wechat_redirect">电信学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000103&amp;idx=8&amp;sn=89d53a2952023c038d9030b1c6ebf44e&amp;scene=19#wechat_redirect">机械学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTE2NzE5OA==&amp;mid=2247491885&amp;idx=1&amp;sn=1364d5e180abeae4b19170c67270b340&amp;scene=19#wechat_redirect">网安学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MjM5MzIzOTQ5Mw==&amp;mid=2653755082&amp;idx=3&amp;sn=0098aaa3edc8bfa9a7e20197ecdec555&amp;scene=19#wechat_redirect">aia小灵通</a></p><h2 id="转动惯量"><a href="#转动惯量" class="headerlink" title="转动惯量"></a>转动惯量</h2><p><a href="http://mp.weixin.qq.com/s?__biz=MzU4Mzg0MTMzMA==&amp;mid=100005780&amp;idx=1&amp;sn=d80bcf536c1c31bf4f6427f043d97d0a&amp;scene=19#wechat_redirect">自动化学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4Nzc0NjY2OA==&amp;mid=2247506998&amp;idx=5&amp;sn=bce6a22196321cb92a211479590f5087&amp;scene=19#wechat_redirect">电信学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000103&amp;idx=3&amp;sn=4baabc7c2884ed61837b0fc091fa4f86&amp;scene=19#wechat_redirect">机械学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTE2NzE5OA==&amp;mid=2247491881&amp;idx=1&amp;sn=990626ba7cca6e6d56dd247ed5c4a1e1&amp;scene=19#wechat_redirect">网安学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MjM5MzIzOTQ5Mw==&amp;mid=2653755082&amp;idx=8&amp;sn=45dea80adffa6585b5a946f234d1eced&amp;scene=19#wechat_redirect">aia小灵通</a></p><h2 id="电桥实验"><a href="#电桥实验" class="headerlink" title="电桥实验"></a>电桥实验</h2><p><a href="https://blog.csdn.net/lee1hong/article/details/111825303?spm=1001.2014.3001.5502">软件学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4Mzg0MTMzMA==&amp;mid=100005600&amp;idx=1&amp;sn=bef88c38bb74bf146a0c01320ad9ad07&amp;scene=19#wechat_redirect">自动化学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4Nzc0NjY2OA==&amp;mid=2247506998&amp;idx=8&amp;sn=bee3cb29d942a65b2ce51a9ffc355072&amp;scene=19#wechat_redirect">电信学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU4OTYzNzIxMA==&amp;mid=100000067&amp;idx=4&amp;sn=752a43444bbb3d65eede6a0418cf6fd4&amp;scene=19#wechat_redirect">机械学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=Mzg4MTE2NzE5OA==&amp;mid=100003731&amp;idx=1&amp;sn=f1dbb6fff21d7ce1d3e4ca66cab682b4&amp;scene=19#wechat_redirect">网安学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzU5Mjg2ODkxNg==&amp;mid=100001375&amp;idx=2&amp;sn=5865d3172dcf8a9f641f1f9d35308408&amp;chksm=7e186504496fec12be06e466035cae87d1ee26fbf2f6653aa8fa28ccce5e837c67d3e677c34b&amp;mpshare=1&amp;scene=23&amp;srcid=0925d8QZCUiOoxNIcekLcjRm&amp;sharer_sharetime=1664096883957&amp;sharer_shareid=555b3bc50bfb7b5c8fe4ad35fe242d68#rd">化学学院</a><br><a href="http://mp.weixin.qq.com/s?__biz=MjM5MzIzOTQ5Mw==&amp;mid=2653754983&amp;idx=5&amp;sn=85ab163745bbe37404fe20f7bc11e2fb&amp;scene=19#wechat_redirect">aia小灵通</a></p><h2 id="迈克尔逊干涉"><a href="#迈克尔逊干涉" class="headerlink" title="迈克尔逊干涉"></a>迈克尔逊干涉</h2><p><a href="https://mp.weixin.qq.com/s/zGx8Diy7krWtVkmjAN5Xgg">自动化学院</a></p><div class="note note-success">            <p>整理自<a href="https://dekrt.cn/">dekrt’s blog</a>，版权归此作者所有。</p>          </div>]]></content>
    
    
    <summary type="html">跟烦人的物理实验Say Bye！</summary>
    
    
    
    <category term="HUST" scheme="https://www.0co.dev/categories/HUST/"/>
    
    <category term="Answer" scheme="https://www.0co.dev/categories/HUST/Answer/"/>
    
    
    <category term="Answer" scheme="https://www.0co.dev/tags/Answer/"/>
    
  </entry>
  
</feed>
